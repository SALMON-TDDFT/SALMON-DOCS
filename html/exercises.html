<!DOCTYPE html>
<html class="writer-html4" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Exercises &mdash; SALMON software manual v.2.2.2 documentation</title><link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" type="text/css" />
      <link rel="stylesheet" href="_static/katex-math.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.js"></script>
        <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/contrib/auto-render.min.js"></script>
        <script type="text/javascript" src="_static/katex_autorenderer.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="List of input keywords" href="input_keyword_list.html" />
    <link rel="prev" title="Install and Run" href="install_and_run.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            SALMON software manual
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="install_and_run.html">Install and Run</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Exercises</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#getting-started">Getting started</a></li>
<li class="toctree-l2"><a class="reference internal" href="#c2h2-isolated-molecules">C2H2 (isolated molecules)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#exercise-1-ground-state-of-c2h2-molecule">Exercise-1: Ground state of C2H2 molecule</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#input-files">Input files</a></li>
<li class="toctree-l4"><a class="reference internal" href="#execusion">Execusion</a></li>
<li class="toctree-l4"><a class="reference internal" href="#output-files">Output files</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#exercise-2-polarizability-and-photoabsorption-of-c2h2-molecule">Exercise-2: Polarizability and photoabsorption of C2H2 molecule</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#input-files-1">Input files</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id3">Execusion</a></li>
<li class="toctree-l4"><a class="reference internal" href="#output-files-2">Output files</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#exercise-3-electron-dynamics-in-c2h2-molecule-under-a-pulsed-electric-field">Exercise-3: Electron dynamics in C2H2 molecule under a pulsed electric field</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#input-files-2">Input files</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id6">Execusion</a></li>
<li class="toctree-l4"><a class="reference internal" href="#output-files-3">Output files</a></li>
<li class="toctree-l4"><a class="reference internal" href="#additional-exercise">Additional exercise</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#crystalline-silicon-periodic-solids">Crystalline silicon (periodic solids)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#exercise-4-ground-state-of-crystalline-silicon">Exercise-4: Ground state of crystalline silicon</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id8">Input files</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id9">Execusion</a></li>
<li class="toctree-l4"><a class="reference internal" href="#output-files-4">Output files</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#exercise-5-dielectric-function-of-crystalline-silicon">Exercise-5: Dielectric function of crystalline silicon</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#input-files-3">Input files</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id12">Execusion</a></li>
<li class="toctree-l4"><a class="reference internal" href="#output-files-5">Output files</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#exercise-6-electron-dynamics-in-crystalline-silicon-under-a-pulsed-electric-field">Exercise-6: Electron dynamics in crystalline silicon under a pulsed electric field</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#input-files-4">Input files</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id15">Execusion</a></li>
<li class="toctree-l4"><a class="reference internal" href="#output-files-6">Output files</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#maxwell-tddft-multiscale-simulation">Maxwell + TDDFT multiscale simulation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#exercise-7-pulsed-light-propagation-through-a-silicon-thin-film">Exercise-7: Pulsed-light propagation through a silicon thin film</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#input-files-5">Input files</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id18">Execusion</a></li>
<li class="toctree-l4"><a class="reference internal" href="#output-files-7">Output files</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#geometry-optimization-and-ehrenfest-molecular-dynamics">Geometry optimization and Ehrenfest molecular dynamics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#exercise-8-geometry-optimization-of-c2h2-molecule">Exercise-8: Geometry optimization of C2H2 molecule</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id20">Input files</a></li>
<li class="toctree-l4"><a class="reference internal" href="#output-files-8">Output files</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#exercise-9-ehrenfest-molecular-dynamics-of-c2h2-molecule">Exercise-9: Ehrenfest molecular dynamics of C2H2 molecule</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id22">Input files</a></li>
<li class="toctree-l4"><a class="reference internal" href="#output-files-9">Output files</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#fdtd-simulation-electromagnetic-analysis">FDTD simulation(electromagnetic analysis)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#exercise-10-absorption-scattering-and-extinction-cross-sections-of-an-au-nanoparticle-in-fdtd-simulation">Exercise-10: Absorption-, Scattering-, and Extinction-cross-sections of an Au nanoparticle in FDTD simulation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id24">Input files</a></li>
<li class="toctree-l4"><a class="reference internal" href="#output-files-10">Output files</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#exercise-11-absorption-reflection-and-transmission-rates-of-an-au-nanoparticles-metasurface-in-fdtd-simulation">Exercise-11: Absorption-, Reflection-, and Transmission-rates of an Au nanoparticles metasurface in FDTD simulation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id26">Input files</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id27">Output files</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#trial-semiconductor-bloch-equation">[Trial] Semiconductor Bloch equation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#trial-exercise-x1-semiconductor-bloch-equation-sbe-calculation">[Trial] Exercise-x1: Semiconductor Bloch equation (SBE) calculation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#ground-state-calculation">Ground state calculation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#output-files-of-ground-state-calculation">Output files of ground state calculation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#real-time-sbe-calculation">Real-time SBE calculation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#trial-exercise-x2-multiscale-maxwell-semiconductor-bloch-equation-maxwell-sbe-calculation">[Trial] Exercise-x2: Multiscale Maxwell semiconductor Bloch equation (Maxwell+SBE) calculation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#multiscale-calculation-for-laser-pulse-propagation-in-silicon-nano-film-1d-calculation">Multiscale calculation for laser pulse propagation in silicon nano-film  (1D calculation)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#multiscale-calculation-for-laser-pulse-incident-on-arbitrary-shaped-nanostructures-2d-calculation">Multiscale calculation for laser pulse incident on arbitrary-shaped nanostructures (2D calculation)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="input_keyword_list.html">List of input keywords</a></li>
<li class="toctree-l1"><a class="reference internal" href="release_log.html">Release History</a></li>
<li class="toctree-l1"><a class="reference internal" href="acknowledgements.html">Acknowledgements</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">SALMON software manual</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Exercises</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/exercises.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="exercises">
<span id="id1"></span><h1>Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline">¶</a></h1>
<div class="section" id="getting-started">
<h2>Getting started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h2>
<p>Welcome to SALMON Exercises!</p>
<p>In these exercises, we explain the use of SALMON from the very
beginning, taking a few samples that cover applications of SALMON in
several directions. We assume that you are in the computational
environment of UNIX/Linux OS. First you need to download and install
SALMON in your computational environment. If you have not yet done it,
do it following the instruction, <a class="reference external" href="http://salmon-tddft.jp/download.html">download</a>
and <a class="reference internal" href="install_and_run.html#install-and-run"><span class="std std-ref">Install and Run</span></a>.</p>
<p>As described in <a class="reference internal" href="install_and_run.html#install-and-run"><span class="std std-ref">Install and Run</span></a>, you are required
to prepare at least an input file and pseudopotential files to run
SALMON. In the following, we present input files for several sample
calculations and provide a brief explanation of the input keywords
that appear in the input files. You may modify the input files to
execute for your own calculations. Pseudopotential files of elements
that appear in the samples are also attached. We also present
explanations of main output files.</p>
<p>We present 11 exercises.</p>
<p>First 3 exercises (Exercise-1 ~ 3) are for an isolated molecule,
acetylene C2H2. If you are interested in learning electron dynamics
calculations in isolated systems, please look into these exercises. In
SALMON, we usually calculate the ground state solution first using a
static density functional theory (DFT). This is
illustrated in <a class="reference internal" href="#exercise-1"><span class="std std-ref">Exercise-1</span></a>.
After finishing the ground state calculation, two exercises of electron
dynamics calculations based on time-dependent density functional theory (TDDFT)
are prepared.
<a class="reference internal" href="#exercise-2"><span class="std std-ref">Exercise-2</span></a>
illustrates the calculation of linear optical responses in real time,
obtaining polarizability and photoabsorption of the molecule.
<a class="reference internal" href="#exercise-3"><span class="std std-ref">Exercise-3</span></a>
illustrates the calculation of electron dynamics in the molecule under a
pulsed electric field.</p>
<p>Next 3 exercises (Exercise-4 ~ 6) are for a crystalline solid, silicon.
If you are interested in learning electron dynamics calculations in
extended periodic systems, please look into these exercises.
<a class="reference internal" href="#exercise-4"><span class="std std-ref">Exercise-4</span></a>
illustrates the ground state calculation of the crystalline silicon based on DFT.
<a class="reference internal" href="#exercise-5"><span class="std std-ref">Exercise-5</span></a>
illustrates the calculation of linear response properties of the crystalline
silicon based on TDDFT to obtain the dielectric function.
<a class="reference internal" href="#exercise-6"><span class="std std-ref">Exercise-6</span></a>
illustrates the calculation of electron dynamics in the crystalline
silicon induced by a pulsed electric field.</p>
<p>Exercise-7 is for a simultaneous calculation of the propagation
of a pulsed light and electronic motion in a bulk silicon,
coupling Maxwell equations for the
electromagnetic fields of the pulsed light and the electron dynamics in
the unit cells based on TDDFT. This calculation is quite time-consuming and is
recommended to execute using massively parallel supercomputers.
<a class="reference internal" href="#exercise-7"><span class="std std-ref">Exercise-7</span></a>
illustrates the calculation of a linearly polarized pulsed light
irradiating normally on a surface of a bulk silicon.</p>
<p>Next 2 exercises (Exercise-8 ~ 9) are for geometry optimization based on DFT and
Ehrenfest molecular dynamics based on TDDFT
for an isolated molecule, acetylene C2H2.
<a class="reference internal" href="#exercise-8"><span class="std std-ref">Exercise-8</span></a>
illustrates the geometry optimization in the ground state.
<a class="reference internal" href="#exercise-9"><span class="std std-ref">Exercise-9</span></a>
illustrates the Ehrenfest molecular dynamics induced by a pulsed electric field.</p>
<p>Next 2 exercises (Exercise-10 ~ 11) are for a macroscopic light propagation through
a metallic nanosphere solving Maxwell equations.
The optical response of the nanoparticle is described by a dielectric function.
Finite-Difference Time-Domain (FDTD) method is used to calculated the three-dimensional
light propagation.
<a class="reference internal" href="#exercise-10"><span class="std std-ref">Exercise-10</span></a> illustrates the calculation of absorption-, scattering-,
and extinction-cross-sections for an isolated Au nanoparticle.
<a class="reference internal" href="#exercise-11"><span class="std std-ref">Exercise-11</span></a> illustrates the calculation of absorption-, reflection-,
and transmission-rates for a metasurface in which Au nanoparticles are periodically arrayed
in two-dimension.</p>
<p>Input files of exercises are included in SALMON, in the directory
<code class="docutils literal notranslate"><span class="pre">SALMON/samples/exercise_##_&lt;description&gt;/</span></code>.</p>
</div>
<div class="section" id="c2h2-isolated-molecules">
<h2>C2H2 (isolated molecules)<a class="headerlink" href="#c2h2-isolated-molecules" title="Permalink to this headline">¶</a></h2>
<div class="section" id="exercise-1-ground-state-of-c2h2-molecule">
<span id="exercise-1"></span><h3>Exercise-1: Ground state of C2H2 molecule<a class="headerlink" href="#exercise-1-ground-state-of-c2h2-molecule" title="Permalink to this headline">¶</a></h3>
<p>In this exercise, we learn the calculation of the ground state
of acetylene (C2H2) molecule, solving the static Kohn-Sham equation.
This exercise will be useful to learn how to set up calculations in
SALMON for any isolated systems such as molecules and nanoparticles.</p>
<p>Acetylene molecule is a linear chain molecule composed of two Carbon atoms
and two Hydrogen atoms.</p>
<blockquote>
<div><a class="reference internal image-reference" href="_images/acetylene.png"><img alt="_images/acetylene.png" src="_images/acetylene.png" style="width: 116.2px; height: 31.8px;" /></a>
</div></blockquote>
<p>In SALMON, we use a three-dimensional (3D) uniform grid system
to express physical quantities such as electron orbitals.</p>
<blockquote>
<div><a class="reference internal image-reference" href="_images/acetylene_grid.png"><img alt="_images/acetylene_grid.png" src="_images/acetylene_grid.png" style="width: 166.8px; height: 167.8px;" /></a>
</div></blockquote>
<div class="section" id="input-files">
<h4>Input files<a class="headerlink" href="#input-files" title="Permalink to this headline">¶</a></h4>
<p>To run the code, following files in the directory <code class="docutils literal notranslate"><span class="pre">SALMON/samples/exercise_01_C2H2_gs/</span></code> are used:</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>file name</td>
<td>description</td>
</tr>
<tr class="row-even"><td><em>C2H2_gs.inp</em></td>
<td>input file that contains input
keywords and their values</td>
</tr>
<tr class="row-odd"><td><em>C_rps.dat</em></td>
<td>pseodupotential file for carbon
atom</td>
</tr>
<tr class="row-even"><td><em>H_rps.dat</em></td>
<td>pseudopotential file for hydrogen
atom</td>
</tr>
</tbody>
</table>
<p>Pseudopotential files are needed for two elements, Carbon (C) and Hydrogen (H).
The pseudopoential depends on the angular momentum, and looks as follows (for Carbon).</p>
<blockquote>
<div><a class="reference internal image-reference" href="_images/C_rps_pot.png"><img alt="_images/C_rps_pot.png" src="_images/C_rps_pot.png" style="width: 395.6px; height: 274.0px;" /></a>
</div></blockquote>
<p>In the input file <code class="docutils literal notranslate"><span class="pre">C2H2_gs.inp</span></code>, input keywords are specified.
Most of them are mandatory to execute the ground state calculation.
This will help you to prepare an input file for other systems that you
want to calculate. A complete list of the input keywords that can be
used in the input file can be found in
<a class="reference internal" href="input_keyword_list.html#list-of-input-keywords"><span class="std std-ref">List of input keywords</span></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>!########################################################################################!
! Excercise 01: Ground state of C2H2 molecule                                            !
!----------------------------------------------------------------------------------------!
! * The detail of this excercise is explained in our manual(see chapter: &#39;Exercises&#39;).   !
!   The manual can be obtained from: https://salmon-tddft.jp/documents.html              !
! * Input format consists of group of keywords like:                                     !
!     &amp;group                                                                             !
!       input keyword = xxx                                                              !
!     /                                                                                  !
!   (see chapter: &#39;List of input keywords&#39; in the manual)                                !
!----------------------------------------------------------------------------------------!
! * Conversion from unit_system = &#39;a.u.&#39; to &#39;A_eV_fs&#39;:                                   !
!   Length: 1 [a.u.] = 0.52917721067    [Angstrom]                                       !
!   Energy: 1 [a.u.] = 27.21138505      [eV]                                             !
!   Time  : 1 [a.u.] = 0.02418884326505 [fs]                                             !
!########################################################################################!

&amp;calculation
  !type of theory
  theory = &#39;dft&#39;
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#theory"><span class="std std-ref">theory</span></a> specifies which theoretical method is used in the calculation.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;control
  !common name of output files
  sysname = &#39;C2H2&#39;
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#sysname"><span class="std std-ref">sysname</span></a> is a prefix for filenames of output files.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;units
  !units used in input and output files
  unit_system = &#39;A_eV_fs&#39;
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#unit-system"><span class="std std-ref">unit_system</span></a> specifies which unit system is used in the input and output files.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;system
  !periodic boundary condition
  yn_periodic = &#39;n&#39;

  !number of elements, atoms, electrons and states(orbitals)
  nelem  = 2
  natom  = 4
  nelec  = 10
  nstate = 6
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#yn-periodic"><span class="std std-ref">yn_periodic</span></a> specifies whether or not periodic boundary condition is applied.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#nelem"><span class="std std-ref">nelem</span></a> is the number of elements in the system.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#natom"><span class="std std-ref">natom</span></a> is the number of atoms in the system.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#nelec"><span class="std std-ref">nelec</span></a> is the number of electrons in the system.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#nstate"><span class="std std-ref">nstate</span></a> is the number of orbitals that are used in the calculation.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;pseudo
  !name of input pseudo potential file
  file_pseudo(1) = &#39;./C_rps.dat&#39;
  file_pseudo(2) = &#39;./H_rps.dat&#39;

  !atomic number of element
  izatom(1) = 6
  izatom(2) = 1

  !angular momentum of pseudopotential that will be treated as local
  lloc_ps(1) = 1
  lloc_ps(2) = 0
  !--- Caution ---------------------------------------!
  ! Indices must correspond to those in &amp;atomic_coor. !
  !---------------------------------------------------!
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#file-pseudo"><span class="std std-ref">file_pseudo(n)</span></a> specifies the filename of the pseudopotential file of the n-th element.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#izatom"><span class="std std-ref">izatom(n)</span></a> is the atomic number of the n-th element.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#lloc-ps"><span class="std std-ref">lloc_ps(n)</span></a> specifies which angular momentum component is chosen as the local potential for the n-th element.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;functional
  !functional(&#39;PZ&#39; is Perdew-Zunger LDA: Phys. Rev. B 23, 5048 (1981).)
  xc = &#39;PZ&#39;
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#xc"><span class="std std-ref">xc</span></a> specifies the exchange-correlation potential to be used in the calculation.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;rgrid
  !spatial grid spacing(x,y,z)
  dl(1:3) = 0.25d0, 0.25d0, 0.25d0

  !number of spatial grids(x,y,z)
  num_rgrid(1:3) = 64, 64, 64
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#dl-3"><span class="std std-ref">dl(i)</span></a> specifies the spatial grid spacing in i-th direction.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#num-rgrid-3"><span class="std std-ref">num_rgrid(i)</span></a> specifies the number of grid points in i-th direction.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;scf
  !maximum number of scf iteration and threshold of convergence
  nscf      = 300
  threshold = 1.0d-9
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#nscf"><span class="std std-ref">nscf</span></a> specifies the maximum number of SCF iterations.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#threshold"><span class="std std-ref">threshold</span></a> specifies the threshold to judge the convergence.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;analysis
  !output of all orbitals, density,
  !density of states, projected density of states,
  !and electron localization function
  yn_out_psi  = &#39;y&#39;
  yn_out_dns  = &#39;y&#39;
  yn_out_dos  = &#39;y&#39;
  yn_out_pdos = &#39;y&#39;
  yn_out_elf  = &#39;y&#39;
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#yn-out-psi"><span class="std std-ref">yn_out_psi</span></a>, <a class="reference internal" href="input_keyword_list.html#yn-out-dns"><span class="std std-ref">yn_out_dns</span></a>, <a class="reference internal" href="input_keyword_list.html#yn-out-dos"><span class="std std-ref">yn_out_dos</span></a>, <a class="reference internal" href="input_keyword_list.html#yn-out-pdos"><span class="std std-ref">yn_out_pdos</span></a>, <a class="reference internal" href="input_keyword_list.html#yn-out-elf"><span class="std std-ref">yn_out_elf</span></a> specify output files that are generated after the calculation.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;atomic_coor
  !cartesian atomic coodinates
  &#39;C&#39;    0.000000    0.000000    0.599672  1
  &#39;H&#39;    0.000000    0.000000    1.662257  2
  &#39;C&#39;    0.000000    0.000000   -0.599672  1
  &#39;H&#39;    0.000000    0.000000   -1.662257  2
  !--- Format ---------------------------------------------------!
  ! &#39;symbol&#39; x y z index(correspond to that of pseudo potential) !
  !--------------------------------------------------------------!
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#atomic-coor"><span class="std std-ref">&amp;atomic_coor</span></a> specifies spatial coordinates of atoms.</div>
</div>
</div>
<div class="section" id="execusion">
<h4>Execusion<a class="headerlink" href="#execusion" title="Permalink to this headline">¶</a></h4>
<p>In a multiprocess environment, calculation will be executed as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ mpiexec -n NPROC salmon &lt; C2H2_gs.inp &gt; C2H2_gs.out
</pre></div>
</div>
<p>where NPROC is the number of MPI processes. A standard output will be stored in the file <code class="docutils literal notranslate"><span class="pre">C2H2_gs.out</span></code>.</p>
</div>
<div class="section" id="output-files">
<span id="output-files-1"></span><h4>Output files<a class="headerlink" href="#output-files" title="Permalink to this headline">¶</a></h4>
<p>After the calculation, following output files and a directory are created in the
directory that you run the code in addition to the standard output file,</p>
<table border="1" class="docutils">
<colgroup>
<col width="51%" />
<col width="49%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>name</td>
<td>description</td>
</tr>
<tr class="row-even"><td><em>C2H2_info.data</em></td>
<td>information on ground state
solution</td>
</tr>
<tr class="row-odd"><td><em>C2H2_eigen.data</em></td>
<td>orbital energies</td>
</tr>
<tr class="row-even"><td><em>C2H2_k.data</em></td>
<td>k-point distribution
(for isolated systems, only
gamma point is described)</td>
</tr>
<tr class="row-odd"><td><em>data_for_restart</em></td>
<td>directory where files used in
the real-time calculation are
contained</td>
</tr>
<tr class="row-even"><td><em>psi_ob1.cube</em>, <em>psi_ob2.cube</em>, ...</td>
<td>electron orbitals</td>
</tr>
<tr class="row-odd"><td><em>dns.cube</em></td>
<td>a cube file for electron density</td>
</tr>
<tr class="row-even"><td><em>dos.data</em></td>
<td>density of states</td>
</tr>
<tr class="row-odd"><td><em>pdos1.data</em>, <em>pdos2.data</em>, ...</td>
<td>projected density of states</td>
</tr>
<tr class="row-even"><td><em>elf.cube</em></td>
<td>electron localization function
(ELF)</td>
</tr>
<tr class="row-odd"><td><em>PS_C_KY_n.dat</em></td>
<td>information on pseodupotential
file for carbon atom</td>
</tr>
<tr class="row-even"><td><em>PS_H_KY_n.dat</em></td>
<td>information on pseodupotential
file for hydrogen atom</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line">You may download the above files (zipped file, except for the directory <em>data_for_restart</em>) from:</div>
<div class="line"><a class="reference external" href="https://salmon-tddft.jp/webmanual/v_2_0_1/exercise_zip_files/01_C2H2_gs.zip">https://salmon-tddft.jp/webmanual/v_2_0_1/exercise_zip_files/01_C2H2_gs.zip</a></div>
</div>
<p>We first explain the standard output file. In the beginning of the file, input variables used in the calculation are shown.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##############################################################################</span>
<span class="c1"># SALMON: Scalable Ab-initio Light-Matter simulator for Optics and Nanoscience</span>
<span class="c1">#</span>
<span class="c1">#                             Version 2.0.1</span>
<span class="c1">#</span>
<span class="c1">##############################################################################</span>
  <span class="n">Libxc</span><span class="p">:</span> <span class="p">[</span><span class="n">disabled</span><span class="p">]</span>
   <span class="n">theory</span><span class="o">=</span> <span class="n">dft</span>
   <span class="n">use</span> <span class="n">of</span> <span class="n">real</span> <span class="n">value</span> <span class="n">orbitals</span> <span class="o">=</span>  <span class="n">T</span>
 <span class="o">======</span>
 <span class="n">MPI</span> <span class="n">distribution</span><span class="p">:</span>
   <span class="n">nproc_k</span>     <span class="p">:</span>           <span class="mi">1</span>
   <span class="n">nproc_ob</span>    <span class="p">:</span>           <span class="mi">1</span>
   <span class="n">nproc_rgrid</span> <span class="p">:</span>           <span class="mi">1</span>           <span class="mi">1</span>           <span class="mi">2</span>
 <span class="n">OpenMP</span> <span class="n">parallelization</span><span class="p">:</span>
   <span class="n">number</span> <span class="n">of</span> <span class="n">threads</span> <span class="p">:</span>         <span class="mi">256</span>
 <span class="o">.........</span>
</pre></div>
</div>
<p>After that, the SCF loop starts. At each iteration step, the total energy as well as
orbital energies and some other quantities are displayed.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-----------------------------------------------</span>
<span class="nb">iter</span><span class="o">=</span>     <span class="mi">1</span>     <span class="n">Total</span> <span class="n">Energy</span><span class="o">=</span>      <span class="o">-</span><span class="mf">197.59254070</span>     <span class="n">Gap</span><span class="o">=</span>   <span class="o">-</span><span class="mf">20.17834599</span>     <span class="n">Vh</span> <span class="nb">iter</span><span class="o">=</span> <span class="mi">234</span>
    <span class="mi">1</span>       <span class="o">-</span><span class="mf">29.9707</span>      <span class="mi">2</span>       <span class="o">-</span><span class="mf">28.3380</span>      <span class="mi">3</span>       <span class="o">-</span><span class="mf">13.0123</span>      <span class="mi">4</span>         <span class="mf">5.8457</span>
    <span class="mi">5</span>        <span class="o">-</span><span class="mf">9.9213</span>      <span class="mi">6</span>       <span class="o">-</span><span class="mf">14.3326</span>
<span class="nb">iter</span> <span class="ow">and</span> <span class="n">int_x</span><span class="o">|</span><span class="n">rho_i</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="n">rho_i</span><span class="o">-</span><span class="mi">1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">|</span><span class="n">dx</span><span class="o">/</span><span class="n">nelec</span>        <span class="o">=</span>      <span class="mi">1</span> <span class="mf">0.31853198E+00</span>
<span class="n">Ne</span><span class="o">=</span>   <span class="mf">10.0000000000000</span>
<span class="o">-----------------------------------------------</span>
<span class="nb">iter</span><span class="o">=</span>     <span class="mi">2</span>     <span class="n">Total</span> <span class="n">Energy</span><span class="o">=</span>      <span class="o">-</span><span class="mf">280.97950515</span>     <span class="n">Gap</span><span class="o">=</span>    <span class="o">-</span><span class="mf">9.59770609</span>     <span class="n">Vh</span> <span class="nb">iter</span><span class="o">=</span> <span class="mi">247</span>
    <span class="mi">1</span>       <span class="o">-</span><span class="mf">17.4334</span>      <span class="mi">2</span>       <span class="o">-</span><span class="mf">24.4941</span>      <span class="mi">3</span>       <span class="o">-</span><span class="mf">20.1872</span>      <span class="mi">4</span>         <span class="mf">0.8020</span>
    <span class="mi">5</span>        <span class="o">-</span><span class="mf">3.4058</span>      <span class="mi">6</span>        <span class="o">-</span><span class="mf">8.7957</span>
<span class="nb">iter</span> <span class="ow">and</span> <span class="n">int_x</span><span class="o">|</span><span class="n">rho_i</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="n">rho_i</span><span class="o">-</span><span class="mi">1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">|</span><span class="n">dx</span><span class="o">/</span><span class="n">nelec</span>        <span class="o">=</span>      <span class="mi">2</span> <span class="mf">0.54493263E+00</span>
<span class="n">Ne</span><span class="o">=</span>   <span class="mf">10.0000000000000</span>
<span class="o">-----------------------------------------------</span>
<span class="nb">iter</span><span class="o">=</span>     <span class="mi">3</span>     <span class="n">Total</span> <span class="n">Energy</span><span class="o">=</span>      <span class="o">-</span><span class="mf">295.67034640</span>     <span class="n">Gap</span><span class="o">=</span>    <span class="o">-</span><span class="mf">6.90359156</span>     <span class="n">Vh</span> <span class="nb">iter</span><span class="o">=</span> <span class="mi">229</span>
    <span class="mi">1</span>       <span class="o">-</span><span class="mf">16.0251</span>      <span class="mi">2</span>       <span class="o">-</span><span class="mf">19.7759</span>      <span class="mi">3</span>       <span class="o">-</span><span class="mf">17.6765</span>      <span class="mi">4</span>        <span class="o">-</span><span class="mf">0.9015</span>
    <span class="mi">5</span>        <span class="o">-</span><span class="mf">2.9323</span>      <span class="mi">6</span>        <span class="o">-</span><span class="mf">7.8050</span>
<span class="nb">iter</span> <span class="ow">and</span> <span class="n">int_x</span><span class="o">|</span><span class="n">rho_i</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="n">rho_i</span><span class="o">-</span><span class="mi">1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">|</span><span class="n">dx</span><span class="o">/</span><span class="n">nelec</span>        <span class="o">=</span>      <span class="mi">3</span> <span class="mf">0.13010987E+00</span>
<span class="n">Ne</span><span class="o">=</span>   <span class="mf">10.0000000000000</span>
</pre></div>
</div>
<p>When the convergence criterion is satisfied, the SCF calculation ends.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-----------------------------------------------</span>
<span class="nb">iter</span><span class="o">=</span>   <span class="mi">162</span>     <span class="n">Total</span> <span class="n">Energy</span><span class="o">=</span>      <span class="o">-</span><span class="mf">339.69525272</span>     <span class="n">Gap</span><span class="o">=</span>     <span class="mf">6.78870999</span>     <span class="n">Vh</span> <span class="nb">iter</span><span class="o">=</span>   <span class="mi">1</span>
    <span class="mi">1</span>       <span class="o">-</span><span class="mf">18.4106</span>      <span class="mi">2</span>       <span class="o">-</span><span class="mf">13.9966</span>      <span class="mi">3</span>       <span class="o">-</span><span class="mf">12.4163</span>      <span class="mi">4</span>        <span class="o">-</span><span class="mf">7.3386</span>
    <span class="mi">5</span>        <span class="o">-</span><span class="mf">7.3386</span>      <span class="mi">6</span>        <span class="o">-</span><span class="mf">0.5498</span>
<span class="nb">iter</span> <span class="ow">and</span> <span class="n">int_x</span><span class="o">|</span><span class="n">rho_i</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="n">rho_i</span><span class="o">-</span><span class="mi">1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">|</span><span class="n">dx</span><span class="o">/</span><span class="n">nelec</span>        <span class="o">=</span>    <span class="mi">162</span> <span class="mf">0.50237787E-08</span>
<span class="n">Ne</span><span class="o">=</span>   <span class="mf">9.99999999999999</span>
<span class="o">-----------------------------------------------</span>
<span class="nb">iter</span><span class="o">=</span>   <span class="mi">163</span>     <span class="n">Total</span> <span class="n">Energy</span><span class="o">=</span>      <span class="o">-</span><span class="mf">339.69525269</span>     <span class="n">Gap</span><span class="o">=</span>     <span class="mf">6.78870999</span>     <span class="n">Vh</span> <span class="nb">iter</span><span class="o">=</span>   <span class="mi">1</span>
    <span class="mi">1</span>       <span class="o">-</span><span class="mf">18.4106</span>      <span class="mi">2</span>       <span class="o">-</span><span class="mf">13.9966</span>      <span class="mi">3</span>       <span class="o">-</span><span class="mf">12.4163</span>      <span class="mi">4</span>        <span class="o">-</span><span class="mf">7.3386</span>
    <span class="mi">5</span>        <span class="o">-</span><span class="mf">7.3386</span>      <span class="mi">6</span>        <span class="o">-</span><span class="mf">0.5498</span>
<span class="nb">iter</span> <span class="ow">and</span> <span class="n">int_x</span><span class="o">|</span><span class="n">rho_i</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="n">rho_i</span><span class="o">-</span><span class="mi">1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">|</span><span class="n">dx</span><span class="o">/</span><span class="n">nelec</span>        <span class="o">=</span>    <span class="mi">163</span> <span class="mf">0.69880308E-09</span>
<span class="n">Ne</span><span class="o">=</span>   <span class="mf">9.99999999999999</span>
 <span class="c1">#GS converged at   164  : 0.69880308E-09</span>
</pre></div>
</div>
<p>Next, the force acting on ions and some other information related to orbital energies are shown.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">=====</span> <span class="n">force</span> <span class="o">=====</span>
    <span class="mi">1</span> <span class="o">-</span><span class="mf">0.33652081E-05</span>  <span class="mf">0.16854696E-04</span> <span class="o">-</span><span class="mf">0.59496450E+00</span>
    <span class="mi">2</span> <span class="o">-</span><span class="mf">0.59222259E-06</span>  <span class="mf">0.24915590E-05</span>  <span class="mf">0.57651725E+00</span>
    <span class="mi">3</span> <span class="o">-</span><span class="mf">0.37839836E-05</span>  <span class="mf">0.20304090E-04</span>  <span class="mf">0.59493028E+00</span>
    <span class="mi">4</span> <span class="o">-</span><span class="mf">0.86779607E-06</span>  <span class="mf">0.39560274E-05</span> <span class="o">-</span><span class="mf">0.57651738E+00</span>
<span class="n">orbital</span> <span class="n">energy</span> <span class="n">information</span><span class="o">-------------------------------</span>
<span class="n">Lowest</span> <span class="n">occupied</span> <span class="n">orbital</span> <span class="o">-</span><span class="mf">0.676576619015730</span>
<span class="n">Highest</span> <span class="n">occupied</span> <span class="n">orbital</span> <span class="p">(</span><span class="n">HOMO</span><span class="p">)</span> <span class="o">-</span><span class="mf">0.269686750876529</span>
<span class="n">Lowest</span> <span class="n">unoccupied</span> <span class="n">orbital</span> <span class="p">(</span><span class="n">LUMO</span><span class="p">)</span> <span class="o">-</span><span class="mf">2.020624936948345E-002</span>
<span class="n">Highest</span> <span class="n">unoccupied</span> <span class="n">orbital</span> <span class="o">-</span><span class="mf">2.020624936948345E-002</span>
<span class="n">HOMO</span><span class="o">-</span><span class="n">LUMO</span> <span class="n">gap</span>  <span class="mf">0.249480501507045</span>
<span class="n">Physicaly</span> <span class="n">upper</span> <span class="n">bound</span> <span class="n">of</span> <span class="n">eps</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span>  <span class="mf">0.656370369646246</span>
<span class="o">---------------------------------------------------------</span>
<span class="n">Lowest</span> <span class="n">occupied</span> <span class="n">orbital</span><span class="p">[</span><span class="n">eV</span><span class="p">]</span>  <span class="o">-</span><span class="mf">18.4105868958642</span>
<span class="n">Highest</span> <span class="n">occupied</span> <span class="n">orbital</span> <span class="p">(</span><span class="n">HOMO</span><span class="p">)[</span><span class="n">eV</span><span class="p">]</span>  <span class="o">-</span><span class="mf">7.33855002098465</span>
<span class="n">Lowest</span> <span class="n">unoccupied</span> <span class="n">orbital</span> <span class="p">(</span><span class="n">LUMO</span><span class="p">)[</span><span class="n">eV</span><span class="p">]</span> <span class="o">-</span><span class="mf">0.549840032009334</span>
<span class="n">Highest</span> <span class="n">unoccupied</span> <span class="n">orbital</span><span class="p">[</span><span class="n">eV</span><span class="p">]</span> <span class="o">-</span><span class="mf">0.549840032009334</span>
<span class="n">HOMO</span><span class="o">-</span><span class="n">LUMO</span> <span class="n">gap</span><span class="p">[</span><span class="n">eV</span><span class="p">]</span>   <span class="mf">6.78870998897532</span>
<span class="n">Physicaly</span> <span class="n">upper</span> <span class="n">bound</span> <span class="n">of</span> <span class="n">eps</span><span class="p">(</span><span class="n">omega</span><span class="p">)[</span><span class="n">eV</span><span class="p">]</span>   <span class="mf">17.8607468638548</span>
<span class="o">---------------------------------------------------------</span>
 <span class="n">writing</span> <span class="n">restart</span> <span class="n">data</span><span class="o">...</span>
 <span class="n">writing</span> <span class="n">completed</span><span class="o">.</span>
</pre></div>
</div>
<p>In the directory <code class="docutils literal notranslate"><span class="pre">data_for_restart</span></code>, files that will be used in the next-step
time evolution calculations are stored.</p>
<p>Other output files include following information.</p>
<p><strong>C2H2_info.data</strong></p>
<p>Calculated orbital and total energies as well as parameters specified in
the input file are shown.</p>
<p><strong>C2H2_eigen.data</strong></p>
<p>Orbital energies.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#esp: single-particle energies (eigen energies)</span>
<span class="c1">#occ: occupation numbers, io: orbital index</span>
<span class="c1"># 1:io, 2:esp[eV], 3:occ</span>
</pre></div>
</div>
<p><strong>C2H2_k.data</strong></p>
<p>k-point distribution(for isolated systems, only gamma point is described).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># ik: k-point index</span>
<span class="c1"># kx,ky,kz: Reduced coordinate of k-points</span>
<span class="c1"># wk: Weight of k-point</span>
<span class="c1"># 1:ik[none] 2:kx[none] 3:ky[none] 4:kz[none] 5:wk[none]</span>
<span class="c1"># coefficients (2*pi/a [a.u.]) in kx, ky, kz</span>
</pre></div>
</div>
<p><strong>psi_ob1.cube, psi_ob2.cube, ...</strong></p>
<p>Cube files for electron orbitals. The number in the filename indicates
the index of the orbital. Atomic unit is adopted in all cube files.</p>
<p><strong>dns.cube</strong></p>
<p>A cube file for electron density.</p>
<p><strong>dos.data</strong></p>
<p>A file for density of states. The units used in this file are affected
by the input parameter, <code class="docutils literal notranslate"><span class="pre">unit_system</span></code> in <code class="docutils literal notranslate"><span class="pre">&amp;unit</span></code>.</p>
<p><strong>elf.cube</strong></p>
<p>A cube file for electron localization function (ELF).</p>
<p>We show several image that are created from the output files.</p>
<ul>
<li><p class="first"><strong>Highest occupied molecular orbital (HOMO)</strong></p>
<p>The output files <code class="docutils literal notranslate"><span class="pre">psi_ob1.cube</span></code>, <code class="docutils literal notranslate"><span class="pre">psi_ob2.cube</span></code>, ... are used to create the image.</p>
<a class="reference internal image-reference" href="_images/HOMO.png"><img alt="_images/HOMO.png" src="_images/HOMO.png" style="width: 283.8px; height: 275.0px;" /></a>
</li>
<li><p class="first"><strong>Electron density</strong></p>
<p>The output files <code class="docutils literal notranslate"><span class="pre">dns.cube</span></code>, ... are used to create the image.</p>
<a class="reference internal image-reference" href="_images/Dns.png"><img alt="_images/Dns.png" src="_images/Dns.png" style="width: 283.8px; height: 275.0px;" /></a>
</li>
<li><p class="first"><strong>Electron localization function</strong></p>
<p>The output files <code class="docutils literal notranslate"><span class="pre">elf.cube</span></code>, ... are used to create the image.</p>
<a class="reference internal image-reference" href="_images/Elf.png"><img alt="_images/Elf.png" src="_images/Elf.png" style="width: 283.8px; height: 275.0px;" /></a>
</li>
</ul>
</div>
</div>
<div class="section" id="exercise-2-polarizability-and-photoabsorption-of-c2h2-molecule">
<span id="exercise-2"></span><h3>Exercise-2: Polarizability and photoabsorption of C2H2 molecule<a class="headerlink" href="#exercise-2-polarizability-and-photoabsorption-of-c2h2-molecule" title="Permalink to this headline">¶</a></h3>
<p>In this exercise, we learn the linear response calculation in the
acetylene (C2H2) molecule, solving the time-dependent Kohn-Sham
equation. The linear response calculation provides the polarizability
and the oscillator strength distribution of the molecule. This exercise
should be carried out after finishing the ground state calculation that
was explained in <a class="reference internal" href="#exercise-1"><span class="std std-ref">Exercise-1</span></a>.</p>
<p>Polarizability <span class="math">\(\alpha_{\mu \nu}(t)\)</span> is the basic quantity
that characterizes optical responses of molecules and nano-particles,
where <span class="math">\(\mu, \nu\)</span> indicate Cartesian components, <span class="math">\(\mu, \nu = x,y,z\)</span>.
The polarizability <span class="math">\(\alpha_{\mu \nu}(t)\)</span> relates the <span class="math">\(\mu\)</span>
component of the electric dipole moment at time <span class="math">\(t\)</span>, <span class="math">\(p_{\mu}(t)\)</span>,
with the <span class="math">\(\nu\)</span> component of the electric field at time <span class="math">\(t'\)</span>,</p>
<p><span class="math">\(p_{\mu}(t) = \sum_{\nu=x,y,z} \alpha_{\mu \nu}(t-t') E_{\nu}(t').\)</span></p>
<p>We introduce a frequency-dependent polarizability by the time-frequency
Fourier transformation of the polarizability,</p>
<p><span class="math">\(\tilde \alpha_{\mu \nu}(\omega) = \int dt e^{i\omega t} \alpha_{\mu \nu}(t).\)</span></p>
<p>The imaginary part of the frequency-dependent polarizability is
related to the photoabsorption cross section <span class="math">\(\sigma(\omega)\)</span> by</p>
<p><span class="math">\(\sigma(\omega) = \frac{4\pi \omega}{c} \frac{1}{3} \sum_{\mu=x,y,z} {\rm Im} \tilde \alpha_{\mu \mu}(\omega).\)</span></p>
<p>The photoabsorption cross section is also related to the oscillator strength
distribution by</p>
<p><span class="math">\(\sigma(\omega) = \frac{2\pi^2 e^2}{mc} \frac{df(\omega)}{d\omega}.\)</span></p>
<p>In SALMON, the polarizability is calculated in time domain.
First the ground state orbital <span class="math">\(\phi_i(\mathbf{r})\)</span> that
satisfies the Kohn-Sham equation,</p>
<p><span class="math">\(H_{\rm KS} \phi_i(\mathbf{r}) = \epsilon_i \phi_i(\mathbf{r}),\)</span></p>
<p>is prepared. Then an impulsive force given by the potential</p>
<p><span class="math">\(V_{\rm ext}(\mathbf{r},t) = I \delta(t) z,\)</span></p>
<p>is applied to all electrons in the C2H2 molecule along the molecular axis
which we take <span class="math">\(z\)</span> axis. <span class="math">\(I\)</span> is the magnitude of the impulse,
and <span class="math">\(\delta(t)\)</span> is the Dirac's delta function.
The orbital is distorted by the impulsive force at <span class="math">\(t=0\)</span>.
Immediately after the impulse is applied, the orbital becomes</p>
<p><span class="math">\(\psi_i(\mathbf{r},t=0_+) = e^{iIz/\hbar} \phi_i(\mathbf{r}).\)</span></p>
<p>After the impulsive force is applied at <span class="math">\(t=0\)</span>,
a time evolution calculation is carried out without any external fields,</p>
<p><span class="math">\(i\hbar \frac{\partial}{\partial t} \psi_i(\mathbf{r},t) = H_{\rm KS}(t) \psi_i(\mathbf{r},t).\)</span></p>
<p>During the time evolution, the electric dipole moment given by</p>
<p><span class="math">\(p_z(t) = \int d\mathbf{r} (-ez) \sum_i \vert \psi_i(\mathbf{r},t) \vert^2,\)</span></p>
<p>is monitored. After the time evolution calculation,
a time-frequency Fourier transformation is carried out for the
electric dipole moment to obtain the frequency-dependent polarizability by</p>
<p><span class="math">\(\tilde \alpha_{zz}(\omega) = - \frac{e}{I} \int dt e^{i\omega t} p_z(t).\)</span></p>
<div class="section" id="input-files-1">
<span id="id2"></span><h4>Input files<a class="headerlink" href="#input-files-1" title="Permalink to this headline">¶</a></h4>
<p>To run the code, following files are necessary:</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>file name</td>
<td>description</td>
</tr>
<tr class="row-even"><td><em>C2H2_response.inp</em></td>
<td>input file that contains input
keywords and their values</td>
</tr>
<tr class="row-odd"><td><em>C_rps.dat</em></td>
<td>pseodupotential file for carbon
atom</td>
</tr>
<tr class="row-even"><td><em>H_rps.dat</em></td>
<td>pseudopotential file for hydrogen
atom</td>
</tr>
<tr class="row-odd"><td><em>restart</em></td>
<td><div class="first last line-block">
<div class="line">directory created in the ground
state calculation</div>
<div class="line">(rename the directory from
<em>data_for_restart</em> to <em>restart</em>)</div>
</div>
</td>
</tr>
</tbody>
</table>
<p>First three files are prepared in the directory <code class="docutils literal notranslate"><span class="pre">SALMON/samples/exercise_02_C2H2_lr/</span></code>.
The file <code class="docutils literal notranslate"><span class="pre">C2H2_rt_response.inp</span></code> that contains input keywords and their values.
The pseudopotential files should be the same as those used in the ground state calculation.
In the directory <code class="docutils literal notranslate"><span class="pre">restart</span></code>, those files created in the ground state calculation and stored
in the directory <code class="docutils literal notranslate"><span class="pre">data_for_restart</span></code> are included.
Therefore, copy the directory as <code class="docutils literal notranslate"><span class="pre">cp</span> <span class="pre">-R</span> <span class="pre">data_for_restart</span> <span class="pre">restart</span></code>
if you calculate at the same directory as you did the ground state calculation.</p>
<p>In the input file <code class="docutils literal notranslate"><span class="pre">C2H2_rt_response.inp</span></code>, input keywords are specified.
Most of them are mandatory to execute the linear response calculation.
This will help you to prepare the input file for other systems that you
want to calculate. A complete list of the input keywords that can be
used in the input file can be found in
<a class="reference internal" href="input_keyword_list.html#list-of-input-keywords"><span class="std std-ref">List of input keywords</span></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>!########################################################################################!
! Excercise 02: Polarizability and photoabsorption of C2H2 molecule                      !
!----------------------------------------------------------------------------------------!
! * The detail of this excercise is explained in our manual(see chapter: &#39;Exercises&#39;).   !
!   The manual can be obtained from: https://salmon-tddft.jp/documents.html              !
! * Input format consists of group of keywords like:                                     !
!     &amp;group                                                                             !
!       input keyword = xxx                                                              !
!     /                                                                                  !
!   (see chapter: &#39;List of input keywords&#39; in the manual)                                !
!----------------------------------------------------------------------------------------!
! * Conversion from unit_system = &#39;a.u.&#39; to &#39;A_eV_fs&#39;:                                   !
!   Length: 1 [a.u.] = 0.52917721067    [Angstrom]                                       !
!   Energy: 1 [a.u.] = 27.21138505      [eV]                                             !
!   Time  : 1 [a.u.] = 0.02418884326505 [fs]                                             !
!----------------------------------------------------------------------------------------!
! * Copy the ground state data directory(&#39;data_for_restart&#39;) (or make symbolic link)     !
!   calculated in &#39;samples/exercise_01_C2H2_gs/&#39; and rename the directory to &#39;restart/&#39;  !
!   in the current directory.                                                            !
!########################################################################################!

&amp;calculation
  !type of theory
  theory = &#39;tddft_response&#39;
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#theory"><span class="std std-ref">theory</span></a> specifies which theoretical method is used in the calculation.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;control
  !common name of output files
  sysname = &#39;C2H2&#39;
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#sysname"><span class="std std-ref">sysname</span></a> is a prefix for filenames of output files.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;units
  !units used in input and output files
  unit_system = &#39;A_eV_fs&#39;
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#unit-system"><span class="std std-ref">unit_system</span></a> specifies which unit system is used in the input and output files.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;system
  !periodic boundary condition
  yn_periodic = &#39;n&#39;

  !number of elements, atoms, electrons and states(orbitals)
  nelem  = 2
  natom  = 4
  nelec  = 10
  nstate = 6
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#yn-periodic"><span class="std std-ref">yn_periodic</span></a> specifies whether or not periodic boundary condition is applied.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#nelem"><span class="std std-ref">nelem</span></a> is the number of elements in the system.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#natom"><span class="std std-ref">natom</span></a> is the number of atoms in the system.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#nelec"><span class="std std-ref">nelec</span></a> is the number of electrons in the system.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#nstate"><span class="std std-ref">nstate</span></a> is the number of orbitals that are used in the calculation.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;pseudo
  !name of input pseudo potential file
  file_pseudo(1) = &#39;./C_rps.dat&#39;
  file_pseudo(2) = &#39;./H_rps.dat&#39;

  !atomic number of element
  izatom(1) = 6
  izatom(2) = 1

  !angular momentum of pseudopotential that will be treated as local
  lloc_ps(1) = 1
  lloc_ps(2) = 0
  !--- Caution ---------------------------------------!
  ! Indices must correspond to those in &amp;atomic_coor. !
  !---------------------------------------------------!
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#file-pseudo"><span class="std std-ref">file_pseudo(n)</span></a> specifies the filename of the pseudopotential file of the n-th element.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#izatom"><span class="std std-ref">izatom(n)</span></a> is the atomic number of the n-th element.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#lloc-ps"><span class="std std-ref">lloc_ps(n)</span></a> specifies which angular momentum component is chosen as the local potential for the n-th element.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;functional
  !functional(&#39;PZ&#39; is Perdew-Zunger LDA: Phys. Rev. B 23, 5048 (1981).)
  xc = &#39;PZ&#39;
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#xc"><span class="std std-ref">xc</span></a> specifies the exchange-correlation potential to be used in the calculation.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;rgrid
  !spatial grid spacing(x,y,z)
  dl(1:3) = 0.25d0, 0.25d0, 0.25d0

  !number of spatial grids(x,y,z)
  num_rgrid(1:3) = 64, 64, 64
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#dl-3"><span class="std std-ref">dl(i)</span></a> specifies the spatial grid spacing in i-th direction.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#num-rgrid-3"><span class="std std-ref">num_rgrid(i)</span></a> specifies the number of grid points in i-th direction.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;tgrid
  !time step size and number of time grids(steps)
  dt = 1.25d-3
  nt = 5000
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#dt"><span class="std std-ref">dt</span></a> specifies the time step.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#nt"><span class="std std-ref">nt</span></a> is the number of time steps for the time propagation.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;emfield
  !envelope shape of the incident pulse(&#39;impulse&#39;: impulsive field)
  ae_shape1 = &#39;impulse&#39;

  !polarization unit vector(real part) for the incident pulse(x,y,z)
  epdir_re1(1:3) = 0.0d0, 0.0d0, 1.0d0
  !--- Caution ---------------------------------------------------------!
  ! Definition of the incident pulse is written in:                     !
  ! https://www.sciencedirect.com/science/article/pii/S0010465518303412 !
  !---------------------------------------------------------------------!
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#ae-shape1"><span class="std std-ref">ae_shape1</span></a> specifies the envelope of the field. For a linear response calculation, <code class="docutils literal notranslate"><span class="pre">as_shape1='impulse'</span></code> is used. It indicates that a weak impulsive perturbation is applied at <span class="math">\(t=0\)</span>.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#epdir-re1-3"><span class="std std-ref">epdir_re1(i)</span></a> specifies the i-th component of the real part of the polarization unit vector.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;analysis
  !energy grid size and number of energy grids for output files
  de      = 1.0d-2
  nenergy = 3000
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#de"><span class="std std-ref">de</span></a> specifies the energy grid size for frequency-domain analysis.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#nenergy"><span class="std std-ref">nenergy</span></a> specifies the number of energy grid points for frequency-domain analysis.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;atomic_coor
  !cartesian atomic coodinates
  &#39;C&#39;    0.000000    0.000000    0.599672  1
  &#39;H&#39;    0.000000    0.000000    1.662257  2
  &#39;C&#39;    0.000000    0.000000   -0.599672  1
  &#39;H&#39;    0.000000    0.000000   -1.662257  2
  !--- Format ---------------------------------------------------!
  ! &#39;symbol&#39; x y z index(correspond to that of pseudo potential) !
  !--------------------------------------------------------------!
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#atomic-coor"><span class="std std-ref">&amp;atomic_coor</span></a> specifies spatial coordinates of atoms.</div>
</div>
</div>
<div class="section" id="id3">
<h4>Execusion<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h4>
<p>Before execusion, remember to copy the directory <code class="docutils literal notranslate"><span class="pre">restart</span></code> that is created in the ground
state calculation as <code class="docutils literal notranslate"><span class="pre">data_for_restart</span></code> in the present directory.
In a multiprocess environment, calculation will be executed as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ mpiexec -n NPROC salmon &lt; C2H2_rt_response.inp &gt; C2H2_rt_response.out
</pre></div>
</div>
<p>where NPROC is the number of MPI processes.
A standard output will be stored in the file <code class="docutils literal notranslate"><span class="pre">C2H2_rt_response.out</span></code>.</p>
</div>
<div class="section" id="output-files-2">
<span id="id4"></span><h4>Output files<a class="headerlink" href="#output-files-2" title="Permalink to this headline">¶</a></h4>
<p>After the calculation, following output files are created in the
directory that you run the code in addition to the standard output file,</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>file name</td>
<td>description</td>
</tr>
<tr class="row-even"><td><em>C2H2_response.data</em></td>
<td>polarizability and oscillator
strength distribution as
functions of energy</td>
</tr>
<tr class="row-odd"><td><em>C2H2_rt.data</em></td>
<td><div class="first last line-block">
<div class="line">components of
change of dipole moment
(electrons/plus definition)</div>
<div class="line">and total dipole moment
(electrons/minus + ions/plus)
as functions of time</div>
</div>
</td>
</tr>
<tr class="row-even"><td><em>C2H2_rt_energy.data</em></td>
<td>total energy and electronic
excitation energy
as functions of time</td>
</tr>
<tr class="row-odd"><td><em>PS_C_KY_n.dat</em></td>
<td>information on pseodupotential
file for carbon atom</td>
</tr>
<tr class="row-even"><td><em>PS_H_KY_n.dat</em></td>
<td>information on pseodupotential
file for hydrogen atom</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line">You may download the above files (zipped file) from:</div>
<div class="line"><a class="reference external" href="https://salmon-tddft.jp/webmanual/v_2_0_1/exercise_zip_files/02_C2H2_lr.zip">https://salmon-tddft.jp/webmanual/v_2_0_1/exercise_zip_files/02_C2H2_lr.zip</a></div>
</div>
<p>We first explain the standard output file. In the beginning of the file,
input variables used in the calculation are shown.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##############################################################################</span>
<span class="c1"># SALMON: Scalable Ab-initio Light-Matter simulator for Optics and Nanoscience</span>
<span class="c1">#</span>
<span class="c1">#                             Version 2.0.1</span>
<span class="c1">##############################################################################</span>
  <span class="n">Libxc</span><span class="p">:</span> <span class="p">[</span><span class="n">disabled</span><span class="p">]</span>
   <span class="n">theory</span><span class="o">=</span> <span class="n">tddft_response</span>

 <span class="n">Total</span> <span class="n">time</span> <span class="n">step</span>      <span class="o">=</span>        <span class="mi">5000</span>
 <span class="n">Time</span> <span class="n">step</span><span class="p">[</span><span class="n">fs</span><span class="p">]</span>        <span class="o">=</span>  <span class="mf">1.250000000000000E-003</span>
 <span class="n">Energy</span> <span class="nb">range</span>         <span class="o">=</span>        <span class="mi">3000</span>
 <span class="n">Energy</span> <span class="n">resolution</span><span class="p">[</span><span class="n">eV</span><span class="p">]</span><span class="o">=</span>  <span class="mf">1.000000000000000E-002</span>
 <span class="n">Field</span> <span class="n">strength</span><span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">u</span><span class="o">.</span><span class="p">]</span> <span class="o">=</span>  <span class="mf">1.000000000000000E-002</span>
   <span class="n">use</span> <span class="n">of</span> <span class="n">real</span> <span class="n">value</span> <span class="n">orbitals</span> <span class="o">=</span>  <span class="n">F</span>
 <span class="o">======</span>
 <span class="o">.........</span>
</pre></div>
</div>
<p>After that, the time evolution loop starts. At every 10 iteration steps,
the time, dipole moments in three Cartesian directions, the total number
of electrons, the total energy, and the number of iterations solving
the Poisson equation are displayed.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="n">time</span><span class="o">-</span><span class="n">step</span>    <span class="n">time</span><span class="p">[</span><span class="n">fs</span><span class="p">]</span>                           <span class="n">Dipole</span> <span class="n">moment</span><span class="p">(</span><span class="n">xyz</span><span class="p">)[</span><span class="n">A</span><span class="p">]</span>      <span class="n">electrons</span>  <span class="n">Total</span> <span class="n">energy</span><span class="p">[</span><span class="n">eV</span><span class="p">]</span>    <span class="n">iterVh</span>
<span class="c1">#----------------------------------------------------------------------</span>
      <span class="mi">10</span>    <span class="mf">0.01250000</span> <span class="o">-</span><span class="mf">0.56521137E-07</span> <span class="o">-</span><span class="mf">0.28812833E-07</span> <span class="o">-</span><span class="mf">0.25558983E-01</span>    <span class="mf">10.00000000</span>     <span class="o">-</span><span class="mf">339.68150366</span>   <span class="mi">34</span>
      <span class="mi">20</span>    <span class="mf">0.02500000</span> <span class="o">-</span><span class="mf">0.19835467E-06</span> <span class="o">-</span><span class="mf">0.10147641E-06</span> <span class="o">-</span><span class="mf">0.45169126E-01</span>     <span class="mf">9.99999999</span>     <span class="o">-</span><span class="mf">339.68147442</span>   <span class="mi">49</span>
      <span class="mi">30</span>    <span class="mf">0.03750000</span> <span class="o">-</span><span class="mf">0.37937911E-06</span> <span class="o">-</span><span class="mf">0.19537418E-06</span> <span class="o">-</span><span class="mf">0.57843871E-01</span>     <span class="mf">9.99999999</span>     <span class="o">-</span><span class="mf">339.68146891</span>   <span class="mi">45</span>
      <span class="mi">40</span>    <span class="mf">0.05000000</span> <span class="o">-</span><span class="mf">0.56465010E-06</span> <span class="o">-</span><span class="mf">0.29324906E-06</span> <span class="o">-</span><span class="mf">0.64072126E-01</span>     <span class="mf">9.99999999</span>     <span class="o">-</span><span class="mf">339.68146804</span>   <span class="mi">38</span>
      <span class="mi">50</span>    <span class="mf">0.06250000</span> <span class="o">-</span><span class="mf">0.73343753E-06</span> <span class="o">-</span><span class="mf">0.38431758E-06</span> <span class="o">-</span><span class="mf">0.65208422E-01</span>     <span class="mf">9.99999999</span>     <span class="o">-</span><span class="mf">339.68146679</span>   <span class="mi">25</span>
      <span class="mi">60</span>    <span class="mf">0.07500000</span> <span class="o">-</span><span class="mf">0.87559727E-06</span> <span class="o">-</span><span class="mf">0.46276791E-06</span> <span class="o">-</span><span class="mf">0.62464066E-01</span>     <span class="mf">9.99999999</span>     <span class="o">-</span><span class="mf">339.68146321</span>   <span class="mi">35</span>
      <span class="mi">70</span>    <span class="mf">0.08750000</span> <span class="o">-</span><span class="mf">0.98769124E-06</span> <span class="o">-</span><span class="mf">0.52594670E-06</span> <span class="o">-</span><span class="mf">0.56740338E-01</span>     <span class="mf">9.99999998</span>     <span class="o">-</span><span class="mf">339.68145535</span>   <span class="mi">20</span>
      <span class="mi">80</span>    <span class="mf">0.10000000</span> <span class="o">-</span><span class="mf">0.10701350E-05</span> <span class="o">-</span><span class="mf">0.57309375E-06</span> <span class="o">-</span><span class="mf">0.48483747E-01</span>     <span class="mf">9.99999998</span>     <span class="o">-</span><span class="mf">339.68144840</span>   <span class="mi">40</span>
      <span class="mi">90</span>    <span class="mf">0.11250000</span> <span class="o">-</span><span class="mf">0.11253992E-05</span> <span class="o">-</span><span class="mf">0.60455485E-06</span> <span class="o">-</span><span class="mf">0.38296037E-01</span>     <span class="mf">9.99999998</span>     <span class="o">-</span><span class="mf">339.68144186</span>   <span class="mi">21</span>
</pre></div>
</div>
<p>Explanations of other output files are given below:</p>
<p><strong>C2H2_rt.data</strong></p>
<p>Results of time evolution calculation for vector potential, electric field, and dipole moment.
In the first several lines, explanations of included data are given.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Real time calculation:</span>
<span class="c1"># Ac_ext: External vector potential field</span>
<span class="c1"># E_ext: External electric field</span>
<span class="c1"># Ac_tot: Total vector potential field</span>
<span class="c1"># E_tot: Total electric field</span>
<span class="c1"># ddm_e: Change of dipole moment (electrons/plus definition)</span>
<span class="c1"># dm: Total dipole moment (electrons/minus + ions/plus)</span>
<span class="c1"># 1:Time[fs] 2:Ac_ext_x[fs*V/Angstrom] 3:Ac_ext_y[fs*V/Angstrom] 4:Ac_ext_z[fs*V/Angstrom]</span>
<span class="c1"># 5:E_ext_x[V/Angstrom] 6:E_ext_y[V/Angstrom] 7:E_ext_z[V/Angstrom]</span>
<span class="c1"># 8:Ac_tot_x[fs*V/Angstrom] 9:Ac_tot_y[fs*V/Angstrom] 10:Ac_tot_z[fs*V/Angstrom]</span>
<span class="c1"># 11:E_tot_x[V/Angstrom] 12:E_tot_y[V/Angstrom] 13:E_tot_z[V/Angstrom]</span>
<span class="c1"># 14:ddm_e_x[Angstrom] 15:ddm_e_y[Angstrom] 16:ddm_e_z[Angstrom] 17:dm_x[Angstrom]</span>
<span class="c1"># 18:dm_y[Angstrom] 19:dm_z[Angstrom]</span>
</pre></div>
</div>
<p>Using first column (time in femtosecond) and 19th column (dipole moment in <span class="math">\(z\)</span> direction),
the following graph can be drawn.</p>
<blockquote>
<div><a class="reference internal image-reference" href="_images/exc2-dipole.png"><img alt="_images/exc2-dipole.png" src="_images/exc2-dipole.png" style="width: 396.4px; height: 284.0px;" /></a>
</div></blockquote>
<p>The dipole moment shows oscillations in femtosecond time scale that reflec electronic excitations.</p>
<p><strong>C2H2_response.data</strong></p>
<p>Time-frequency Fourier transformation of the dipole moment gives
the polarizability and the strength function.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fourier-transform spectra:</span>
<span class="c1"># alpha: Polarizability</span>
<span class="c1"># df/dE: Strength function</span>
<span class="c1"># 1:Energy[eV] 2:Re(alpha_x)[Augstrom^2/V] 3:Re(alpha_y)[Augstrom^2/V]</span>
<span class="c1"># 4:Re(alpha_z)[Augstrom^2/V] 5:Im(alpha_x)[Augstrom^2/V] 6:Im(alpha_y)[Augstrom^2/V]</span>
<span class="c1"># 7:Im(alpha_z)[Augstrom^2/V] 8:df_x/dE[none] 9:df_y/dE[none] 10:df_z/dE[none]</span>
</pre></div>
</div>
<p>Using first column (energy in electron-volt) and 10th column (oscillator strength distribution in <span class="math">\(z\)</span> direction),
the following graph can be drawn.</p>
<blockquote>
<div><a class="reference internal image-reference" href="_images/exc2-response.png"><img alt="_images/exc2-response.png" src="_images/exc2-response.png" style="width: 398.4px; height: 282.8px;" /></a>
</div></blockquote>
<p>There appears many peaks above the HOMO-LUMO gap energy.
The strong excitation appears at around 9.3 eV.</p>
<p><strong>C2H2_rt_energy.data</strong></p>
<p>Energies are stored as functions of time.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Real time calculation:</span>
<span class="c1"># Eall: Total energy</span>
<span class="c1"># Eall0: Initial energy</span>
<span class="c1"># 1:Time[fs] 2:Eall[eV] 3:Eall-Eall0[eV]</span>
</pre></div>
</div>
<p><em>Eall</em> and <em>Eall-Eall0</em> are total energy and electronic excitation energy, respectively.</p>
</div>
</div>
<div class="section" id="exercise-3-electron-dynamics-in-c2h2-molecule-under-a-pulsed-electric-field">
<span id="exercise-3"></span><h3>Exercise-3: Electron dynamics in C2H2 molecule under a pulsed electric field<a class="headerlink" href="#exercise-3-electron-dynamics-in-c2h2-molecule-under-a-pulsed-electric-field" title="Permalink to this headline">¶</a></h3>
<p>In this exercise, we learn the calculation of the electron dynamics in
the acetylene (C2H2) molecule under a pulsed electric field, solving the
time-dependent Kohn-Sham equation. As outputs of the calculation, such
quantities as the total energy and the electric dipole moment of the
system as functions of time are calculated. This tutorial should be
carried out after finishing the ground state calculation that was
explained in <a class="reference internal" href="#exercise-1"><span class="std std-ref">Exercise-1</span></a>.</p>
<p>In the calculation, a pulsed electric field specified by the following
vector potential will be used,</p>
<p><span class="math">\(A(t) = - \frac{E_0}{\omega} \hat z \cos^2 \frac{\pi}{T} \left( t - \frac{T}{2} \right) \sin \omega \left( t - \frac{T}{2} \right), \hspace{5mm} (0 &lt; t &lt; T).\)</span></p>
<p>The electric field is given by <span class="math">\(E(t) = -(1/c)(dA(t)/dt)\)</span>.
The parameters that characterize the pulsed field such as the amplitude <span class="math">\(E_0\)</span>,
frequency <span class="math">\(\omega\)</span>, pulse duration <span class="math">\(T\)</span>, polarization direction <span class="math">\(\hat z\)</span>,
are specified in the input file.
In the time dependent Kohn-Sham equation, the external field is included as
the scalar potential, <span class="math">\(V_{\rm ext}(\mathbf{r},t) = eE(t)z\)</span>.</p>
<div class="section" id="input-files-2">
<span id="id5"></span><h4>Input files<a class="headerlink" href="#input-files-2" title="Permalink to this headline">¶</a></h4>
<p>To run the code, following files are necessary:</p>
<table border="1" class="docutils">
<colgroup>
<col width="36%" />
<col width="64%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>file name</td>
<td>description</td>
</tr>
<tr class="row-even"><td><em>C2H2_rt_pulse.inp</em></td>
<td>input file that contain input
keywords and their values.</td>
</tr>
<tr class="row-odd"><td><em>C_rps.dat</em></td>
<td>pseodupotential file for carbon</td>
</tr>
<tr class="row-even"><td><em>H_rps.dat</em></td>
<td>pseudopotential file for hydrogen</td>
</tr>
<tr class="row-odd"><td><em>restart</em></td>
<td><div class="first last line-block">
<div class="line">directory created in the ground state calculation</div>
<div class="line">(rename the directory from <em>data_for_restart</em> to <em>restart</em>)</div>
</div>
</td>
</tr>
</tbody>
</table>
<p>First three files are prepared in the directory <code class="docutils literal notranslate"><span class="pre">SALMON/samples/exercise_03_C2H2_rt/</span></code>.
The file <code class="docutils literal notranslate"><span class="pre">C2H2_rt_pulse.inp</span></code> that contains input keywords and their values.
The pseudopotential files should be the same as those used in the ground state calculation.
In the directory <code class="docutils literal notranslate"><span class="pre">restart</span></code>, those files created in the ground state calculation and stored
in the directory <code class="docutils literal notranslate"><span class="pre">data_for_restart</span></code> are included.
Therefore, copy the directory as <code class="docutils literal notranslate"><span class="pre">cp</span> <span class="pre">-R</span> <span class="pre">data_for_restart</span> <span class="pre">restart</span></code>
if you calculate at the same directory as you did the ground state calculation.</p>
<p>In the input file <code class="docutils literal notranslate"><span class="pre">C2H2_rt_pulse.inp</span></code>, input keywords are specified.
Most of them are mandatory to execute the calculation of
electron dynamics induced by a pulsed electric field.
This will help you to prepare the input file for other systems and other
pulsed electric fields that you want to calculate. A complete list of
the input keywords that can be used in the input file can be found in
<a class="reference internal" href="input_keyword_list.html#list-of-input-keywords"><span class="std std-ref">List of input keywords</span></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>!########################################################################################!
! Excercise 03:  Electron dynamics in C2H2 molecule under a pulsed electric field        !
!----------------------------------------------------------------------------------------!
! * The detail of this excercise is explained in our manual(see chapter: &#39;Exercises&#39;).   !
!   The manual can be obtained from: https://salmon-tddft.jp/documents.html              !
! * Input format consists of group of keywords like:                                     !
!     &amp;group                                                                             !
!       input keyword = xxx                                                              !
!     /                                                                                  !
!   (see chapter: &#39;List of input keywords&#39; in the manual)                                !
!----------------------------------------------------------------------------------------!
! * Conversion from unit_system = &#39;a.u.&#39; to &#39;A_eV_fs&#39;:                                   !
!   Length: 1 [a.u.] = 0.52917721067    [Angstrom]                                       !
!   Energy: 1 [a.u.] = 27.21138505      [eV]                                             !
!   Time  : 1 [a.u.] = 0.02418884326505 [fs]                                             !
!----------------------------------------------------------------------------------------!
! * Copy the ground state data directory(&#39;data_for_restart&#39;) (or make symbolic link)     !
!   calculated in &#39;samples/exercise_01_C2H2_gs/&#39; and rename the directory to &#39;restart/&#39;  !
!   in the current directory.                                                            !
!########################################################################################!

&amp;calculation
  !type of theory
  theory = &#39;tddft_pulse&#39;
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#theory"><span class="std std-ref">theory</span></a> specifies which theoretical method is used in the calculation.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;control
  !common name of output files
  sysname = &#39;C2H2&#39;
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#sysname"><span class="std std-ref">sysname</span></a> is a prefix for filenames of output files.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;units
  !units used in input and output files
  unit_system = &#39;A_eV_fs&#39;
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#unit-system"><span class="std std-ref">unit_system</span></a> specifies which unit system is used in the input and output files.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;system
  !periodic boundary condition
  yn_periodic = &#39;n&#39;

  !number of elements, atoms, electrons and states(orbitals)
  nelem  = 2
  natom  = 4
  nelec  = 10
  nstate = 6
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#yn-periodic"><span class="std std-ref">yn_periodic</span></a> specifies whether or not periodic boundary condition is applied.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#nelem"><span class="std std-ref">nelem</span></a> is the number of elements in the system.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#natom"><span class="std std-ref">natom</span></a> is the number of atoms in the system.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#nelec"><span class="std std-ref">nelec</span></a> is the number of electrons in the system.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#nstate"><span class="std std-ref">nstate</span></a> is the number of orbitals that are used in the calculation.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;pseudo
  !name of input pseudo potential file
  file_pseudo(1) = &#39;./C_rps.dat&#39;
  file_pseudo(2) = &#39;./H_rps.dat&#39;

  !atomic number of element
  izatom(1) = 6
  izatom(2) = 1

  !angular momentum of pseudopotential that will be treated as local
  lloc_ps(1) = 1
  lloc_ps(2) = 0
  !--- Caution ---------------------------------------!
  ! Indices must correspond to those in &amp;atomic_coor. !
  !---------------------------------------------------!
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#file-pseudo"><span class="std std-ref">file_pseudo(n)</span></a> specifies the filename of the pseudopotential file of the n-th element.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#izatom"><span class="std std-ref">izatom(n)</span></a> is the atomic number of the n-th element.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#lloc-ps"><span class="std std-ref">lloc_ps(n)</span></a> specifies which angular momentum component is chosen as the local potential for the n-th element.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;functional
  !functional(&#39;PZ&#39; is Perdew-Zunger LDA: Phys. Rev. B 23, 5048 (1981).)
  xc = &#39;PZ&#39;
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#xc"><span class="std std-ref">xc</span></a> specifies the exchange-correlation potential to be used in the calculation.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;rgrid
  !spatial grid spacing(x,y,z)
  dl(1:3) = 0.25d0, 0.25d0, 0.25d0

  !number of spatial grids(x,y,z)
  num_rgrid(1:3) = 64, 64, 64
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#dl-3"><span class="std std-ref">dl(i)</span></a> specifies the spatial grid spacing in i-th direction.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#num-rgrid-3"><span class="std std-ref">num_rgrid(i)</span></a> specifies the number of grid points in i-th direction.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;tgrid
  !time step size and number of time grids(steps)
  dt = 1.25d-3
  nt = 5000
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#dt"><span class="std std-ref">dt</span></a> specifies the time step.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#nt"><span class="std std-ref">nt</span></a> is the number of time steps for the time propagation.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;emfield
  !envelope shape of the incident pulse(&#39;Ecos2&#39;: cos^2 type envelope for scalar potential)
  ae_shape1 = &#39;Acos2&#39;

  !peak intensity(W/cm^2) of the incident pulse
  I_wcm2_1 = 5.00d13

  !duration of the incident pulse
  tw1 = 6.00d0

  !mean photon energy(average frequency multiplied by the Planck constant) of the incident pulse
  omega1 = 3.10d0

  !polarization unit vector(real part) for the incident pulse(x,y,z)
  epdir_re1(1:3) = 0.00d0, 0.00d0, 1.00d0
  !--- Caution ---------------------------------------------------------!
  ! Definition of the incident pulse is written in:                     !
  ! https://www.sciencedirect.com/science/article/pii/S0010465518303412 !
  !---------------------------------------------------------------------!
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#ae-shape1"><span class="std std-ref">ae_shape1</span></a> specifies the envelope of the field.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#i-wcm2-1"><span class="std std-ref">I_wcm2_1</span></a> specify the intensity of the pulse in unit of W/cm<sup>2</sup>.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#tw1"><span class="std std-ref">tw1</span></a> specifies the duration of the pulse.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#omega1"><span class="std std-ref">omega1</span></a> specifies the mean photon energy of the pulse.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#epdir-re1-3"><span class="std std-ref">epdir_re1(i)</span></a> specifies the i-th component of the real part of the polarization unit vector.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;analysis
  !energy grid size and number of energy grids for output files
  de      = 1.0d-2
  nenergy = 10000
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#de"><span class="std std-ref">de</span></a> specifies the energy grid size for frequency-domain analysis.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#nenergy"><span class="std std-ref">nenergy</span></a> specifies the number of energy grid points for frequency-domain analysis.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;atomic_coor
  !cartesian atomic coodinates
  &#39;C&#39;    0.000000    0.000000    0.599672  1
  &#39;H&#39;    0.000000    0.000000    1.662257  2
  &#39;C&#39;    0.000000    0.000000   -0.599672  1
  &#39;H&#39;    0.000000    0.000000   -1.662257  2
  !--- Format ---------------------------------------------------!
  ! &#39;symbol&#39; x y z index(correspond to that of pseudo potential) !
  !--------------------------------------------------------------!
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#atomic-coor"><span class="std std-ref">&amp;atomic_coor</span></a> specifies spatial coordinates of atoms.</div>
</div>
</div>
<div class="section" id="id6">
<h4>Execusion<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h4>
<p>Before execusion, remember to copy the directory <code class="docutils literal notranslate"><span class="pre">restart</span></code> that is created in the ground
state calculation as <code class="docutils literal notranslate"><span class="pre">data_for_restart</span></code> in the present directory.
In a multiprocess environment, calculation will be executed as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ mpiexec -n NPROC salmon &lt; C2H2_rt_pulse.inp &gt; C2H2_rt_pulse.out
</pre></div>
</div>
<p>where NPROC is the number of MPI processes.
A standard output will be stored in the file <code class="docutils literal notranslate"><span class="pre">C2H2_rt_pulse.out</span></code>.</p>
</div>
<div class="section" id="output-files-3">
<span id="id7"></span><h4>Output files<a class="headerlink" href="#output-files-3" title="Permalink to this headline">¶</a></h4>
<p>After the calculation, following output files are created in the
directory that you run the code in addition to the standard output file,</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>file name</td>
<td>description</td>
</tr>
<tr class="row-even"><td><em>C2H2_pulse.data</em></td>
<td>time-frequency Fourier transform
of dipole moment</td>
</tr>
<tr class="row-odd"><td><em>C2H2_rt.data</em></td>
<td><div class="first last line-block">
<div class="line">components of
change of dipole moment
(electrons/plus definition)</div>
<div class="line">and total dipole moment
(electrons/minus + ions/plus)
as functions of time</div>
</div>
</td>
</tr>
<tr class="row-even"><td><em>C2H2_rt_energy.data</em></td>
<td>total energy and electronic
excitation energy
as functions of time</td>
</tr>
<tr class="row-odd"><td><em>PS_C_KY_n.dat</em></td>
<td>information on pseodupotential
file for carbon atom</td>
</tr>
<tr class="row-even"><td><em>PS_H_KY_n.dat</em></td>
<td>information on pseodupotential
file for hydrogen atom</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line">You may download the above files (zipped file) from:</div>
<div class="line"><a class="reference external" href="https://salmon-tddft.jp/webmanual/v_2_0_1/exercise_zip_files/03_C2H2_rt.zip">https://salmon-tddft.jp/webmanual/v_2_0_1/exercise_zip_files/03_C2H2_rt.zip</a></div>
</div>
<p>We first explain the standard output file. In the beginning of the file, input variables
used in the calculation are shown.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##############################################################################</span>
<span class="c1"># SALMON: Scalable Ab-initio Light-Matter simulator for Optics and Nanoscience</span>
<span class="c1">#</span>
<span class="c1">#                             Version 2.0.1</span>
<span class="c1">##############################################################################</span>
  <span class="n">Libxc</span><span class="p">:</span> <span class="p">[</span><span class="n">disabled</span><span class="p">]</span>
   <span class="n">theory</span><span class="o">=</span> <span class="n">tddft_pulse</span>

 <span class="n">Total</span> <span class="n">time</span> <span class="n">step</span>      <span class="o">=</span>        <span class="mi">5000</span>
 <span class="n">Time</span> <span class="n">step</span><span class="p">[</span><span class="n">fs</span><span class="p">]</span>        <span class="o">=</span>  <span class="mf">1.250000000000000E-003</span>
 <span class="n">Energy</span> <span class="nb">range</span>         <span class="o">=</span>       <span class="mi">10000</span>
 <span class="n">Energy</span> <span class="n">resolution</span><span class="p">[</span><span class="n">eV</span><span class="p">]</span><span class="o">=</span>  <span class="mf">1.000000000000000E-002</span>
<span class="n">Laser</span> <span class="n">frequency</span>     <span class="o">=</span> <span class="mf">3.10</span><span class="p">[</span><span class="n">eV</span><span class="p">]</span>
<span class="n">Pulse</span> <span class="n">width</span> <span class="n">of</span> <span class="n">laser</span><span class="o">=</span>      <span class="mf">6.00000000</span><span class="p">[</span><span class="n">fs</span><span class="p">]</span>
<span class="n">Laser</span> <span class="n">intensity</span>     <span class="o">=</span>  <span class="mf">0.50000000E+14</span><span class="p">[</span><span class="n">W</span><span class="o">/</span><span class="n">cm</span><span class="o">^</span><span class="mi">2</span><span class="p">]</span>
   <span class="n">use</span> <span class="n">of</span> <span class="n">real</span> <span class="n">value</span> <span class="n">orbitals</span> <span class="o">=</span>  <span class="n">F</span>
 <span class="o">======</span>
 <span class="o">........</span>
</pre></div>
</div>
<p>After that, the time evolution loop starts. At every 10 iteration steps,
the time, dipole moments in three Cartesian directions, the total number of electrons,
the total energy, and the number of iterations solving the Poisson equation
are displayed.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="n">time</span><span class="o">-</span><span class="n">step</span>    <span class="n">time</span><span class="p">[</span><span class="n">fs</span><span class="p">]</span>                           <span class="n">Dipole</span> <span class="n">moment</span><span class="p">(</span><span class="n">xyz</span><span class="p">)[</span><span class="n">A</span><span class="p">]</span>      <span class="n">electrons</span>  <span class="n">Total</span> <span class="n">energy</span><span class="p">[</span><span class="n">eV</span><span class="p">]</span>    <span class="n">iterVh</span>
<span class="c1">#----------------------------------------------------------------------</span>
      <span class="mi">10</span>    <span class="mf">0.01250000</span> <span class="o">-</span><span class="mf">0.57275542E-07</span> <span class="o">-</span><span class="mf">0.29197105E-07</span> <span class="o">-</span><span class="mf">0.74600728E-06</span>    <span class="mf">10.00000000</span>     <span class="o">-</span><span class="mf">339.69524047</span>    <span class="mi">1</span>
      <span class="mi">20</span>    <span class="mf">0.02500000</span> <span class="o">-</span><span class="mf">0.20616352E-06</span> <span class="o">-</span><span class="mf">0.10537273E-06</span> <span class="o">-</span><span class="mf">0.10256205E-04</span>    <span class="mf">10.00000000</span>     <span class="o">-</span><span class="mf">339.69524348</span>    <span class="mi">1</span>
      <span class="mi">30</span>    <span class="mf">0.03750000</span> <span class="o">-</span><span class="mf">0.40063325E-06</span> <span class="o">-</span><span class="mf">0.20597522E-06</span> <span class="o">-</span><span class="mf">0.47397133E-04</span>    <span class="mf">10.00000000</span>     <span class="o">-</span><span class="mf">339.69524090</span>    <span class="mi">3</span>
      <span class="mi">40</span>    <span class="mf">0.05000000</span> <span class="o">-</span><span class="mf">0.59093535E-06</span> <span class="o">-</span><span class="mf">0.30630513E-06</span> <span class="o">-</span><span class="mf">0.13774845E-03</span>    <span class="mf">10.00000000</span>     <span class="o">-</span><span class="mf">339.69524287</span>    <span class="mi">1</span>
      <span class="mi">50</span>    <span class="mf">0.06250000</span> <span class="o">-</span><span class="mf">0.75588343E-06</span> <span class="o">-</span><span class="mf">0.39552925E-06</span> <span class="o">-</span><span class="mf">0.31097825E-03</span>    <span class="mf">10.00000000</span>     <span class="o">-</span><span class="mf">339.69523949</span>    <span class="mi">5</span>
      <span class="mi">60</span>    <span class="mf">0.07500000</span> <span class="o">-</span><span class="mf">0.89221538E-06</span> <span class="o">-</span><span class="mf">0.47142217E-06</span> <span class="o">-</span><span class="mf">0.59735355E-03</span>    <span class="mf">10.00000000</span>     <span class="o">-</span><span class="mf">339.69523784</span>   <span class="mi">11</span>
      <span class="mi">70</span>    <span class="mf">0.08750000</span> <span class="o">-</span><span class="mf">0.99769538E-06</span> <span class="o">-</span><span class="mf">0.53192187E-06</span> <span class="o">-</span><span class="mf">0.10253308E-02</span>    <span class="mf">10.00000000</span>     <span class="o">-</span><span class="mf">339.69523285</span>    <span class="mi">5</span>
      <span class="mi">80</span>    <span class="mf">0.10000000</span> <span class="o">-</span><span class="mf">0.10738281E-05</span> <span class="o">-</span><span class="mf">0.57676878E-06</span> <span class="o">-</span><span class="mf">0.16195168E-02</span>     <span class="mf">9.99999999</span>     <span class="o">-</span><span class="mf">339.69522482</span>   <span class="mi">19</span>
      <span class="mi">90</span>    <span class="mf">0.11250000</span> <span class="o">-</span><span class="mf">0.11250289E-05</span> <span class="o">-</span><span class="mf">0.60722757E-06</span> <span class="o">-</span><span class="mf">0.23985719E-02</span>     <span class="mf">9.99999999</span>     <span class="o">-</span><span class="mf">339.69521092</span>    <span class="mi">2</span>
</pre></div>
</div>
<p>Explanations of other output files are given below:</p>
<p><strong>C2H2_rt.data</strong></p>
<p>Results of time evolution calculation for vector potential, electric field, and dipole moment.
In the first several lines, explanations of data included data are given.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Real time calculation:</span>
<span class="c1"># Ac_ext: External vector potential field</span>
<span class="c1"># E_ext: External electric field</span>
<span class="c1"># Ac_tot: Total vector potential field</span>
<span class="c1"># E_tot: Total electric field</span>
<span class="c1"># ddm_e: Change of dipole moment (electrons/plus definition)</span>
<span class="c1"># dm: Total dipole moment (electrons/minus + ions/plus)</span>
<span class="c1"># 1:Time[fs] 2:Ac_ext_x[fs*V/Angstrom] 3:Ac_ext_y[fs*V/Angstrom] 4:Ac_ext_z[fs*V/Angstrom]</span>
<span class="c1"># 5:E_ext_x[V/Angstrom] 6:E_ext_y[V/Angstrom] 7:E_ext_z[V/Angstrom]</span>
<span class="c1"># 8:Ac_tot_x[fs*V/Angstrom] 9:Ac_tot_y[fs*V/Angstrom] 10:Ac_tot_z[fs*V/Angstrom]</span>
<span class="c1"># 11:E_tot_x[V/Angstrom] 12:E_tot_y[V/Angstrom] 13:E_tot_z[V/Angstrom]</span>
<span class="c1"># 14:ddm_e_x[Angstrom] 15:ddm_e_y[Angstrom] 16:ddm_e_z[Angstrom] 17:dm_x[Angstrom]</span>
<span class="c1"># 18:dm_y[Angstrom] 19:dm_z[Angstrom]</span>
</pre></div>
</div>
<p>The applied electric field is drawn using the first column (time in femtosecond) and the 7th column
(electric field in <span class="math">\(z\)</span> direction in Volt per Angstrom).</p>
<blockquote>
<div><a class="reference internal image-reference" href="_images/exc3-Efield.png"><img alt="_images/exc3-Efield.png" src="_images/exc3-Efield.png" style="width: 402.8px; height: 286.8px;" /></a>
</div></blockquote>
<p>The induced dipole moment is drawn using the first column (time in femtosecond) and 19th column
(dipole moment in <span class="math">\(z\)</span> direction).
It shows an oscillation similar to the applied electric field. However, the response is not linear
since the applied electric field is rather strong.</p>
<blockquote>
<div><a class="reference internal image-reference" href="_images/exc3-dipole.png"><img alt="_images/exc3-dipole.png" src="_images/exc3-dipole.png" style="width: 404.8px; height: 286.0px;" /></a>
</div></blockquote>
<p><strong>C2H2_pulse.data</strong></p>
<p>Time-frequency Fourier transformation of the dipole moment.
In the first several lines, explanations of data included data are given.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fourier-transform spectra:</span>
<span class="c1"># energy: Frequency</span>
<span class="c1"># dm: Dopile moment</span>
<span class="c1"># 1:energy[eV] 2:Re(dm_x)[fs*Angstrom] 3:Re(dm_y)[fs*Angstrom] 4:Re(dm_z)[fs*Angstrom]</span>
<span class="c1"># 5:Im(dm_x)[fs*Angstrom] 6:Im(dm_y)[fs*Angstrom] 7:Im(dm_z)[fs*Angstrom]</span>
<span class="c1"># 8:|dm_x|^2[fs^2*Angstrom^2] 9:|dm_y|^2[fs^2*Angstrom^2] 10:|dm_z|^2[fs^2*Angstrom^2]</span>
</pre></div>
</div>
<p>The spectrum of the induced dipole moment, <span class="math">\(|d(\omega)|^2\)</span> is shown in logarithmic scale as a function
of the energy, <span class="math">\(\hbar \omega\)</span>. High harmonic generations are visible in the spectrum.</p>
<blockquote>
<div><a class="reference internal image-reference" href="_images/exc3-spectrum.png"><img alt="_images/exc3-spectrum.png" src="_images/exc3-spectrum.png" style="width: 402.8px; height: 286.0px;" /></a>
</div></blockquote>
<p><strong>C2H2_rt_energy.data</strong></p>
<p>Energies are stored as functions of time.
In the first several lines, explanations of data included data are given.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Real time calculation:</span>
<span class="c1"># Eall: Total energy</span>
<span class="c1"># Eall0: Initial energy</span>
<span class="c1"># 1:Time[fs] 2:Eall[eV] 3:Eall-Eall0[eV]</span>
</pre></div>
</div>
<p><em>Eall</em> and <em>Eall-Eall0</em> are total energy and electronic excitation energy, respectively.
The figure below shows the electronic excitation energy as a function of time,
using the first column (time in femtosecond) and the 3rd column (<em>Eall-Eall0</em>).
Although the frequency is below the HOMO-LUMO gap energy, electronic excitations take
place because of nonlinear absorption process.</p>
<blockquote>
<div><a class="reference internal image-reference" href="_images/exc3-Eex.png"><img alt="_images/exc3-Eex.png" src="_images/exc3-Eex.png" style="width: 404.8px; height: 279.6px;" /></a>
</div></blockquote>
</div>
<div class="section" id="additional-exercise">
<h4>Additional exercise<a class="headerlink" href="#additional-exercise" title="Permalink to this headline">¶</a></h4>
<p>If we change parameters of the applied electric field, we find a drastic change
in the electronic excitations. In the example below, we increase the intensity
from <code class="docutils literal notranslate"><span class="pre">I_wcm2_1</span> <span class="pre">=</span> <span class="pre">5.00d13</span></code> to <code class="docutils literal notranslate"><span class="pre">I_wcm2_1</span> <span class="pre">=</span> <span class="pre">1.00d12</span></code> and changes the frequency
from <code class="docutils literal notranslate"><span class="pre">omega1</span> <span class="pre">=</span> <span class="pre">3.10d0</span></code> to <code class="docutils literal notranslate"><span class="pre">omega1</span> <span class="pre">=</span> <span class="pre">9.28d0</span></code>. The new frequency corresponds
to the resonant excitation energy seen in the linear response analysis shown in
in <a class="reference internal" href="#exercise-2"><span class="std std-ref">Exercise-2</span></a>.</p>
<p>The change in the input file is shown below.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;emfield
  !envelope shape of the incident pulse(&#39;Ecos2&#39;: cos^2 type envelope for scalar potential)
  ae_shape1 = &#39;Acos2&#39;

  !peak intensity(W/cm^2) of the incident pulse
  I_wcm2_1 = 1.00d12

  !duration of the incident pulse
  tw1 = 6.00d0

  !mean photon energy(average frequency multiplied by the Planck constant) of the incident pulse
  omega1 = 9.28d0

  !polarization unit vector(real part) for the incident pulse(x,y,z)
  epdir_re1(1:3) = 0.00d0, 0.00d0, 1.00d0
</pre></div>
</div>
<p>The applied electric field shows a rapid oscillation.</p>
<blockquote>
<div><a class="reference internal image-reference" href="_images/exc3a-Efield.png"><img alt="_images/exc3a-Efield.png" src="_images/exc3a-Efield.png" style="width: 403.6px; height: 286.8px;" /></a>
</div></blockquote>
<p>The induced dipole moment also shows a rapid oscillation and does not
decrease even though the electric field decreases. This is because the frequency of the
applied electric field coincides with the excitation energy of the molecule.</p>
<blockquote>
<div><a class="reference internal image-reference" href="_images/exc3a-dipole.png"><img alt="_images/exc3a-dipole.png" src="_images/exc3a-dipole.png" style="width: 412.0px; height: 286.0px;" /></a>
</div></blockquote>
<p>The electronic excitation energy also shows a monotonic increase.
Although the strength of the applied electric field is much smaller than
the previous case, the amount of the excitation energy is larger, again
due to the resonant excitation.</p>
<blockquote>
<div><a class="reference internal image-reference" href="_images/exc3a-Eex.png"><img alt="_images/exc3a-Eex.png" src="_images/exc3a-Eex.png" style="width: 408.0px; height: 280.8px;" /></a>
</div></blockquote>
</div>
</div>
</div>
<div class="section" id="crystalline-silicon-periodic-solids">
<h2>Crystalline silicon (periodic solids)<a class="headerlink" href="#crystalline-silicon-periodic-solids" title="Permalink to this headline">¶</a></h2>
<div class="section" id="exercise-4-ground-state-of-crystalline-silicon">
<span id="exercise-4"></span><h3>Exercise-4: Ground state of crystalline silicon<a class="headerlink" href="#exercise-4-ground-state-of-crystalline-silicon" title="Permalink to this headline">¶</a></h3>
<p>In this exercise, we learn the the ground state calculation of the crystalline silicon that has a diamond structure.
A cubic unit cell that contains eight silicon atoms is adopted in the calculation.</p>
<blockquote>
<div><a class="reference internal image-reference" href="_images/exc4-diamond.png"><img alt="_images/exc4-diamond.png" src="_images/exc4-diamond.png" style="width: 200.0px; height: 172.8px;" /></a>
</div></blockquote>
<p>This exercise will be useful to learn how to set up calculations in SALMON for any periodic systems such as crystalline solid.</p>
<div class="section" id="id8">
<h4>Input files<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h4>
<p>To run the code, following files in the directory <code class="docutils literal notranslate"><span class="pre">SALMON/samples/exercise_04_bulkSi_gs/</span></code> are used:</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>file name</td>
<td>description</td>
</tr>
<tr class="row-even"><td><em>Si_gs.inp</em></td>
<td>input file that contains input
keywords and their values</td>
</tr>
<tr class="row-odd"><td><em>Si_rps.dat</em></td>
<td>pseodupotential file for silicon
atom</td>
</tr>
</tbody>
</table>
<p>In the input file <code class="docutils literal notranslate"><span class="pre">Si_gs.inp</span></code>, input keywords are specified.
Most of them are mandatory to execute the ground state calculation.
This will help you to prepare an input file for other systems that you
want to calculate. A complete list of the input keywords that can be
used in the input file can be found in
<a class="reference internal" href="input_keyword_list.html#list-of-input-keywords"><span class="std std-ref">List of input keywords</span></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>!########################################################################################!
! Excercise 04: Ground state of crystalline silicon(periodic solids)                     !
!----------------------------------------------------------------------------------------!
! * The detail of this excercise is explained in our manual(see chapter: &#39;Exercises&#39;).   !
!   The manual can be obtained from: https://salmon-tddft.jp/documents.html              !
! * Input format consists of group of keywords like:                                     !
!     &amp;group                                                                             !
!       input keyword = xxx                                                              !
!     /                                                                                  !
!   (see chapter: &#39;List of input keywords&#39; in the manual)                                !
!----------------------------------------------------------------------------------------!
! * Conversion from unit_system = &#39;a.u.&#39; to &#39;A_eV_fs&#39;:                                   !
!   Length: 1 [a.u.] = 0.52917721067    [Angstrom]                                       !
!   Energy: 1 [a.u.] = 27.21138505      [eV]                                             !
!   Time  : 1 [a.u.] = 0.02418884326505 [fs]                                             !
!########################################################################################!

&amp;calculation
  !type of theory
  theory = &#39;dft&#39;
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#theory"><span class="std std-ref">theory</span></a> specifies which theoretical method is used in the calculation.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;control
  !common name of output files
  sysname = &#39;Si&#39;
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#sysname"><span class="std std-ref">sysname</span></a> is a prefix for filenames of output files.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;units
  !units used in input and output files
  unit_system = &#39;A_eV_fs&#39;
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#unit-system"><span class="std std-ref">unit_system</span></a> specifies which unit system is used in the input and output files.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;system
  !periodic boundary condition
  yn_periodic = &#39;y&#39;

  !grid box size(x,y,z)
  al(1:3) = 5.43d0, 5.43d0, 5.43d0

  !number of elements, atoms, electrons and states(bands)
  nelem  = 1
  natom  = 8
  nelec  = 32
  nstate = 32
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#yn-periodic"><span class="std std-ref">yn_periodic</span></a> specifies whether or not periodic boundary condition is applied.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#al-3"><span class="std std-ref">al(i)</span></a> specifies the side length of the unit cell.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#nelem"><span class="std std-ref">nelem</span></a> is the number of elements in the system.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#natom"><span class="std std-ref">natom</span></a> is the number of atoms in the system.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#nelec"><span class="std std-ref">nelec</span></a> is the number of electrons in the system.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#nstate"><span class="std std-ref">nstate</span></a> is the number of orbitals that are used in the calculation.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;pseudo
  !name of input pseudo potential file
  file_pseudo(1) = &#39;./Si_rps.dat&#39;

  !atomic number of element
  izatom(1) = 14

  !angular momentum of pseudopotential that will be treated as local
  lloc_ps(1) = 2
  !--- Caution -------------------------------------------!
  ! Index must correspond to those in &amp;atomic_red_coor.   !
  !-------------------------------------------------------!
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#file-pseudo"><span class="std std-ref">file_pseudo(n)</span></a> specifies the filename of the pseudopotential file of the n-th element.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#izatom"><span class="std std-ref">izatom(n)</span></a> is the atomic number of the n-th element.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#lloc-ps"><span class="std std-ref">lloc_ps(n)</span></a> specifies which angular momentum component is chosen as the local potential for the n-th element.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;functional
  !functional(&#39;PZ&#39; is Perdew-Zunger LDA: Phys. Rev. B 23, 5048 (1981).)
  xc = &#39;PZ&#39;
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#xc"><span class="std std-ref">xc</span></a> specifies the exchange-correlation potential to be used in the calculation.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;rgrid
  !number of spatial grids(x,y,z)
  num_rgrid(1:3) = 12, 12, 12
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#num-rgrid-3"><span class="std std-ref">num_rgrid(i)</span></a> specifies the number of real-space grid point in i-th direction.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;kgrid
  !number of k-points(x,y,z)
  num_kgrid(1:3) = 4, 4, 4
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#num-kgrid-3"><span class="std std-ref">num_kgrid(i)</span></a> specifies the number of k-points for i-th direction discretizing the Brillouin zone.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;scf
  !maximum number of scf iteration and threshold of convergence
  nscf      = 300
  threshold = 1.0d-9
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#nscf"><span class="std std-ref">nscf</span></a> specifies the maximum number of SCF iterations.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#threshold"><span class="std std-ref">threshold</span></a> specifies the threshold to judge the convergence.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;atomic_red_coor
  !cartesian atomic reduced coodinates
  &#39;Si&#39;       .0      .0      .0      1
  &#39;Si&#39;       .25     .25     .25     1
  &#39;Si&#39;       .5      .0      .5      1
  &#39;Si&#39;       .0      .5      .5      1
  &#39;Si&#39;       .5      .5      .0      1
  &#39;Si&#39;       .75     .25     .75     1
  &#39;Si&#39;       .25     .75     .75     1
  &#39;Si&#39;       .75     .75     .25     1
  !--- Format ---------------------------------------------------!
  ! &#39;symbol&#39; x y z index(correspond to that of pseudo potential) !
  !--------------------------------------------------------------!
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#atomic-red-coor"><span class="std std-ref">&amp;atomic_red_coor</span></a> specifies spatial coordinates of atoms in reduced coordinate system.</div>
</div>
</div>
<div class="section" id="id9">
<h4>Execusion<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h4>
<p>In a multiprocess environment, calculation will be executed as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ mpiexec -n NPROC salmon &lt; Si_gs.inp &gt; Si_gs.out
</pre></div>
</div>
<p>where NPROC is the number of MPI processes. A standard output will be stored in the file <code class="docutils literal notranslate"><span class="pre">Si_gs.out</span></code>.</p>
</div>
<div class="section" id="output-files-4">
<span id="id10"></span><h4>Output files<a class="headerlink" href="#output-files-4" title="Permalink to this headline">¶</a></h4>
<p>After the calculation, following output files and a directory are created in the
directory that you run the code in addition to the standard output file,</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>name</td>
<td>description</td>
</tr>
<tr class="row-even"><td><em>Si_info.data</em></td>
<td>information on ground state
solution</td>
</tr>
<tr class="row-odd"><td><em>Si_eigen.data</em></td>
<td>energy eigenvalues of orbitals</td>
</tr>
<tr class="row-even"><td><em>Si_k.data</em></td>
<td>k-point distribution</td>
</tr>
<tr class="row-odd"><td><em>PS_Si_KY_n.dat</em></td>
<td>information on pseodupotential
file for silicon atom</td>
</tr>
<tr class="row-even"><td><em>data_for_restart</em></td>
<td>directory where files used in
the real-time calculation are
contained</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line">You may download the above files (zipped file, except for the directory <code class="docutils literal notranslate"><span class="pre">data_for_restart</span></code>) from:</div>
<div class="line"><a class="reference external" href="https://salmon-tddft.jp/webmanual/v_2_0_1/exercise_zip_files/04_bulkSi_gs.zip">https://salmon-tddft.jp/webmanual/v_2_0_1/exercise_zip_files/04_bulkSi_gs.zip</a></div>
</div>
<p>We first explain the standard output file. In the beginning of the file,
input variables used in the calculation are shown.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##############################################################################</span>
<span class="c1"># SALMON: Scalable Ab-initio Light-Matter simulator for Optics and Nanoscience</span>
<span class="c1">#</span>
<span class="c1">#                             Version 2.0.1</span>
<span class="c1">##############################################################################</span>
  <span class="n">Libxc</span><span class="p">:</span> <span class="p">[</span><span class="n">disabled</span><span class="p">]</span>
   <span class="n">theory</span><span class="o">=</span> <span class="n">dft</span>
   <span class="n">use</span> <span class="n">of</span> <span class="n">real</span> <span class="n">value</span> <span class="n">orbitals</span> <span class="o">=</span>  <span class="n">F</span>
 <span class="n">r</span><span class="o">-</span><span class="n">space</span> <span class="n">parallelization</span><span class="p">:</span> <span class="n">off</span>
 <span class="o">======</span>
 <span class="n">MPI</span> <span class="n">distribution</span><span class="p">:</span>
   <span class="n">nproc_k</span>     <span class="p">:</span>          <span class="mi">16</span>
   <span class="n">nproc_ob</span>    <span class="p">:</span>           <span class="mi">1</span>
   <span class="n">nproc_rgrid</span> <span class="p">:</span>           <span class="mi">1</span>           <span class="mi">1</span>           <span class="mi">1</span>
 <span class="n">OpenMP</span> <span class="n">parallelization</span><span class="p">:</span>
   <span class="n">number</span> <span class="n">of</span> <span class="n">threads</span> <span class="p">:</span>          <span class="mi">64</span>
 <span class="o">.........</span>
</pre></div>
</div>
<p>After that, the SCF loop starts. At each iteration step, the total energy as well as orbital
energies and some other quantities are displayed.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-----------------------------------------------</span>
 <span class="nb">iter</span><span class="o">=</span>     <span class="mi">1</span>     <span class="n">Total</span> <span class="n">Energy</span><span class="o">=</span>       <span class="mf">314.78493406</span>     <span class="n">Gap</span><span class="o">=</span>   <span class="o">-</span><span class="mf">95.88543131</span>
 <span class="n">k</span><span class="o">=</span>           <span class="mi">1</span>
     <span class="mi">1</span>        <span class="mf">37.5762</span>      <span class="mi">2</span>        <span class="mf">63.8589</span>      <span class="mi">3</span>        <span class="mf">58.1850</span>      <span class="mi">4</span>        <span class="mf">43.0042</span>
     <span class="mi">5</span>        <span class="mf">61.5347</span>      <span class="mi">6</span>        <span class="mf">29.5604</span>      <span class="mi">7</span>        <span class="mf">41.5986</span>      <span class="mi">8</span>        <span class="mf">39.3545</span>
     <span class="mi">9</span>        <span class="mf">48.5641</span>     <span class="mi">10</span>        <span class="mf">68.0003</span>     <span class="mi">11</span>        <span class="mf">75.5196</span>     <span class="mi">12</span>        <span class="mf">85.4113</span>
 <span class="o">..........</span>
    <span class="mi">21</span>        <span class="mf">94.1224</span>     <span class="mi">22</span>        <span class="mf">53.0821</span>     <span class="mi">23</span>        <span class="mf">72.0170</span>     <span class="mi">24</span>        <span class="mf">46.7797</span>
    <span class="mi">25</span>        <span class="mf">88.6077</span>     <span class="mi">26</span>        <span class="mf">98.2698</span>     <span class="mi">27</span>        <span class="mf">42.8071</span>     <span class="mi">28</span>        <span class="mf">65.0812</span>
    <span class="mi">29</span>        <span class="mf">60.3648</span>     <span class="mi">30</span>        <span class="mf">39.6787</span>     <span class="mi">31</span>        <span class="mf">83.5629</span>     <span class="mi">32</span>        <span class="mf">62.7365</span>

 <span class="nb">iter</span> <span class="ow">and</span> <span class="n">int_x</span><span class="o">|</span><span class="n">rho_i</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="n">rho_i</span><span class="o">-</span><span class="mi">1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">|</span><span class="n">dx</span><span class="o">/</span><span class="n">nelec</span>        <span class="o">=</span>      <span class="mi">1</span> <span class="mf">0.49478519E+00</span>
 <span class="n">Ne</span><span class="o">=</span>   <span class="mf">32.0000000000000</span>
 <span class="o">-----------------------------------------------</span>
 <span class="nb">iter</span><span class="o">=</span>     <span class="mi">2</span>     <span class="n">Total</span> <span class="n">Energy</span><span class="o">=</span>        <span class="mf">62.72724688</span>     <span class="n">Gap</span><span class="o">=</span>   <span class="o">-</span><span class="mf">77.31200657</span>
 <span class="n">k</span><span class="o">=</span>           <span class="mi">1</span>
     <span class="mi">1</span>        <span class="mf">14.4913</span>      <span class="mi">2</span>        <span class="mf">32.6869</span>      <span class="mi">3</span>        <span class="mf">30.3561</span>      <span class="mi">4</span>        <span class="mf">20.6816</span>
     <span class="mi">5</span>        <span class="mf">30.3907</span>      <span class="mi">6</span>        <span class="mf">16.9184</span>      <span class="mi">7</span>        <span class="mf">22.2967</span>      <span class="mi">8</span>        <span class="mf">18.5338</span>
     <span class="mi">9</span>        <span class="mf">29.0117</span>     <span class="mi">10</span>        <span class="mf">41.9687</span>     <span class="mi">11</span>        <span class="mf">42.3490</span>     <span class="mi">12</span>        <span class="mf">54.6262</span>
<span class="o">..........</span>
</pre></div>
</div>
<p>When the convergence criterion is satisfied, the SCF calculation ends.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="nb">iter</span><span class="o">=</span>    <span class="mi">60</span>     <span class="n">Total</span> <span class="n">Energy</span><span class="o">=</span>      <span class="o">-</span><span class="mf">850.76385275</span>     <span class="n">Gap</span><span class="o">=</span>     <span class="mf">1.06020364</span>
 <span class="n">k</span><span class="o">=</span>           <span class="mi">1</span>
     <span class="mi">1</span>        <span class="o">-</span><span class="mf">3.7745</span>      <span class="mi">2</span>        <span class="o">-</span><span class="mf">3.0158</span>      <span class="mi">3</span>        <span class="o">-</span><span class="mf">3.0158</span>      <span class="mi">4</span>        <span class="o">-</span><span class="mf">3.0158</span>
     <span class="mi">5</span>        <span class="o">-</span><span class="mf">0.4300</span>      <span class="mi">6</span>        <span class="o">-</span><span class="mf">0.4300</span>      <span class="mi">7</span>        <span class="o">-</span><span class="mf">0.4300</span>      <span class="mi">8</span>         <span class="mf">0.3765</span>
     <span class="mi">9</span>         <span class="mf">3.9530</span>     <span class="mi">10</span>         <span class="mf">3.9530</span>     <span class="mi">11</span>         <span class="mf">3.9530</span>     <span class="mi">12</span>         <span class="mf">4.6110</span>
<span class="o">..........</span>
    <span class="mi">21</span>         <span class="mf">9.6233</span>     <span class="mi">22</span>         <span class="mf">9.6233</span>     <span class="mi">23</span>         <span class="mf">9.6956</span>     <span class="mi">24</span>         <span class="mf">9.9111</span>
    <span class="mi">25</span>        <span class="mf">11.0259</span>     <span class="mi">26</span>        <span class="mf">11.0259</span>     <span class="mi">27</span>        <span class="mf">11.4165</span>     <span class="mi">28</span>        <span class="mf">11.5976</span>
    <span class="mi">29</span>        <span class="mf">11.9826</span>     <span class="mi">30</span>        <span class="mf">11.9887</span>     <span class="mi">31</span>        <span class="mf">12.0967</span>     <span class="mi">32</span>        <span class="mf">12.3585</span>

 <span class="nb">iter</span> <span class="ow">and</span> <span class="n">int_x</span><span class="o">|</span><span class="n">rho_i</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="n">rho_i</span><span class="o">-</span><span class="mi">1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">|</span><span class="n">dx</span><span class="o">/</span><span class="n">nelec</span>        <span class="o">=</span>     <span class="mi">60</span> <span class="mf">0.77889300E-09</span>
 <span class="n">Ne</span><span class="o">=</span>   <span class="mf">32.0000000000000</span>
  <span class="c1">#GS converged at    61  : 0.77889300E-09</span>
 <span class="o">=====</span> <span class="n">force</span> <span class="o">=====</span>
     <span class="mi">1</span>  <span class="mf">0.60775985E-08</span>  <span class="mf">0.15425240E-07</span> <span class="o">-</span><span class="mf">0.22474791E-07</span>
     <span class="mi">2</span> <span class="o">-</span><span class="mf">0.10689345E-06</span>  <span class="mf">0.88233132E-07</span>  <span class="mf">0.35122981E-09</span>
     <span class="mi">3</span>  <span class="mf">0.39762202E-07</span> <span class="o">-</span><span class="mf">0.23921918E-07</span>  <span class="mf">0.11855231E-07</span>
     <span class="mi">4</span> <span class="o">-</span><span class="mf">0.79441825E-07</span> <span class="o">-</span><span class="mf">0.28978042E-07</span> <span class="o">-</span><span class="mf">0.34109698E-07</span>
     <span class="mi">5</span>  <span class="mf">0.37990526E-07</span>  <span class="mf">0.67211638E-08</span>  <span class="mf">0.20384753E-07</span>
     <span class="mi">6</span>  <span class="mf">0.96418986E-07</span> <span class="o">-</span><span class="mf">0.70404285E-07</span>  <span class="mf">0.10198912E-06</span>
     <span class="mi">7</span>  <span class="mf">0.16145540E-07</span>  <span class="mf">0.30561301E-07</span> <span class="o">-</span><span class="mf">0.63738382E-07</span>
     <span class="mi">8</span>  <span class="mf">0.26042178E-07</span>  <span class="mf">0.30977639E-07</span> <span class="o">-</span><span class="mf">0.40587816E-07</span>
 <span class="n">band</span> <span class="n">information</span><span class="o">-----------------------------------------</span>
 <span class="n">Bottom</span> <span class="n">of</span> <span class="n">VB</span> <span class="o">-</span><span class="mf">0.194818046940532</span>
 <span class="n">Top</span> <span class="n">of</span> <span class="n">VB</span>  <span class="mf">0.216611832367042</span>
 <span class="n">Bottom</span> <span class="n">of</span> <span class="n">CB</span>  <span class="mf">0.255573599266334</span>
 <span class="n">Top</span> <span class="n">of</span> <span class="n">CB</span>  <span class="mf">0.533770712688357</span>
 <span class="n">Fundamental</span> <span class="n">gap</span>  <span class="mf">3.896176689929157E-002</span>
 <span class="n">BG</span> <span class="n">between</span> <span class="n">same</span> <span class="n">k</span><span class="o">-</span><span class="n">point</span>  <span class="mf">3.896176691206812E-002</span>
 <span class="n">Physicaly</span> <span class="n">upper</span> <span class="n">bound</span> <span class="n">of</span> <span class="n">CB</span> <span class="k">for</span> <span class="n">DOS</span>  <span class="mf">0.453918744010958</span>
 <span class="n">Physicaly</span> <span class="n">upper</span> <span class="n">bound</span> <span class="n">of</span> <span class="n">eps</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span>  <span class="mf">0.609598295602846</span>
 <span class="o">---------------------------------------------------------</span>
 <span class="n">Bottom</span> <span class="n">of</span> <span class="n">VB</span><span class="p">[</span><span class="n">eV</span><span class="p">]</span>  <span class="o">-</span><span class="mf">5.30126888998779</span>
 <span class="n">Top</span> <span class="n">of</span> <span class="n">VB</span><span class="p">[</span><span class="n">eV</span><span class="p">]</span>   <span class="mf">5.89430797692564</span>
 <span class="n">Bottom</span> <span class="n">of</span> <span class="n">CB</span><span class="p">[</span><span class="n">eV</span><span class="p">]</span>   <span class="mf">6.95451161825061</span>
 <span class="n">Top</span> <span class="n">of</span> <span class="n">CB</span><span class="p">[</span><span class="n">eV</span><span class="p">]</span>   <span class="mf">14.5246403913758</span>
 <span class="n">Fundamental</span> <span class="n">gap</span><span class="p">[</span><span class="n">eV</span><span class="p">]</span>   <span class="mf">1.06020364132497</span>
 <span class="n">BG</span> <span class="n">between</span> <span class="n">same</span> <span class="n">k</span><span class="o">-</span><span class="n">point</span><span class="p">[</span><span class="n">eV</span><span class="p">]</span>   <span class="mf">1.06020364167264</span>
 <span class="n">Physicaly</span> <span class="n">upper</span> <span class="n">bound</span> <span class="n">of</span> <span class="n">CB</span> <span class="k">for</span> <span class="n">DOS</span><span class="p">[</span><span class="n">eV</span><span class="p">]</span>   <span class="mf">12.3517577246945</span>
 <span class="n">Physicaly</span> <span class="n">upper</span> <span class="n">bound</span> <span class="n">of</span> <span class="n">eps</span><span class="p">(</span><span class="n">omega</span><span class="p">)[</span><span class="n">eV</span><span class="p">]</span>   <span class="mf">16.5880139474728</span>
 <span class="o">---------------------------------------------------------</span>
  <span class="n">writing</span> <span class="n">restart</span> <span class="n">data</span><span class="o">...</span>
  <span class="n">writing</span> <span class="n">completed</span><span class="o">.</span>
</pre></div>
</div>
<p>In the directory <code class="docutils literal notranslate"><span class="pre">data_for_restart</span></code>, files that will be used in the next-step
time evolution calculations are stored.</p>
<p>Other output files include following information.</p>
<p><strong>Si_info.data</strong></p>
<p>Orbital and total energies as well as parameters specified in the input file.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Total</span> <span class="n">number</span> <span class="n">of</span> <span class="n">iteration</span> <span class="o">=</span>           <span class="mi">60</span>

<span class="n">Number</span> <span class="n">of</span> <span class="n">states</span> <span class="o">=</span>           <span class="mi">32</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">electrons</span> <span class="o">=</span>           <span class="mi">32</span>

<span class="n">Total</span> <span class="n">energy</span> <span class="p">(</span><span class="n">eV</span><span class="p">)</span> <span class="o">=</span>   <span class="o">-</span><span class="mf">850.763852754463</span>
<span class="mi">1</span><span class="o">-</span><span class="n">particle</span> <span class="n">energies</span> <span class="p">(</span><span class="n">eV</span><span class="p">)</span>
    <span class="mi">1</span>        <span class="o">-</span><span class="mf">3.7745</span>      <span class="mi">2</span>        <span class="o">-</span><span class="mf">3.0158</span>      <span class="mi">3</span>        <span class="o">-</span><span class="mf">3.0158</span>      <span class="mi">4</span>        <span class="o">-</span><span class="mf">3.0158</span>
    <span class="mi">5</span>        <span class="o">-</span><span class="mf">0.4300</span>      <span class="mi">6</span>        <span class="o">-</span><span class="mf">0.4300</span>      <span class="mi">7</span>        <span class="o">-</span><span class="mf">0.4300</span>      <span class="mi">8</span>         <span class="mf">0.3765</span>
    <span class="mi">9</span>         <span class="mf">3.9530</span>     <span class="mi">10</span>         <span class="mf">3.9530</span>     <span class="mi">11</span>         <span class="mf">3.9530</span>     <span class="mi">12</span>         <span class="mf">4.6110</span>
</pre></div>
</div>
<p><strong>Si_eigen.data</strong></p>
<p>Orbital energies.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#esp: single-particle energies (eigen energies)</span>
<span class="c1">#occ: occupation numbers, io: orbital index</span>
<span class="c1"># 1:io, 2:esp[eV], 3:occ</span>
<span class="n">k</span><span class="o">=</span>     <span class="mi">1</span><span class="p">,</span>  <span class="n">spin</span><span class="o">=</span>     <span class="mi">1</span>
     <span class="mi">1</span>  <span class="o">-</span><span class="mf">0.3774501171245852E+001</span>   <span class="mf">0.2000000000000000E+001</span>
     <span class="mi">2</span>  <span class="o">-</span><span class="mf">0.3015778973884847E+001</span>   <span class="mf">0.2000000000000000E+001</span>
     <span class="mi">3</span>  <span class="o">-</span><span class="mf">0.3015778969794385E+001</span>   <span class="mf">0.2000000000000000E+001</span>
</pre></div>
</div>
<p><strong>Si_k.data</strong></p>
<p>Data of k-points.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># k-point distribution</span>
<span class="c1"># ik: k-point index</span>
<span class="c1"># kx,ky,kz: Reduced coordinate of k-points</span>
<span class="c1"># wk: Weight of k-point</span>
<span class="c1"># 1:ik[none] 2:kx[none] 3:ky[none] 4:kz[none] 5:wk[none]</span>
     <span class="mi">1</span> <span class="o">-</span><span class="mf">0.375000000000000E+000</span> <span class="o">-</span><span class="mf">0.375000000000000E+000</span> <span class="o">-</span><span class="mf">0.375000000000000E+000</span>  <span class="mf">0.156250000000000E-001</span>
     <span class="mi">2</span> <span class="o">-</span><span class="mf">0.125000000000000E+000</span> <span class="o">-</span><span class="mf">0.375000000000000E+000</span> <span class="o">-</span><span class="mf">0.375000000000000E+000</span>  <span class="mf">0.156250000000000E-001</span>
     <span class="mi">3</span>  <span class="mf">0.125000000000000E+000</span> <span class="o">-</span><span class="mf">0.375000000000000E+000</span> <span class="o">-</span><span class="mf">0.375000000000000E+000</span>  <span class="mf">0.156250000000000E-001</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="exercise-5-dielectric-function-of-crystalline-silicon">
<span id="exercise-5"></span><h3>Exercise-5: Dielectric function of crystalline silicon<a class="headerlink" href="#exercise-5-dielectric-function-of-crystalline-silicon" title="Permalink to this headline">¶</a></h3>
<p>In this exercise, we learn the linear response calculation of the crystalline silicon.
A cubic unit cell that contains eight silicon atoms is used in the calculation.
This exercise should be carried out after finishing the ground state calculation
that was explained in <a class="reference internal" href="#exercise-4"><span class="std std-ref">Exercise-4</span></a>.</p>
<p>In this exercise, we calculate a dielectric function of silicon as a final object.
We first summarize definitions of relevant quantities.
We introduce a conductivity in time domain, <span class="math">\(\sigma_{\mu \nu}(t)\)</span>,
where <span class="math">\(\mu, \nu\)</span> indicate Cartesian components, <span class="math">\(\mu, \nu = x,y,z\)</span>.
It relates the applied electric field <span class="math">\(E_{\nu}(t)\)</span> with the induced
current density averaged over the unit cell volume, <span class="math">\(J_{\mu}(t)\)</span>,</p>
<p><span class="math">\(J_{\mu}(t) = \sum_{\nu=x,y,z} \int dt' \sigma_{\mu \nu}(t-t') E_{\nu}(t').\)</span></p>
<p>Integrating the current density over time, we obtain the polarization density as a functioon of time,</p>
<p><span class="math">\(P_{\mu}(t) = \int^t dt' J_{\mu}(t').\)</span></p>
<p>Then, the dielectric function is introduced by</p>
<p><span class="math">\(D_{\mu}(t) = E_{\mu}(t)+4\pi P_{\mu}(t) = \sum_{\nu} \int^t dt' \epsilon_{\mu \nu}(t-t') E_{\nu}(t').\)</span></p>
<p>Frequency-dependent dielectric function <span class="math">\(\epsilon_{\mu \nu}(\omega)\)</span>
is obtained from <span class="math">\(\epsilon_{\mu \nu}(t)\)</span> by taking time-frequency
Fourier transformation.</p>
<p>In SALMON, the dielectric function is calculated in the following way.
First the ground state Bloch orbitals <span class="math">\(u_{n{\bf k}}({\bf r})\)</span> that satisfies the
Kohn-Sham equation,</p>
<p><span class="math">\(H_{\bf k} u_{n{\bf k}}({\bf r}) = \epsilon_{n{\bf k}}({\bf r}),\)</span></p>
<p>is calculated.
Then an impulsive force characterized by the magnitude of the
impulse <span class="math">\(I\)</span> is applied to all electrons in <span class="math">\(z\)</span> direction.
This is equivalent to shift the wave vector by
<span class="math">\({\bf k} \rightarrow {\bf k} + I/\hbar \hat z\)</span>,
where <span class="math">\(\hat z\)</span> is a unit vector in <span class="math">\(z\)</span> direction.
We make a time evolution calculation with the shifted wave vector as</p>
<p><span class="math">\(i\hbar \frac{\partial}{\partial t} u_{n{\bf k}}({\bf r},t)
=
H_{{\bf k} + I/\hbar \hat z}(t) u_{n{\bf k}}({\bf r},t).\)</span></p>
<p>During the time evolution, the electric current density given by</p>
<p><span class="math">\({\bf J}(t) = \frac{-e}{m \Omega} \int d{\bf r}
u_{n{\bf k}}^* \left( -i\hbar\nabla + \hbar {\bf k} + I \hat z \right) u_{n{\bf k}}
+ \delta {\bf J}(t).\)</span></p>
<p>is monitored, where <span class="math">\(\Omega\)</span> is the volume of the unit cell
and <span class="math">\(\delta {\bf J}(t)\)</span> is a current component coming from
nonlocal pseudopootential.</p>
<p>After the time evolution calculation, a time-frequency Fourier
transformation is carried out for the electric current density to obtain the
frequency-dependent conductivity by</p>
<p><span class="math">\(\tilde \sigma_{zz}(\omega) = -\frac{e}{I} \int dt e^{i\omega t} J_z(t).\)</span></p>
<p>The dielectric function and the conductivity is related in frequency representation by</p>
<p><span class="math">\(\epsilon_{\mu \nu}(\omega) = \delta_{\mu \nu} + \frac{4\pi i \sigma_{\mu \nu}(\omega)}{\omega}.\)</span></p>
<p>We note that the dielectric function of a crystalline silicon is isotropic,
<span class="math">\(\epsilon_{\mu \nu} = \delta_{\mu \nu} \epsilon(\omega)\)</span>.</p>
<div class="section" id="input-files-3">
<span id="id11"></span><h4>Input files<a class="headerlink" href="#input-files-3" title="Permalink to this headline">¶</a></h4>
<p>To run the code, following files are necessary:</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>file name</td>
<td>description</td>
</tr>
<tr class="row-even"><td><em>C2H2_response.inp</em></td>
<td>input file that contains input
keywords and their values</td>
</tr>
<tr class="row-odd"><td><em>Si_rps.dat</em></td>
<td>pseodupotential file for silicon
atom</td>
</tr>
<tr class="row-even"><td><em>restart</em></td>
<td><div class="first last line-block">
<div class="line">directory created in the ground
state calculation</div>
<div class="line">(rename the directory from
<em>data_for_restart</em> to <em>restart</em>)</div>
</div>
</td>
</tr>
</tbody>
</table>
<p>First two files are prepared in the directory <code class="docutils literal notranslate"><span class="pre">SALMON/samples/exercise_05_bulkSi_lr/</span></code>.
The file <code class="docutils literal notranslate"><span class="pre">Si_rt_response.inp</span></code> contains input keywords and their values.
The pseudoopotential file should be the same as that used in the ground state calculation.
In the directory <code class="docutils literal notranslate"><span class="pre">restart</span></code>, those files created in the ground state calculation
and stored in the directory <code class="docutils literal notranslate"><span class="pre">data_for_restart</span></code> are included.
Therefore, coopy the directory as <code class="docutils literal notranslate"><span class="pre">cp</span> <span class="pre">-R</span> <span class="pre">data_for_restart</span> <span class="pre">restart</span></code>
if you calculate at the same directory as you did the ground state calculation.</p>
<p>In the input file <code class="docutils literal notranslate"><span class="pre">Si_rt_response.inp</span></code>, input keywords are specified.
Most of them are mandatory to execute the linear response calculation.
This will help you to prepare the input file for other systems that you want to calculate.
A complete list of the input keywords that can be used in the input file
can be found in <a class="reference internal" href="input_keyword_list.html#list-of-input-keywords"><span class="std std-ref">List of input keywords</span></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>!########################################################################################!
! Excercise 05: Dielectric function of crystalline silicon                               !
!----------------------------------------------------------------------------------------!
! * The detail of this excercise is explained in our manual(see chapter: &#39;Exercises&#39;).   !
!   The manual can be obtained from: https://salmon-tddft.jp/documents.html              !
! * Input format consists of group of keywords like:                                     !
!     &amp;group                                                                             !
!       input keyword = xxx                                                              !
!     /                                                                                  !
!   (see chapter: &#39;List of input keywords&#39; in the manual)                                !
!----------------------------------------------------------------------------------------!
! * Conversion from unit_system = &#39;a.u.&#39; to &#39;A_eV_fs&#39;:                                   !
!   Length: 1 [a.u.] = 0.52917721067    [Angstrom]                                       !
!   Energy: 1 [a.u.] = 27.21138505      [eV]                                             !
!   Time  : 1 [a.u.] = 0.02418884326505 [fs]                                             !
!----------------------------------------------------------------------------------------!
! * Copy the ground state data directory(&#39;data_for_restart&#39;) (or make symbolic link)     !
!   calculated in &#39;samples/exercise_04_bulkSi_gs/&#39; and rename the directory to &#39;restart/&#39;!
!   in the current directory.                                                            !
!########################################################################################!

&amp;calculation
  !type of theory
  theory = &#39;tddft_response&#39;
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#theory"><span class="std std-ref">theory</span></a> specifies which theoretical method is used in the calculation.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;control
  !common name of output files
  sysname = &#39;Si&#39;
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#sysname"><span class="std std-ref">sysname</span></a> is a prefix for filenames of output files.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;units
  !units used in input and output files
  unit_system = &#39;A_eV_fs&#39;
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#unit-system"><span class="std std-ref">unit_system</span></a> specifies which unit system is used in the input and output files.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;system
  !periodic boundary condition
  yn_periodic = &#39;y&#39;

  !grid box size(x,y,z)
  al(1:3) = 5.43d0, 5.43d0, 5.43d0

  !number of elements, atoms, electrons and states(bands)
  nelem  = 1
  natom  = 8
  nelec  = 32
  nstate = 32
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#yn-periodic"><span class="std std-ref">yn_periodic</span></a> specifies whether or not periodic boundary condition is applied.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#al-3"><span class="std std-ref">al(i)</span></a> specifies the side length of the unit cell.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#nelem"><span class="std std-ref">nelem</span></a> is the number of elements in the system.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#natom"><span class="std std-ref">natom</span></a> is the number of atoms in the system.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#nelec"><span class="std std-ref">nelec</span></a> is the number of electrons in the system.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#nstate"><span class="std std-ref">nstate</span></a> is the number of orbitals that are used in the calculation.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;pseudo
  !name of input pseudo potential file
  file_pseudo(1) = &#39;./Si_rps.dat&#39;

  !atomic number of element
  izatom(1) = 14

  !angular momentum of pseudopotential that will be treated as local
  lloc_ps(1) = 2
  !--- Caution -------------------------------------------!
  ! Index must correspond to those in &amp;atomic_red_coor.   !
  !-------------------------------------------------------!
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#file-pseudo"><span class="std std-ref">file_pseudo(n)</span></a> specifies the filename of the pseudopotential file of the n-th element.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#izatom"><span class="std std-ref">izatom(n)</span></a> is the atomic number of the n-th element.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#lloc-ps"><span class="std std-ref">lloc_ps(n)</span></a> specifies which angular momentum component is chosen as the local potential for the n-th element.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;functional
  !functional(&#39;PZ&#39; is Perdew-Zunger LDA: Phys. Rev. B 23, 5048 (1981).)
  xc = &#39;PZ&#39;
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#xc"><span class="std std-ref">xc</span></a> specifies the exchange-correlation potential to be used in the calculation.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;rgrid
  !number of spatial grids(x,y,z)
  num_rgrid(1:3) = 12, 12, 12
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#num-rgrid-3"><span class="std std-ref">num_rgrid(i)</span></a> specifies the number of real-space grid point in i-th direction.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;kgrid
  !number of k-points(x,y,z)
  num_kgrid(1:3) = 4, 4, 4
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#num-kgrid-3"><span class="std std-ref">num_kgrid(i)</span></a> specifies the number of k-points for i-th direction discretizing the Brillouin zone.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;tgrid
  !time step size and number of time grids(steps)
  dt = 0.002d0
  nt = 6000
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#dt"><span class="std std-ref">dt</span></a> specifies the time step.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#nt"><span class="std std-ref">nt</span></a> is the number of time steps for the time propagation.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;emfield
  !envelope shape of the incident pulse(&#39;impulse&#39;: impulsive field)
  ae_shape1 = &#39;impulse&#39;

  !polarization unit vector(real part) for the incident pulse(x,y,z)
  epdir_re1(1:3) = 0.00d0, 0.00d0, 1.00d0
  !--- Caution ---------------------------------------------------------!
  ! Definition of the incident pulse is written in:                     !
  ! https://www.sciencedirect.com/science/article/pii/S0010465518303412 !
  !---------------------------------------------------------------------!
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#ae-shape1"><span class="std std-ref">ae_shape1</span></a> specifies the envelope of the field. For a linear response calculation, <code class="docutils literal notranslate"><span class="pre">as_shape1='impulse'</span></code> is used. It indicates that a weak impulsive perturbation is applied at <span class="math">\(t=0\)</span>.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#epdir-re1-3"><span class="std std-ref">epdir_re1(i)</span></a> specifies the i-th component of the real part of the polarization unit vector.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;analysis
  !energy grid size and number of energy grids for output files
  de      = 0.01d0
  nenergy = 2000
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#de"><span class="std std-ref">de</span></a> specifies the energy grid size for frequency-domain analysis.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#nenergy"><span class="std std-ref">nenergy</span></a> specifies the number of energy grid points for frequency-domain analysis.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;atomic_red_coor
  !cartesian atomic reduced coodinates
  &#39;Si&#39;       .0      .0      .0      1
  &#39;Si&#39;       .25     .25     .25     1
  &#39;Si&#39;       .5      .0      .5      1
  &#39;Si&#39;       .0      .5      .5      1
  &#39;Si&#39;       .5      .5      .0      1
  &#39;Si&#39;       .75     .25     .75     1
  &#39;Si&#39;       .25     .75     .75     1
  &#39;Si&#39;       .75     .75     .25     1
  !--- Format ---------------------------------------------------!
  ! &#39;symbol&#39; x y z index(correspond to that of pseudo potential) !
  !--------------------------------------------------------------!
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#atomic-red-coor"><span class="std std-ref">&amp;atomic_red_coor</span></a> specifies spatial coordinates of atoms in reduced coordinate system.</div>
</div>
</div>
<div class="section" id="id12">
<h4>Execusion<a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h4>
<p>In a multiprocess environment, calculation will be executed as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ mpiexec -n NPROC salmon &lt; Si_rt_response.inp &gt; Si_rt_response.out
</pre></div>
</div>
<p>where NPROC is the number of MPI processes. A standard output will be stored in the file <code class="docutils literal notranslate"><span class="pre">Si_rt_response.out</span></code>.</p>
</div>
<div class="section" id="output-files-5">
<span id="id13"></span><h4>Output files<a class="headerlink" href="#output-files-5" title="Permalink to this headline">¶</a></h4>
<p>After the calculation, following output files are created in the directory that
you run the code in addition to the standard output file,</p>
<table border="1" class="docutils">
<colgroup>
<col width="45%" />
<col width="55%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>file name</td>
<td>description</td>
</tr>
<tr class="row-even"><td><em>Si_response.data</em></td>
<td>conductivity and dielectric function
as functions of energy</td>
</tr>
<tr class="row-odd"><td><em>Si_rt.data</em></td>
<td>vector potential, electric field,
and matter current as functions of time</td>
</tr>
<tr class="row-even"><td><em>Si_rt_energy</em></td>
<td>total energy and electronic excitation
energy as functions of time</td>
</tr>
<tr class="row-odd"><td><em>PS_Si_KY_n.dat</em></td>
<td>information on pseodupotential
file for silicon atom</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line">You may download the above files (zipped file) from:</div>
<div class="line"><a class="reference external" href="https://salmon-tddft.jp/webmanual/v_2_0_1/exercise_zip_files/05_bulkSi_lr.zip">https://salmon-tddft.jp/webmanual/v_2_0_1/exercise_zip_files/05_bulkSi_lr.zip</a></div>
</div>
<p>We first explain the standard output file. In the beginning of the file,
input variables used in the calculation are shown.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##############################################################################</span>
<span class="c1"># SALMON: Scalable Ab-initio Light-Matter simulator for Optics and Nanoscience</span>
<span class="c1">#</span>
<span class="c1">#                             Version 2.0.1</span>
<span class="c1">##############################################################################</span>
  <span class="n">Libxc</span><span class="p">:</span> <span class="p">[</span><span class="n">disabled</span><span class="p">]</span>
   <span class="n">theory</span><span class="o">=</span> <span class="n">tddft_response</span>

 <span class="n">Total</span> <span class="n">time</span> <span class="n">step</span>      <span class="o">=</span>        <span class="mi">6000</span>
 <span class="n">Time</span> <span class="n">step</span><span class="p">[</span><span class="n">fs</span><span class="p">]</span>        <span class="o">=</span>  <span class="mf">2.000000000000000E-003</span>
 <span class="n">Energy</span> <span class="nb">range</span>         <span class="o">=</span>        <span class="mi">2000</span>
 <span class="n">Energy</span> <span class="n">resolution</span><span class="p">[</span><span class="n">eV</span><span class="p">]</span><span class="o">=</span>  <span class="mf">1.000000000000000E-002</span>
 <span class="n">Field</span> <span class="n">strength</span><span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">u</span><span class="o">.</span><span class="p">]</span> <span class="o">=</span>  <span class="mf">1.000000000000000E-002</span>
   <span class="n">use</span> <span class="n">of</span> <span class="n">real</span> <span class="n">value</span> <span class="n">orbitals</span> <span class="o">=</span>  <span class="n">F</span>
 <span class="n">r</span><span class="o">-</span><span class="n">space</span> <span class="n">parallelization</span><span class="p">:</span> <span class="n">off</span>
 <span class="o">======</span>
 <span class="o">........</span>
</pre></div>
</div>
<p>After that, the time evolution loop starts. At every 10 iteration steps,
electric current density in three Cartesian direction, the total number
of electrons, and total energy are displayed.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="n">time</span><span class="o">-</span><span class="n">step</span>  <span class="n">time</span><span class="p">[</span><span class="n">fs</span><span class="p">]</span>                               <span class="n">Current</span><span class="p">(</span><span class="n">xyz</span><span class="p">)[</span><span class="n">a</span><span class="o">.</span><span class="n">u</span><span class="o">.</span><span class="p">]</span>      <span class="n">electrons</span> <span class="n">Total</span> <span class="n">energy</span><span class="p">[</span><span class="n">eV</span><span class="p">]</span>
<span class="c1">#----------------------------------------------------------------------</span>
      <span class="mi">10</span>    <span class="mf">0.02000000</span>  <span class="mf">0.11911770E-11</span> <span class="o">-</span><span class="mf">0.40018285E-13</span>  <span class="mf">0.24902126E-03</span>    <span class="mf">32.00000000</span>     <span class="o">-</span><span class="mf">850.72273308</span>
      <span class="mi">20</span>    <span class="mf">0.04000000</span>  <span class="mf">0.17745321E-11</span>  <span class="mf">0.13712105E-12</span>  <span class="mf">0.21977876E-03</span>    <span class="mf">31.99999999</span>     <span class="o">-</span><span class="mf">850.72273319</span>
      <span class="mi">30</span>    <span class="mf">0.06000000</span>  <span class="mf">0.31016197E-11</span>  <span class="mf">0.24481043E-12</span>  <span class="mf">0.20049151E-03</span>    <span class="mf">31.99999999</span>     <span class="o">-</span><span class="mf">850.72272966</span>
      <span class="mi">40</span>    <span class="mf">0.08000000</span>  <span class="mf">0.36611565E-11</span>  <span class="mf">0.49184860E-12</span>  <span class="mf">0.17937042E-03</span>    <span class="mf">31.99999999</span>     <span class="o">-</span><span class="mf">850.72272925</span>
      <span class="mi">50</span>    <span class="mf">0.10000000</span>  <span class="mf">0.36920991E-11</span>  <span class="mf">0.63805259E-12</span>  <span class="mf">0.15246564E-03</span>    <span class="mf">31.99999998</span>     <span class="o">-</span><span class="mf">850.72272922</span>
      <span class="mi">60</span>    <span class="mf">0.12000000</span>  <span class="mf">0.32347636E-11</span>  <span class="mf">0.11280947E-11</span>  <span class="mf">0.12248647E-03</span>    <span class="mf">31.99999998</span>     <span class="o">-</span><span class="mf">850.72272655</span>
      <span class="mi">70</span>    <span class="mf">0.14000000</span>  <span class="mf">0.25978450E-11</span>  <span class="mf">0.15550074E-11</span>  <span class="mf">0.91933957E-04</span>    <span class="mf">31.99999998</span>     <span class="o">-</span><span class="mf">850.72272293</span>
      <span class="mi">80</span>    <span class="mf">0.16000000</span>  <span class="mf">0.20087959E-11</span>  <span class="mf">0.17983589E-11</span>  <span class="mf">0.62968342E-04</span>    <span class="mf">31.99999997</span>     <span class="o">-</span><span class="mf">850.72272036</span>
      <span class="mi">90</span>    <span class="mf">0.18000000</span>  <span class="mf">0.90623268E-12</span>  <span class="mf">0.18067974E-11</span>  <span class="mf">0.38824129E-04</span>    <span class="mf">31.99999997</span>     <span class="o">-</span><span class="mf">850.72271918</span>
</pre></div>
</div>
<p>Explanations of other output files are given below:</p>
<p><strong>Si_rt.data</strong></p>
<p>Results of time evolution calculation for vector potential, electric field, and matter current density are shown. In the first several lines, explanations of included data are given.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Real time calculation:</span>
<span class="c1"># Ac_ext: External vector potential field</span>
<span class="c1"># E_ext: External electric field</span>
<span class="c1"># Ac_tot: Total vector potential field</span>
<span class="c1"># E_tot: Total electric field</span>
<span class="c1"># Jm: Matter current density (electrons)</span>
<span class="c1"># 1:Time[fs] 2:Ac_ext_x[fs*V/Angstrom] 3:Ac_ext_y[fs*V/Angstrom] 4:Ac_ext_z[fs*V/Angstrom]</span>
<span class="c1"># 5:E_ext_x[V/Angstrom] 6:E_ext_y[V/Angstrom] 7:E_ext_z[V/Angstrom] 8:Ac_tot_x[fs*V/Angstrom]</span>
<span class="c1"># 9:Ac_tot_y[fs*V/Angstrom] 10:Ac_tot_z[fs*V/Angstrom] 11:E_tot_x[V/Angstrom]</span>
<span class="c1"># 12:E_tot_y[V/Angstrom] 13:E_tot_z[V/Angstrom]  14:Jm_x[1/fs*Angstrom^2]</span>
<span class="c1"># 15:Jm_y[1/fs*Angstrom^2] 16:Jm_z[1/fs*Angstrom^2]</span>
</pre></div>
</div>
<p>Using first column (time in femtosecond) and 16th column (matter current density in
<em>z</em> direction), the following graph can be drawn.</p>
<blockquote>
<div><a class="reference internal image-reference" href="_images/exc5-current.png"><img alt="_images/exc5-current.png" src="_images/exc5-current.png" style="width: 384.0px; height: 288.0px;" /></a>
</div></blockquote>
<p><strong>Si_response.data</strong></p>
<p>Time-frequency Fourier transformation of the macroscopic current density gives
the conductivity of the system. The dielectric function is then calculated
from the conductivity. They are stored in this file.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fourier-transform spectra:</span>
<span class="c1"># sigma: Conductivity</span>
<span class="c1"># eps: Dielectric constant</span>
<span class="c1"># 1:Energy[eV] 2:Re(sigma_x)[1/fs*V*Angstrom] 3:Re(sigma_y)[1/fs*V*Angstrom]</span>
<span class="c1"># 4:Re(sigma_z)[1/fs*V*Angstrom] 5:Im(sigma_x)[1/fs*V*Angstrom]</span>
<span class="c1"># 6:Im(sigma_y)[1/fs*V*Angstrom] 7:Im(sigma_z)[1/fs*V*Angstrom] 8:Re(eps_x)[none]</span>
<span class="c1"># 9:Re(eps_y)[none] 10:Re(eps_z)[none] 11:Im(eps_x)[none] 12:Im(eps_y)[none]</span>
<span class="c1"># 13:Im(eps_z)[none]</span>
</pre></div>
</div>
<p>Using first column (energy in eV) and 10th (real part of the dielectric function)
and 13th (imaginary part), we obtain the following graph.</p>
<blockquote>
<div><a class="reference internal image-reference" href="_images/exc5-eps-re.png"><img alt="_images/exc5-eps-re.png" src="_images/exc5-eps-re.png" style="width: 320.0px; height: 240.0px;" /></a>
<a class="reference internal image-reference" href="_images/exc5-eps-im.png"><img alt="_images/exc5-eps-im.png" src="_images/exc5-eps-im.png" style="width: 320.0px; height: 240.0px;" /></a>
</div></blockquote>
<p>The imaginary part appears above the direct bandgap energy that is about
2.4 eV in the present calculation using local density approximation.
Dielectric function below 1 eV are not accurate and and are not shown.</p>
<p><strong>Si_rt_energy</strong></p>
<p><em>Eall</em> and <em>Eall-Eall0</em> are total energy and electronic excitation energy, respectively.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Real time calculation:</span>
<span class="c1"># Eall: Total energy</span>
<span class="c1"># Eall0: Initial energy</span>
<span class="c1"># 1:Time[fs] 2:Eall[eV] 3:Eall-Eall0[eV]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="exercise-6-electron-dynamics-in-crystalline-silicon-under-a-pulsed-electric-field">
<span id="exercise-6"></span><h3>Exercise-6: Electron dynamics in crystalline silicon under a pulsed electric field<a class="headerlink" href="#exercise-6-electron-dynamics-in-crystalline-silicon-under-a-pulsed-electric-field" title="Permalink to this headline">¶</a></h3>
<p>In this exercise, we learn the calculation of electron dynamics in crystalline silicon.
A cubic unit cell that contains eight silicon atoms is used in the calculation.
This exercise should be carried out after finishing the ground state calculation
that was explained in <a class="reference internal" href="#exercise-4"><span class="std std-ref">Exercise-4</span></a>.</p>
<p>In the calculation, a pulsed electric field specified by the following vector
potential will be used,</p>
<p><span class="math">\(A(t) = - \frac{E_0}{\omega} \hat z \cos^2 \frac{\pi}{T} \left( t - \frac{T}{2} \right) \sin \omega \left( t - \frac{T}{2} \right), \hspace{5mm} (0 &lt; t &lt; T).\)</span></p>
<p>The electric field is given by <span class="math">\(E(t) = -(1/c)(dA(t)/dt)\)</span>.
The parameters that characterize the pulsed field such as the amplitude <span class="math">\(E_0\)</span>,
frequency <span class="math">\(\omega\)</span>, pulse duration <span class="math">\(T\)</span>, polarization direction <span class="math">\(\hat z\)</span>,
are specified in the input file.
Time-dependent Kohn-Sham equation for Bloch orbitals are calculated in real time,</p>
<p><span class="math">\(i\hbar \frac{\partial}{\partial t} u_{n{\bf k}}({\bf r},t)
=
H_{{\bf k} + (e/\hbar c){\bf A}(t)} u_{n{\bf k}}({\bf r},t).\)</span></p>
<div class="section" id="input-files-4">
<span id="id14"></span><h4>Input files<a class="headerlink" href="#input-files-4" title="Permalink to this headline">¶</a></h4>
<p>To run the code, following files in samples are necessary:</p>
<table border="1" class="docutils">
<colgroup>
<col width="49%" />
<col width="51%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>file name</td>
<td>description</td>
</tr>
<tr class="row-even"><td><em>Si_rt_pulse.inp</em></td>
<td>input file that contain input
keywords and their values</td>
</tr>
<tr class="row-odd"><td><em>Si_rps.dat</em></td>
<td>pseodupotential file for Carbon</td>
</tr>
<tr class="row-even"><td><em>restart</em></td>
<td><div class="first last line-block">
<div class="line">directory created in the ground
state calculation</div>
<div class="line">(rename the directory from
<em>data_for_restart</em> to <em>restart</em>)</div>
</div>
</td>
</tr>
</tbody>
</table>
<p>First two files are prepared in the directory <code class="docutils literal notranslate"><span class="pre">SALMON/samples/exercise_06_bulkSi_rt/</span></code>.
The file <code class="docutils literal notranslate"><span class="pre">Si_rt_pulse.inp</span></code> contains input keywords and their values.
The pseudoopotential file should be the same as that used in the ground state calculation.
In the directory <code class="docutils literal notranslate"><span class="pre">restart</span></code>, those files created in the ground state calculation
and stored in the directory <code class="docutils literal notranslate"><span class="pre">data_for_restart</span></code> are included.
Therefore, coopy the directory as <code class="docutils literal notranslate"><span class="pre">cp</span> <span class="pre">-R</span> <span class="pre">data_for_restart</span> <span class="pre">restart</span></code>
if you calculate at the same directory as you did the ground state calculation.</p>
<p>In the input file <code class="docutils literal notranslate"><span class="pre">Si_rt_pulse.inp</span></code>, input keywords are specified.
Most of them are mandatory to execute the electron dynamics calculation.
This will help you to prepare the input file for other systems that you want to calculate.
A complete list of the input keywords that can be used in the input file
can be found in <a class="reference internal" href="input_keyword_list.html#list-of-input-keywords"><span class="std std-ref">List of input keywords</span></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>!########################################################################################!
! Excercise 06: Electron dynamics in crystalline silicon under a pulsed electric field   !
!----------------------------------------------------------------------------------------!
! * The detail of this excercise is explained in our manual(see chapter: &#39;Exercises&#39;).   !
!   The manual can be obtained from: https://salmon-tddft.jp/documents.html              !
! * Input format consists of group of keywords like:                                     !
!     &amp;group                                                                             !
!       input keyword = xxx                                                              !
!     /                                                                                  !
!   (see chapter: &#39;List of input keywords&#39; in the manual)                                !
!----------------------------------------------------------------------------------------!
! * Conversion from unit_system = &#39;a.u.&#39; to &#39;A_eV_fs&#39;:                                   !
!   Length: 1 [a.u.] = 0.52917721067    [Angstrom]                                       !
!   Energy: 1 [a.u.] = 27.21138505      [eV]                                             !
!   Time  : 1 [a.u.] = 0.02418884326505 [fs]                                             !
!----------------------------------------------------------------------------------------!
! * Copy the ground state data directory(&#39;data_for_restart&#39;) (or make symbolic link)     !
!   calculated in &#39;samples/exercise_04_bulkSi_gs/&#39; and rename the directory to &#39;restart/&#39;!
!   in the current directory.                                                            !
!########################################################################################!

&amp;calculation
  !type of theory
  theory = &#39;tddft_pulse&#39;
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#theory"><span class="std std-ref">theory</span></a> specifies which theoretical method is used in the calculation.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;control
  !common name of output files
  sysname = &#39;Si&#39;
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#sysname"><span class="std std-ref">sysname</span></a> is a prefix for filenames of output files.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;units
  !units used in input and output files
  unit_system = &#39;A_eV_fs&#39;
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#unit-system"><span class="std std-ref">unit_system</span></a> specifies which unit system is used in the input and output files.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;system
  !periodic boundary condition
  yn_periodic = &#39;y&#39;

  !grid box size(x,y,z)
  al(1:3) = 5.43d0, 5.43d0, 5.43d0

  !number of elements, atoms, electrons and states(bands)
  nelem  = 1
  natom  = 8
  nelec  = 32
  nstate = 32
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#yn-periodic"><span class="std std-ref">yn_periodic</span></a> specifies whether or not periodic boundary condition is applied.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#al-3"><span class="std std-ref">al(i)</span></a> specifies the side length of the unit cell.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#nelem"><span class="std std-ref">nelem</span></a> is the number of elements in the system.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#natom"><span class="std std-ref">natom</span></a> is the number of atoms in the system.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#nelec"><span class="std std-ref">nelec</span></a> is the number of electrons in the system.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#nstate"><span class="std std-ref">nstate</span></a> is the number of orbitals that are used in the calculation.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;pseudo
  !name of input pseudo potential file
  file_pseudo(1) = &#39;./Si_rps.dat&#39;

  !atomic number of element
  izatom(1) = 14

  !angular momentum of pseudopotential that will be treated as local
  lloc_ps(1) = 2
  !--- Caution -------------------------------------------!
  ! Index must correspond to those in &amp;atomic_red_coor.   !
  !-------------------------------------------------------!
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#file-pseudo"><span class="std std-ref">file_pseudo(n)</span></a> specifies the filename of the pseudopotential file of the n-th element.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#izatom"><span class="std std-ref">izatom(n)</span></a> is the atomic number of the n-th element.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#lloc-ps"><span class="std std-ref">lloc_ps(n)</span></a> specifies which angular momentum component is chosen as the local potential for the n-th element.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;functional
  !functional(&#39;PZ&#39; is Perdew-Zunger LDA: Phys. Rev. B 23, 5048 (1981).)
  xc = &#39;PZ&#39;
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#xc"><span class="std std-ref">xc</span></a> specifies the exchange-correlation potential to be used in the calculation.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;rgrid
  !number of spatial grids(x,y,z)
  num_rgrid(1:3) = 12, 12, 12
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#num-rgrid-3"><span class="std std-ref">num_rgrid(i)</span></a> specifies the number of real-space grid point in i-th direction.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;kgrid
  !number of k-points(x,y,z)
  num_kgrid(1:3) = 4, 4, 4
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#num-kgrid-3"><span class="std std-ref">num_kgrid(i)</span></a> specifies the number of k-points for i-th direction discretizing the Brillouin zone.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;tgrid
  !time step size and number of time grids(steps)
  dt = 0.002d0
  nt = 6000
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#dt"><span class="std std-ref">dt</span></a> specifies the time step.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#nt"><span class="std std-ref">nt</span></a> is the number of time steps for the time propagation.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;emfield
  !envelope shape of the incident pulse(&#39;Acos2&#39;: cos^2 type envelope for vector potential)
  ae_shape1 = &#39;Acos2&#39;

  !peak intensity(W/cm^2) of the incident pulse
  I_wcm2_1 = 1.0d12

  !duration of the incident pulse
  tw1 = 10.672d0

  !mean photon energy(average frequency multiplied by the Planck constant) of the incident pulse
  omega1 = 1.55d0

  !polarization unit vector(real part) for the incident pulse(x,y,z)
  epdir_re1(1:3) = 0.0d0, 0.0d0, 1.0d0
  !--- Caution ---------------------------------------------------------!
  ! Definition of the incident pulse is written in:                     !
  ! https://www.sciencedirect.com/science/article/pii/S0010465518303412 !
  !---------------------------------------------------------------------!
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#ae-shape1"><span class="std std-ref">ae_shape1</span></a> specifies the envelope of the field.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#i-wcm2-1"><span class="std std-ref">I_wcm2_1</span></a> specify the intensity of the pulse in unit of W/cm<sup>2</sup>.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#tw1"><span class="std std-ref">tw1</span></a> specifies the duration of the pulse.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#omega1"><span class="std std-ref">omega1</span></a> specifies the mean photon energy of the pulse.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#epdir-re1-3"><span class="std std-ref">epdir_re1(i)</span></a> specifies the i-th component of the real part of the polarization unit vector.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;analysis
  !energy grid size and number of energy grids for output files
  de      = 0.01d0
  nenergy = 3000
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#de"><span class="std std-ref">de</span></a> specifies the energy grid size for frequency-domain analysis.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#nenergy"><span class="std std-ref">nenergy</span></a> specifies the number of energy grid points for frequency-domain analysis.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;atomic_red_coor
  !cartesian atomic reduced coodinates
  &#39;Si&#39;       .0      .0      .0      1
  &#39;Si&#39;       .25     .25     .25     1
  &#39;Si&#39;       .5      .0      .5      1
  &#39;Si&#39;       .0      .5      .5      1
  &#39;Si&#39;       .5      .5      .0      1
  &#39;Si&#39;       .75     .25     .75     1
  &#39;Si&#39;       .25     .75     .75     1
  &#39;Si&#39;       .75     .75     .25     1
  !--- Format ---------------------------------------------------!
  ! &#39;symbol&#39; x y z index(correspond to that of pseudo potential) !
  !--------------------------------------------------------------!
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#atomic-red-coor"><span class="std std-ref">&amp;atomic_red_coor</span></a> specifies spatial coordinates of atoms in reduced coordinate system.</div>
</div>
</div>
<div class="section" id="id15">
<h4>Execusion<a class="headerlink" href="#id15" title="Permalink to this headline">¶</a></h4>
<p>In a multiprocess environment, calculation will be executed as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ mpiexec -n NPROC salmon &lt; Si_rt_pulse.inp &gt; Si_rt_pulse.out
</pre></div>
</div>
<p>where NPROC is the number of MPI processes. A standard output will be stored in the file <code class="docutils literal notranslate"><span class="pre">Si_rt_pulse.out</span></code>.</p>
</div>
<div class="section" id="output-files-6">
<span id="id16"></span><h4>Output files<a class="headerlink" href="#output-files-6" title="Permalink to this headline">¶</a></h4>
<p>After the calculation, following output files are created in the
directory that you run the code in addition to the standard output file,</p>
<table border="1" class="docutils">
<colgroup>
<col width="45%" />
<col width="55%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>file name</td>
<td>description</td>
</tr>
<tr class="row-even"><td><em>Si_pulse.data</em></td>
<td>time-frequency Fourier transform of
matter current and electric field</td>
</tr>
<tr class="row-odd"><td><em>Si_rt.data</em></td>
<td>vector potential, electric field,
and matter current as functions of time</td>
</tr>
<tr class="row-even"><td><em>Si_rt_energy</em></td>
<td>total energy and electronic excitation
energy as functions of time</td>
</tr>
<tr class="row-odd"><td><em>PS_Si_KY_n.dat</em></td>
<td>information on pseodupotential
file for silicon atom</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line">You may download the above files (zipped file) from:</div>
<div class="line"><a class="reference external" href="https://salmon-tddft.jp/webmanual/v_2_0_1/exercise_zip_files/06_bulkSi_rt.zip">https://salmon-tddft.jp/webmanual/v_2_0_1/exercise_zip_files/06_bulkSi_rt.zip</a></div>
</div>
<p>We first explain the standard output file. In the beginning of the file,
input variables used in the calculation are shown.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##############################################################################</span>
<span class="c1"># SALMON: Scalable Ab-initio Light-Matter simulator for Optics and Nanoscience</span>
<span class="c1">#</span>
<span class="c1">#                             Version 2.0.1</span>
<span class="c1">##############################################################################</span>
  <span class="n">Libxc</span><span class="p">:</span> <span class="p">[</span><span class="n">disabled</span><span class="p">]</span>
   <span class="n">theory</span><span class="o">=</span> <span class="n">tddft_pulse</span>

 <span class="n">Total</span> <span class="n">time</span> <span class="n">step</span>      <span class="o">=</span>        <span class="mi">6000</span>
 <span class="n">Time</span> <span class="n">step</span><span class="p">[</span><span class="n">fs</span><span class="p">]</span>        <span class="o">=</span>  <span class="mf">2.000000000000000E-003</span>
 <span class="n">Energy</span> <span class="nb">range</span>         <span class="o">=</span>        <span class="mi">3000</span>
 <span class="n">Energy</span> <span class="n">resolution</span><span class="p">[</span><span class="n">eV</span><span class="p">]</span><span class="o">=</span>  <span class="mf">1.000000000000000E-002</span>
<span class="n">Laser</span> <span class="n">frequency</span>     <span class="o">=</span> <span class="mf">1.55</span><span class="p">[</span><span class="n">eV</span><span class="p">]</span>
<span class="n">Pulse</span> <span class="n">width</span> <span class="n">of</span> <span class="n">laser</span><span class="o">=</span>     <span class="mf">10.67200000</span><span class="p">[</span><span class="n">fs</span><span class="p">]</span>
<span class="n">Laser</span> <span class="n">intensity</span>     <span class="o">=</span>  <span class="mf">0.10000000E+13</span><span class="p">[</span><span class="n">W</span><span class="o">/</span><span class="n">cm</span><span class="o">^</span><span class="mi">2</span><span class="p">]</span>
   <span class="n">use</span> <span class="n">of</span> <span class="n">real</span> <span class="n">value</span> <span class="n">orbitals</span> <span class="o">=</span>  <span class="n">F</span>
 <span class="n">r</span><span class="o">-</span><span class="n">space</span> <span class="n">parallelization</span><span class="p">:</span> <span class="n">off</span>
 <span class="o">======</span>
 <span class="o">........</span>
</pre></div>
</div>
<p>After that, the time evolution loop starts. At every 10 iterations, the time,
current in three Cartesian directions, the number of electrons, and the
total energy are displayed.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="n">time</span><span class="o">-</span><span class="n">step</span>  <span class="n">time</span><span class="p">[</span><span class="n">fs</span><span class="p">]</span>                               <span class="n">Current</span><span class="p">(</span><span class="n">xyz</span><span class="p">)[</span><span class="n">a</span><span class="o">.</span><span class="n">u</span><span class="o">.</span><span class="p">]</span>      <span class="n">electrons</span> <span class="n">Total</span> <span class="n">energy</span><span class="p">[</span><span class="n">eV</span><span class="p">]</span>
<span class="c1">#----------------------------------------------------------------------</span>
      <span class="mi">10</span>    <span class="mf">0.02000000</span>  <span class="mf">0.11847131E-11</span> <span class="o">-</span><span class="mf">0.47534543E-13</span> <span class="o">-</span><span class="mf">0.43120486E-08</span>    <span class="mf">32.00000000</span>     <span class="o">-</span><span class="mf">850.76385276</span>
      <span class="mi">20</span>    <span class="mf">0.04000000</span>  <span class="mf">0.17733186E-11</span>  <span class="mf">0.12820952E-12</span> <span class="o">-</span><span class="mf">0.33012195E-07</span>    <span class="mf">32.00000000</span>     <span class="o">-</span><span class="mf">850.76385276</span>
      <span class="mi">30</span>    <span class="mf">0.06000000</span>  <span class="mf">0.30965601E-11</span>  <span class="mf">0.23626542E-12</span> <span class="o">-</span><span class="mf">0.10736819E-06</span>    <span class="mf">32.00000000</span>     <span class="o">-</span><span class="mf">850.76385275</span>
      <span class="mi">40</span>    <span class="mf">0.08000000</span>  <span class="mf">0.36612711E-11</span>  <span class="mf">0.47687574E-12</span> <span class="o">-</span><span class="mf">0.24607217E-06</span>    <span class="mf">32.00000000</span>     <span class="o">-</span><span class="mf">850.76385272</span>
      <span class="mi">50</span>    <span class="mf">0.10000000</span>  <span class="mf">0.36958981E-11</span>  <span class="mf">0.62315158E-12</span> <span class="o">-</span><span class="mf">0.46548014E-06</span>    <span class="mf">32.00000000</span>     <span class="o">-</span><span class="mf">850.76385263</span>
      <span class="mi">60</span>    <span class="mf">0.12000000</span>  <span class="mf">0.32186097E-11</span>  <span class="mf">0.11429104E-11</span> <span class="o">-</span><span class="mf">0.77911390E-06</span>    <span class="mf">32.00000000</span>     <span class="o">-</span><span class="mf">850.76385239</span>
      <span class="mi">70</span>    <span class="mf">0.14000000</span>  <span class="mf">0.25712602E-11</span>  <span class="mf">0.15689467E-11</span> <span class="o">-</span><span class="mf">0.11971541E-05</span>    <span class="mf">32.00000000</span>     <span class="o">-</span><span class="mf">850.76385186</span>
      <span class="mi">80</span>    <span class="mf">0.16000000</span>  <span class="mf">0.19447699E-11</span>  <span class="mf">0.18250920E-11</span> <span class="o">-</span><span class="mf">0.17261976E-05</span>    <span class="mf">32.00000000</span>     <span class="o">-</span><span class="mf">850.76385082</span>
      <span class="mi">90</span>    <span class="mf">0.18000000</span>  <span class="mf">0.80514520E-12</span>  <span class="mf">0.18683828E-11</span> <span class="o">-</span><span class="mf">0.23692381E-05</span>    <span class="mf">32.00000000</span>     <span class="o">-</span><span class="mf">850.76384896</span>
</pre></div>
</div>
<p>Explanations of other output files are given below:</p>
<p><strong>Si_rt.data</strong></p>
<p>Results of time evolution calculation for vector potential, electric field, and matter current density.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Real time calculation:</span>
<span class="c1"># Ac_ext: External vector potential field</span>
<span class="c1"># E_ext: External electric field</span>
<span class="c1"># Ac_tot: Total vector potential field</span>
<span class="c1"># E_tot: Total electric field</span>
<span class="c1"># Jm: Matter current density (electrons)</span>
<span class="c1"># 1:Time[fs] 2:Ac_ext_x[fs*V/Angstrom] 3:Ac_ext_y[fs*V/Angstrom] 4:Ac_ext_z[fs*V/Angstrom]</span>
<span class="c1"># 5:E_ext_x[V/Angstrom] 6:E_ext_y[V/Angstrom] 7:E_ext_z[V/Angstrom]</span>
<span class="c1"># 8:Ac_tot_x[fs*V/Angstrom] 9:Ac_tot_y[fs*V/Angstrom] 10:Ac_tot_z[fs*V/Angstrom]</span>
<span class="c1"># 11:E_tot_x[V/Angstrom] 12:E_tot_y[V/Angstrom] 13:E_tot_z[V/Angstrom]</span>
<span class="c1"># 14:Jm_x[1/fs*Angstrom^2] 15:Jm_y[1/fs*Angstrom^2] 16:Jm_z[1/fs*Angstrom^2]</span>
</pre></div>
</div>
<p>The applied electric field is drawn using the first column (time in femtosecond)
and the 7th column (electric field in <em>z</em> direction).</p>
<blockquote>
<div><a class="reference internal image-reference" href="_images/exc6-efield.png"><img alt="_images/exc6-efield.png" src="_images/exc6-efield.png" style="width: 384.0px; height: 288.0px;" /></a>
</div></blockquote>
<p>The matter current density is drawn using the first column (time in femtosecond)
and 16th column (matter current density in <em>z</em> direction).</p>
<blockquote>
<div><a class="reference internal image-reference" href="_images/exc6-current.png"><img alt="_images/exc6-current.png" src="_images/exc6-current.png" style="width: 384.0px; height: 288.0px;" /></a>
</div></blockquote>
<p><strong>Si_pulse.data</strong></p>
<p>Time-frequency Fourier transformation of the matter current and electric field.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fourier-transform spectra:</span>
<span class="c1"># energy: Frequency</span>
<span class="c1"># Jm: Matter current</span>
<span class="c1"># E_ext: External electric field</span>
<span class="c1"># E_tot: Total electric field</span>
<span class="c1"># 1:energy[eV] 2:Re(Jm_x)[1/Angstrom^2] 3:Re(Jm_y)[1/Angstrom^2] 4:Re(Jm_z)[1/Angstrom^2]</span>
<span class="c1"># 5:Im(Jm_x)[1/Angstrom^2] 6:Im(Jm_y)[1/Angstrom^2] 7:Im(Jm_z)[1/Angstrom^2]</span>
<span class="c1"># 8:|Jm_x|^2[1/Angstrom^4] 9:|Jm_y|^2[1/Angstrom^4] 10:|Jm_z|^2[1/Angstrom^4]</span>
<span class="c1"># 11:Re(E_ext_x)[fs*V/Angstrom] 12:Re(E_ext_y)[fs*V/Angstrom]</span>
<span class="c1"># 13:Re(E_ext_z)[fs*V/Angstrom] 14:Im(E_ext_x)[fs*V/Angstrom]</span>
<span class="c1"># 15:Im(E_ext_y)[fs*V/Angstrom] 16:Im(E_ext_z)[fs*V/Angstrom]</span>
<span class="c1"># 17:|E_ext_x|^2[fs^2*V^2/Angstrom^2] 18:|E_ext_y|^2[fs^2*V^2/Angstrom^2]</span>
<span class="c1"># 19:|E_ext_z|^2[fs^2*V^2/Angstrom^2] 20:Re(E_tot_x)[fs*V/Angstrom]</span>
<span class="c1"># 21:Re(E_tot_y)[fs*V/Angstrom] 22:Re(E_tot_z)[fs*V/Angstrom]</span>
<span class="c1"># 23:Im(E_tot_x)[fs*V/Angstrom] 24:Im(E_tot_y)[fs*V/Angstrom]</span>
<span class="c1"># 25:Im(E_tot_z)[fs*V/Angstrom] 26:|E_tot_x|^2[fs^2*V^2/Angstrom^2]</span>
<span class="c1"># 27:|E_tot_y|^2[fs^2*V^2/Angstrom^2] 28:|E_tot_z|^2[fs^2*V^2/Angstrom^2]</span>
</pre></div>
</div>
<p>The power spectrum of the matter current density, <span class="math">\(|J(\omega)|^2\)</span>
is shown in logarithmic scale as a function of the energy, <span class="math">\(\hbar\omega\)</span>.
High harmonic generations are visible in the spectrum.</p>
<blockquote>
<div><a class="reference internal image-reference" href="_images/exc6-pulse.png"><img alt="_images/exc6-pulse.png" src="_images/exc6-pulse.png" style="width: 384.0px; height: 288.0px;" /></a>
</div></blockquote>
<p><strong>Si_rt_energy</strong></p>
<p>Energies are stored as functions of time.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Real time calculation:</span>
<span class="c1"># Eall: Total energy</span>
<span class="c1"># Eall0: Initial energy</span>
<span class="c1"># 1:Time[a.u.] 2:Eall[a.u.] 3:Eall-Eall0[a.u.]</span>
</pre></div>
</div>
<p><em>Eall</em> and <em>Eall-Eall0</em> are total energy and electronic excitation energy, respectively.
The figure below shows the electronic excitation energy per unit cell volume as a
function of time, using the first column (time in femtosecond) and the 3rd column
(<em>Eall-Eall0</em>). Although the frequency is below the direct bandgap of silicon
(2.4 eV in the LDA calculation), electronic excitations take place because of
nonlinear absorption process.</p>
<blockquote>
<div><a class="reference internal image-reference" href="_images/exc6-energy.png"><img alt="_images/exc6-energy.png" src="_images/exc6-energy.png" style="width: 384.0px; height: 288.0px;" /></a>
</div></blockquote>
</div>
</div>
</div>
<div class="section" id="maxwell-tddft-multiscale-simulation">
<h2>Maxwell + TDDFT multiscale simulation<a class="headerlink" href="#maxwell-tddft-multiscale-simulation" title="Permalink to this headline">¶</a></h2>
<div class="section" id="exercise-7-pulsed-light-propagation-through-a-silicon-thin-film">
<span id="exercise-7"></span><h3>Exercise-7: Pulsed-light propagation through a silicon thin film<a class="headerlink" href="#exercise-7-pulsed-light-propagation-through-a-silicon-thin-film" title="Permalink to this headline">¶</a></h3>
<p>In this exercise, we learn the calculation of a propagation of
pulsed light through a thin film of crystalline silicon.
We consider an irradiation of a few-cycle, linearly polarized pulsed light
normally on a thin film of 40 nm thickness.
This exercise should be carried out after finishing the ground state calculation
that was explained in <a class="reference internal" href="#exercise-4"><span class="std std-ref">Exercise-4</span></a>.</p>
<p>In the calculation, macroscopic Maxwell equation that describes the light
propagation and microscopic time-dependent Kohn-Sham equation that describes
the electron dynamics are solved simultaneously.
The light propagation is described by a one-dimensional
light-propagation equation for the vector potential,</p>
<p><span class="math">\(\frac{1}{c^2} \frac{\partial^2}{\partial t^2} A(X,t)
- \frac{\partial^2}{\partial X^2} A(X,t) = \frac{4\pi}{c} I(X,t).\)</span></p>
<p>The direction of the propagation is set to <em>x</em> direction and the
polarization of the pulse is set to <em>z</em> direction.
The time profile of an incident pulse is given by</p>
<p><span class="math">\(A(t) = - \frac{E_0}{\omega} \hat z \cos^2 \frac{\pi}{T} \left( t - \frac{T}{2} \right) \sin \omega \left( t - \frac{T}{2} \right), \hspace{5mm} (0 &lt; t &lt; T),\)</span></p>
<p>and is set in the vacuum region in front of the thin film.
The parameters that characterize the pulsed field such as the amplitude <span class="math">\(E_0\)</span>,
frequency <span class="math">\(\omega\)</span>, pulse duration <span class="math">\(T\)</span> are specified in the input file.</p>
<p>To discribe the light propagation, macroscopic coordinate <span class="math">\(X\)</span> is discretized as
<span class="math">\(X_i\)</span>. At each grid point inside the silicon thin film, for which we take
eight points <span class="math">\(i=1 \cdots 8\)</span> in this exercise, time-dependent Kohn-Sham
equation for Bloch orbitals are calculated in real time,</p>
<p><span class="math">\(i\hbar \frac{\partial}{\partial t} u_{i n{\bf k}}({\bf r},t)
=
H_{{\bf k} + (e/\hbar c){\bf A}_i(t)} u_{i n{\bf k}}({\bf r},t).\)</span></p>
<p>From the Bloch orbital <span class="math">\(u_{in{\bf k}}({\bf r},t)\)</span>, we calculate the electric
current <span class="math">\(I(X_i,t)\)</span>. We thus obtain a closed set of equations.
Solving these equations simultaneously, we can describe macroscopic light propagation
and microscopic electron dynamics at the same time.</p>
<div class="section" id="input-files-5">
<span id="id17"></span><h4>Input files<a class="headerlink" href="#input-files-5" title="Permalink to this headline">¶</a></h4>
<p>To run the code, following files in samples are used:</p>
<table border="1" class="docutils">
<colgroup>
<col width="49%" />
<col width="51%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>file name</td>
<td>description</td>
</tr>
<tr class="row-even"><td><em>Si_rt_multiscale.inp</em></td>
<td>input file that contain input
keywords and their values.</td>
</tr>
<tr class="row-odd"><td><em>Si_rps.dat</em></td>
<td>pseodupotential file for silicon</td>
</tr>
<tr class="row-even"><td><em>restart</em></td>
<td><div class="first last line-block">
<div class="line">directory created in the ground
state calculation</div>
<div class="line">(rename the directory from
<em>data_for_restart</em> to <em>restart</em>)</div>
</div>
</td>
</tr>
</tbody>
</table>
<p>First two files are prepared in the directory
<code class="docutils literal notranslate"><span class="pre">SALMON/samples/exercise_07_bulkSi_multiscale/</span></code>.
The file <code class="docutils literal notranslate"><span class="pre">Si_rt_multiscale.inp</span></code> contains input keywords and their values.
The pseudoopotential file should be the same as that used in the ground state calculation.
In the directory <code class="docutils literal notranslate"><span class="pre">restart</span></code>, those files created in the ground state calculation
and stored in the directory <em>data_for_restart</em> are included.
Therefore, coopy the directory as <code class="docutils literal notranslate"><span class="pre">cp</span> <span class="pre">-R</span> <span class="pre">data_for_restart</span> <span class="pre">restart</span></code>
if you calculate at the same directory as you did the ground state calculation.</p>
<p>In the input file <code class="docutils literal notranslate"><span class="pre">Si_rt_multiscale.inp</span></code>, input keywords are specified.
Most of them are mandatory to execute the electron dynamics calculation.
This will help you to prepare the input file for other systems that you want to calculate.
A complete list of the input keywords that can be used in the input file
can be found in <a class="reference internal" href="input_keyword_list.html#list-of-input-keywords"><span class="std std-ref">List of input keywords</span></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>!########################################################################################!
! Excercise 07: Maxwell+TDDFT multiscale simulation                                      !
!               (Pulsed-light propagation through a silicon thin film)                   !
!----------------------------------------------------------------------------------------!
! * The detail of this excercise is explained in our manual(see chapter: &#39;Exercises&#39;).   !
!   The manual can be obtained from: https://salmon-tddft.jp/documents.html              !
! * Input format consists of group of keywords like:                                     !
!     &amp;group                                                                             !
!       input keyword = xxx                                                              !
!     /                                                                                  !
!   (see chapter: &#39;List of input keywords&#39; in the manual)                                !
!----------------------------------------------------------------------------------------!
! * Conversion from unit_system = &#39;a.u.&#39; to &#39;A_eV_fs&#39;:                                   !
!   Length: 1 [a.u.] = 0.52917721067    [Angstrom]                                       !
!   Energy: 1 [a.u.] = 27.21138505      [eV]                                             !
!   Time  : 1 [a.u.] = 0.02418884326505 [fs]                                             !
!----------------------------------------------------------------------------------------!
! * Copy the ground state data directory(&#39;data_for_restart&#39;) (or make symbolic link)     !
!   calculated in &#39;samples/exercise_04_bulkSi_gs/&#39; and rename the directory to &#39;restart/&#39;!
!   in the current directory.                                                            !
!########################################################################################!

&amp;calculation
  !type of theory
  theory = &#39;multi_scale_maxwell_tddft&#39;
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#theory"><span class="std std-ref">theory</span></a> specifies which theoretical method is used in the calculation.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;control
  !common name of output files
  sysname = &#39;Si&#39;
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#sysname"><span class="std std-ref">sysname</span></a> is a prefix for filenames of output files.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;units
  !units used in input and output files
  unit_system = &#39;A_eV_fs&#39;
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#unit-system"><span class="std std-ref">unit_system</span></a> specifies which unit system is used in the input and output files.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;system
  !periodic boundary condition
  yn_periodic = &#39;y&#39;

  !grid box size(x,y,z)
  al(1:3) = 5.43d0, 5.43d0, 5.43d0

  !number of elements, atoms, electrons and states(bands)
  nelem  = 1
  natom  = 8
  nelec  = 32
  nstate = 32
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#yn-periodic"><span class="std std-ref">yn_periodic</span></a> specifies whether or not periodic boundary condition is applied.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#al-3"><span class="std std-ref">al(i)</span></a> specifies the side length of the unit cell.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#nelem"><span class="std std-ref">nelem</span></a> is the number of elements in the system.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#natom"><span class="std std-ref">natom</span></a> is the number of atoms in the system.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#nelec"><span class="std std-ref">nelec</span></a> is the number of electrons in the system.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#nstate"><span class="std std-ref">nstate</span></a> is the number of orbitals that are used in the calculation.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;pseudo
  !name of input pseudo potential file
  file_pseudo(1) = &#39;./Si_rps.dat&#39;

  !atomic number of element
  izatom(1) = 14

  !angular momentum of pseudopotential that will be treated as local
  lloc_ps(1) = 2
  !--- Caution -------------------------------------------!
  ! Index must correspond to those in &amp;atomic_red_coor.   !
  !-------------------------------------------------------!
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#file-pseudo"><span class="std std-ref">file_pseudo(n)</span></a> specifies the filename of the pseudopotential file of the n-th element.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#izatom"><span class="std std-ref">izatom(n)</span></a> is the atomic number of the n-th element.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#lloc-ps"><span class="std std-ref">lloc_ps(n)</span></a> specifies which angular momentum component is chosen as the local potential for the n-th element.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;functional
  !functional(&#39;PZ&#39; is Perdew-Zunger LDA: Phys. Rev. B 23, 5048 (1981).)
  xc = &#39;PZ&#39;
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#xc"><span class="std std-ref">xc</span></a> specifies the exchange-correlation potential to be used in the calculation.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;rgrid
  !number of spatial grids(x,y,z)
  num_rgrid(1:3) = 12, 12, 12
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#num-rgrid-3"><span class="std std-ref">num_rgrid(i)</span></a> specifies the number of real-space grid point in i-th direction.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;kgrid
  !number of k-points(x,y,z)
  num_kgrid(1:3) = 4, 4, 4
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#num-kgrid-3"><span class="std std-ref">num_kgrid(i)</span></a> specifies the number of k-points for i-th direction discretizing the Brillouin zone.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;tgrid
  !time step size and number of time grids(steps)
  dt = 0.002d0
  nt = 8000
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#dt"><span class="std std-ref">dt</span></a> specifies the time step.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#nt"><span class="std std-ref">nt</span></a> is the number of time steps for the time propagation.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;emfield
  !envelope shape of the incident pulse(&#39;Acos2&#39;: cos^2 type envelope for vector potential)
  ae_shape1 = &#39;Acos2&#39;

  !peak intensity(W/cm^2) of the incident pulse
  I_wcm2_1 = 1.0d12

  !duration of the incident pulse
  tw1 = 10.672d0

  !mean photon energy(average frequency multiplied by the Planck constant) of the incident pulse
  omega1 = 1.55d0

  !polarization unit vector(real part) for the incident pulse(x,y,z)
  epdir_re1(1:3) = 0.0d0, 0.0d0, 1.0d0
  !--- Caution ---------------------------------------------------------!
  ! Defenition of the incident pulse is written in:                     !
  ! https://www.sciencedirect.com/science/article/pii/S0010465518303412 !
  !---------------------------------------------------------------------!
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#ae-shape1"><span class="std std-ref">ae_shape1</span></a> specifies the envelope of the field.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#i-wcm2-1"><span class="std std-ref">I_wcm2_1</span></a> specify the intensity of the pulse in unit of W/cm<sup>2</sup>.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#tw1"><span class="std std-ref">tw1</span></a> specifies the duration of the pulse.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#omega1"><span class="std std-ref">omega1</span></a> specifies the mean photon energy of the pulse.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#epdir-re1-3"><span class="std std-ref">epdir_re1(i)</span></a> specifies the i-th component of the real part of the polarization unit vector.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;multiscale
  !number of macro grids in electromagnetic analysis for x, y, and z directions
  nx_m = 8
  ny_m = 1
  nz_m = 1

  !macro grid spacing for x, y, and z directions
  hx_m = 50.0d0
  hy_m = 50.0d0
  hz_m = 50.0d0

  !number of macroscopic grids for vacumm region
  !(nxvacl_m is for negative x-direction in front of material)
  !(nxvacr_m is for positive x-direction behind material)
  nxvacl_m = 1000
  nxvacr_m = 1000
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#nx-m"><span class="std std-ref">nx_m</span></a>, <a class="reference internal" href="input_keyword_list.html#ny-m"><span class="std std-ref">ny_m</span></a>, <a class="reference internal" href="input_keyword_list.html#nz-m"><span class="std std-ref">nz_m</span></a> specify the number of macroscopic grid points inside the material.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#hx-m"><span class="std std-ref">hx_m</span></a>, <a class="reference internal" href="input_keyword_list.html#hy-m"><span class="std std-ref">hy_m</span></a>, <a class="reference internal" href="input_keyword_list.html#hz-m"><span class="std std-ref">hz_m</span></a> specify the grid spacing of macroscopic coordinates.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#nxvacl-m"><span class="std std-ref">nxvacl_m</span></a> / <a class="reference internal" href="input_keyword_list.html#nxvacr-m"><span class="std std-ref">nxvacr_m</span></a> specifies the number of grid points in the vacuum region in the left / right side of the material.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;maxwell
  !boundary condition of electromagnetic analysis
  !first index(1-3 rows) corresponds to x, y, and z directions
  !second index(1-2 columns) corresponds to bottom and top of the directions
  !(&#39;abc&#39; is absorbing boundary condition)
  boundary_em(1,1) = &#39;abc&#39;
  boundary_em(1,2) = &#39;abc&#39;
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#boundary-em-3-2"><span class="std std-ref">boundary_em(i,n)</span></a> specifies the boundary condition for the electromagnetic analysis. The first index i corresponds to the x,y, and z direction. The second index n specifies left or right side of the material.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;atomic_red_coor
  !cartesian atomic reduced coodinates
  &#39;Si&#39;      .0      .0      .0      1
  &#39;Si&#39;      .25     .25     .25     1
  &#39;Si&#39;      .5      .0      .5      1
  &#39;Si&#39;      .0      .5      .5      1
  &#39;Si&#39;      .5      .5      .0      1
  &#39;Si&#39;      .75     .25     .75     1
  &#39;Si&#39;      .25     .75     .75     1
  &#39;Si&#39;      .75     .75     .25     1
  !--- Format ---------------------------------------------------!
  ! &#39;symbol&#39; x y z index(correspond to that of pseudo potential) !
  !--------------------------------------------------------------!
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#atomic-red-coor"><span class="std std-ref">&amp;atomic_red_coor</span></a> specifies spatial coordinates of atoms in reduced coordinate system.</div>
</div>
</div>
<div class="section" id="id18">
<h4>Execusion<a class="headerlink" href="#id18" title="Permalink to this headline">¶</a></h4>
<p>In a multiprocess environment, calculation will be executed as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ mpiexec -n NPROC salmon &lt; Si_rt_multiscale.inp &gt; Si_rt_multiscale.out
</pre></div>
</div>
<p>where NPROC is the number of MPI processes. A standard output will be stored in the file <code class="docutils literal notranslate"><span class="pre">Si_rt_multiscale.out</span></code>.</p>
</div>
<div class="section" id="output-files-7">
<span id="id19"></span><h4>Output files<a class="headerlink" href="#output-files-7" title="Permalink to this headline">¶</a></h4>
<p>After the calculation, following output files and directories are created in the
directory that you run the code in addition to the standard output file.</p>
<table border="1" class="docutils">
<colgroup>
<col width="49%" />
<col width="51%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>file name</td>
<td>description</td>
</tr>
<tr class="row-even"><td><em>Si_m/mxxxxxx/Si_rt.data</em></td>
<td><div class="first last line-block">
<div class="line">vector potential, electric field,
and matter current</div>
<div class="line">at macroscopic position <em>xxxxxx</em>
as functions of time</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><em>Si_m/mxxxxxx/Si_rt_energy.data</em></td>
<td><div class="first last line-block">
<div class="line">total energy and electronic
excitation energy</div>
<div class="line">at macroscopic position <em>xxxxxx</em>
as functions of time</div>
</div>
</td>
</tr>
<tr class="row-even"><td><em>Si_m/mxxxxxx/PS_Si_KY_n.dat</em></td>
<td><div class="first last line-block">
<div class="line">information on pseodupotential
file for silicon atom</div>
<div class="line">at macroscopic position <em>xxxxxx</em></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><em>Si_RT_Ac/Si_Ac_yyyyyy.data</em></td>
<td><div class="first last line-block">
<div class="line">vector potential,
electric field,
magnetic field,</div>
<div class="line">electromagnetic current density
at time step <em>yyyyyy</em></div>
<div class="line">as function of spatial position</div>
</div>
</td>
</tr>
<tr class="row-even"><td><em>Si_wave.data</em></td>
<td>waveform of incident, reflected,
and transmitted waves</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line">You may download the above files (zipped file) from:</div>
<div class="line"><a class="reference external" href="https://salmon-tddft.jp/webmanual/v_2_0_1/exercise_zip_files/07_bulkSi_ms.zip">https://salmon-tddft.jp/webmanual/v_2_0_1/exercise_zip_files/07_bulkSi_ms.zip</a></div>
</div>
<p>We first explain the standard output file. In the beginning of the file,
input variables used in the calculation are shown.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##############################################################################</span>
<span class="c1"># SALMON: Scalable Ab-initio Light-Matter simulator for Optics and Nanoscience</span>
<span class="c1">#</span>
<span class="c1">#                             Version 2.0.1</span>
<span class="c1">##############################################################################</span>
  <span class="n">Libxc</span><span class="p">:</span> <span class="p">[</span><span class="n">disabled</span><span class="p">]</span>
   <span class="n">theory</span><span class="o">=</span> <span class="n">multi_scale_maxwell_tddft</span>
<span class="n">Initializing</span> <span class="n">macropoint</span><span class="p">:</span>     <span class="mi">1</span><span class="o">-</span>     <span class="mi">8</span>

 <span class="n">Total</span> <span class="n">time</span> <span class="n">step</span>      <span class="o">=</span>        <span class="mi">8000</span>
 <span class="n">Time</span> <span class="n">step</span><span class="p">[</span><span class="n">fs</span><span class="p">]</span>        <span class="o">=</span>  <span class="mf">2.000000000000000E-003</span>
 <span class="n">Energy</span> <span class="nb">range</span>         <span class="o">=</span>        <span class="mi">1000</span>
 <span class="n">Energy</span> <span class="n">resolution</span><span class="p">[</span><span class="n">eV</span><span class="p">]</span><span class="o">=</span>  <span class="mf">1.000000000000000E-002</span>
<span class="n">Laser</span> <span class="n">frequency</span>     <span class="o">=</span> <span class="mf">1.55</span><span class="p">[</span><span class="n">eV</span><span class="p">]</span>
<span class="n">Pulse</span> <span class="n">width</span> <span class="n">of</span> <span class="n">laser</span><span class="o">=</span>     <span class="mf">10.67200000</span><span class="p">[</span><span class="n">fs</span><span class="p">]</span>
<span class="n">Laser</span> <span class="n">intensity</span>     <span class="o">=</span>  <span class="mf">0.10000000E+13</span><span class="p">[</span><span class="n">W</span><span class="o">/</span><span class="n">cm</span><span class="o">^</span><span class="mi">2</span><span class="p">]</span>
   <span class="n">use</span> <span class="n">of</span> <span class="n">real</span> <span class="n">value</span> <span class="n">orbitals</span> <span class="o">=</span>  <span class="n">F</span>
 <span class="n">r</span><span class="o">-</span><span class="n">space</span> <span class="n">parallelization</span><span class="p">:</span> <span class="n">off</span>
 <span class="o">======</span>
 <span class="o">.........</span>
</pre></div>
</div>
<p>After that, the time evolution loop starts. At every 100 iterations, the step,
grid point index, time, current in three Cartesian directions, the number of electrons,
and the total energy are displayed.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>   <span class="n">Step</span>  <span class="n">Macro</span>     <span class="n">Time</span>                          <span class="n">Current</span>      <span class="n">Electrons</span>  <span class="n">Eabs</span><span class="o">/</span><span class="n">cell</span>
                     <span class="n">fs</span>                  <span class="mi">1</span><span class="o">/</span><span class="n">fs</span><span class="o">*</span><span class="n">Angstrom</span><span class="o">^</span><span class="mi">2</span>                        <span class="n">eV</span>
<span class="c1">#------------------------------------------------------------------------------------------</span>
    <span class="mi">100</span>      <span class="mi">1</span>    <span class="mf">0.200</span>  <span class="mf">5.45E-010</span> <span class="o">-</span><span class="mf">4.60E-011</span>  <span class="mf">2.70E-004</span>    <span class="mf">32.00000000</span>  <span class="mf">2.36E-006</span>
    <span class="mi">100</span>      <span class="mi">2</span>    <span class="mf">0.200</span>  <span class="mf">5.45E-010</span> <span class="o">-</span><span class="mf">1.56E-011</span>  <span class="mf">1.83E-004</span>    <span class="mf">32.00000000</span>  <span class="mf">1.06E-006</span>
    <span class="mi">100</span>      <span class="mi">3</span>    <span class="mf">0.200</span>  <span class="mf">5.45E-010</span>  <span class="mf">7.19E-012</span>  <span class="mf">1.23E-004</span>    <span class="mf">32.00000000</span>  <span class="mf">4.62E-007</span>
    <span class="mi">100</span>      <span class="mi">4</span>    <span class="mf">0.200</span>  <span class="mf">5.45E-010</span>  <span class="mf">2.11E-011</span>  <span class="mf">8.14E-005</span>    <span class="mf">32.00000000</span>  <span class="mf">1.97E-007</span>
    <span class="mi">100</span>      <span class="mi">5</span>    <span class="mf">0.200</span>  <span class="mf">5.45E-010</span>  <span class="mf">2.11E-011</span>  <span class="mf">5.28E-005</span>    <span class="mf">32.00000000</span>  <span class="mf">8.04E-008</span>
    <span class="mi">100</span>      <span class="mi">6</span>    <span class="mf">0.200</span>  <span class="mf">5.45E-010</span>  <span class="mf">7.20E-012</span>  <span class="mf">3.34E-005</span>    <span class="mf">32.00000000</span>  <span class="mf">3.11E-008</span>
    <span class="mi">100</span>      <span class="mi">7</span>    <span class="mf">0.200</span>  <span class="mf">5.45E-010</span> <span class="o">-</span><span class="mf">1.56E-011</span>  <span class="mf">2.03E-005</span>    <span class="mf">32.00000000</span>  <span class="mf">1.10E-008</span>
    <span class="mi">100</span>      <span class="mi">8</span>    <span class="mf">0.200</span>  <span class="mf">5.45E-010</span> <span class="o">-</span><span class="mf">4.60E-011</span>  <span class="mf">1.13E-005</span>    <span class="mf">32.00000000</span>  <span class="mf">3.27E-009</span>
    <span class="mi">200</span>      <span class="mi">1</span>    <span class="mf">0.400</span>  <span class="mf">1.77E-011</span> <span class="o">-</span><span class="mf">2.93E-013</span>  <span class="mf">9.70E-004</span>    <span class="mf">32.00000000</span>  <span class="mf">5.80E-005</span>
    <span class="mi">200</span>      <span class="mi">2</span>    <span class="mf">0.400</span>  <span class="mf">1.78E-011</span> <span class="o">-</span><span class="mf">3.64E-011</span>  <span class="mf">7.50E-004</span>    <span class="mf">32.00000000</span>  <span class="mf">3.25E-005</span>
    <span class="mi">200</span>      <span class="mi">3</span>    <span class="mf">0.400</span>  <span class="mf">1.78E-011</span> <span class="o">-</span><span class="mf">5.58E-011</span>  <span class="mf">5.75E-004</span>    <span class="mf">32.00000000</span>  <span class="mf">1.80E-005</span>
    <span class="mi">200</span>      <span class="mi">4</span>    <span class="mf">0.400</span>  <span class="mf">1.78E-011</span> <span class="o">-</span><span class="mf">6.66E-011</span>  <span class="mf">4.38E-004</span>    <span class="mf">32.00000000</span>  <span class="mf">9.89E-006</span>
</pre></div>
</div>
<p>Explanations of other output files are given below:</p>
<p><strong>Si_wave.data</strong></p>
<p>Waveforms of incident, reflected, and transmitted waves.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1D multiscale calculation:</span>
<span class="c1"># E_inc: E-field amplitude of incident wave</span>
<span class="c1"># E_ref: E-field amplitude of reflected wave</span>
<span class="c1"># E_tra: E-field amplitude of transmitted wave</span>
<span class="c1"># 1:Time[fs] 2:E_inc_x[V/Angstrom] 3:E_inc_y[V/Angstrom] 4:E_inc_z[V/Angstrom]</span>
<span class="c1"># 5:E_ref_x[V/Angstrom] 6:E_ref_y[V/Angstrom] 7:E_ref_z[V/Angstrom] 8:E_tra_x[V/Angstrom]</span>
<span class="c1"># 9:E_tra_y[V/Angstrom] 10:E_tra_z[V/Angstrom]</span>
</pre></div>
</div>
<p>The figure below shows the incident, reflected, and transmitted electric fields
that are drawn using the first column (time in femtosecond) and the 4th column (incident),
7th column (reflected), and 10th column (transmitted).</p>
<blockquote>
<div><a class="reference internal image-reference" href="_images/exc7-efield.png"><img alt="_images/exc7-efield.png" src="_images/exc7-efield.png" style="width: 384.0px; height: 288.0px;" /></a>
</div></blockquote>
<p>We find that the amplitude of the reflected pulse is comparable to the amplitude
of the incudent pulse, while the phase is different by <span class="math">\(\pi\)</span>.
The amplitude of the transmitted pulse is smaller than the incident pulse.</p>
<p><strong>Si_m/mxxxxxx/Si_rt.data</strong></p>
<p>The number <em>xxxxxx</em> in the directory name <em>mxxxxxx</em> specifies the position of
macroscopic grid point. Vector potential, electric field, and matter current density
as functions of time are included in the file.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Real time calculation:</span>
<span class="c1"># Ac_ext: External vector potential field</span>
<span class="c1"># E_ext: External electric field</span>
<span class="c1"># Ac_tot: Total vector potential field</span>
<span class="c1"># E_tot: Total electric field</span>
<span class="c1"># Jm: Matter current density (electrons)</span>
<span class="c1"># 1:Time[fs] 2:Ac_ext_x[fs*V/Angstrom] 3:Ac_ext_y[fs*V/Angstrom] 4:Ac_ext_z[fs*V/Angstrom]</span>
<span class="c1"># 5:E_ext_x[V/Angstrom] 6:E_ext_y[V/Angstrom] 7:E_ext_z[V/Angstrom] 8:Ac_tot_x[fs*V/Angstrom]</span>
<span class="c1"># 9:Ac_tot_y[fs*V/Angstrom] 10:Ac_tot_z[fs*V/Angstrom] 11:E_tot_x[V/Angstrom]</span>
<span class="c1"># 12:E_tot_y[V/Angstrom] 13:E_tot_z[V/Angstrom]  14:Jm_x[1/fs*Angstrom^2]</span>
<span class="c1"># 15:Jm_y[1/fs*Angstrom^2] 16:Jm_z[1/fs*Angstrom^2]</span>
</pre></div>
</div>
<p>The figure below shows the electric field at front and back surfaces.
Using 1st column (time in femtosecond) and 13th column (total electric field in <em>z</em> direction),
electric field at a macroscopic poisition inside the thin film can be plotted.
Using the file <code class="docutils literal notranslate"><span class="pre">/m000001/Si_rt.data</span></code>, electric field at the front surface is drawn
by red curve. Using the file <code class="docutils literal notranslate"><span class="pre">/m000008/Si_rt.data</span></code>, electric field at the back surface
is drawn by blue curve.</p>
<blockquote>
<div><a class="reference internal image-reference" href="_images/exc7-efield2.png"><img alt="_images/exc7-efield2.png" src="_images/exc7-efield2.png" style="width: 384.0px; height: 288.0px;" /></a>
</div></blockquote>
<p>We find that the amplitude of the electric field at the front surface is small.
It is consistent with the previous figure that showed incident and reflected pulses
with a similar amplitude and opposite phase.</p>
<p><strong>Si_m/mxxxxxx/Si_rt_energy.data</strong></p>
<p>The number <em>xxxxxx</em> in the directory name <em>mxxxxxx</em> specifies the position of
macroscopic grid point.
<em>Eall</em> and <em>Eall-Eall0</em> are total energy and electronic excitation energy, respectively.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Real time calculation:</span>
<span class="c1"># Eall: Total energy</span>
<span class="c1"># Eall0: Initial energy</span>
<span class="c1"># 1:Time[fs] 2:Eall[eV] 3:Eall-Eall0[eV]</span>
</pre></div>
</div>
<p>The figure below shows the electronic excitation energy per unit cell volume
at front and back surfaces using 1st columnn (time in femtosecond) and 3rd column
(<em>Eall-Eall0</em>).
Using the file <code class="docutils literal notranslate"><span class="pre">/m000001/Si_rt_energy.data</span></code>, the excitation energy at the
front surface is drawn by red curve. Using the file <code class="docutils literal notranslate"><span class="pre">/m000008/Si_rt_energy.data</span></code>,
the excitation energy at the back surface is drawn by blue curve.</p>
<blockquote>
<div><a class="reference internal image-reference" href="_images/exc7-energy2.png"><img alt="_images/exc7-energy2.png" src="_images/exc7-energy2.png" style="width: 384.0px; height: 288.0px;" /></a>
</div></blockquote>
<p>The excitation energy is much larger at the back surface compared with the energy
at the front surface. This is because the amplitude of the electric field
at the back surface is larger than that of the front surface, as seen in the
previous figure, and the excitation is a nonlinear process.</p>
<p><strong>Si_RT_Ac/Si_Ac_yyyyyy.data</strong></p>
<p>The number <em>yyyyyy</em> in the file name <code class="docutils literal notranslate"><span class="pre">Si_Ac_yyyyyy.data</span></code> specifies the time step.
Various quantities at the time step are included in the file as functions of macroscopic
position index.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Multiscale TDDFT calculation</span>
<span class="c1"># IX, IY, IZ: FDTD Grid index</span>
<span class="c1"># x, y, z: Coordinates</span>
<span class="c1"># Ac: Vector potential field</span>
<span class="c1"># E: Electric field</span>
<span class="c1"># J_em: Electromagnetic current density</span>
<span class="c1"># 1:IX[none] 2:IY[none] 3:IZ[none] 4:Ac_x[fs*V/Angstrom] 5:Ac_y[fs*V/Angstrom]</span>
<span class="c1"># 6:Ac_z[fs*V/Angstrom] 7:E_x[V/Angstrom] 8:E_y[V/Angstrom] 9:E_z[V/Angstrom] 10:B_x[a.u.]</span>
<span class="c1"># 11:B_y[a.u.] 12:B_z[a.u.] 13:Jem_x[1/fs*Angstrom^2] 14:Jem_y[1/fs*Angstrom^2]</span>
<span class="c1"># 15:Jem_z[1/fs*Angstrom^2] 16:E_em[eV/vol] 17:E_abs[eV/vol]</span>
</pre></div>
</div>
<p>The figure below shows spatial dependence of the electric field at three times,
<span class="math">\(t=0\)</span> fs (initial), <span class="math">\(t=8\)</span> fs (pulse goes through the film), and
<span class="math">\(t=16\)</span> fs (final). It is drawn using the first column multiplied by the
step size of <span class="math">\(X\)</span> and 9th column (electric field).</p>
<blockquote>
<div><a class="reference internal image-reference" href="_images/exc7-efield-x.png"><img alt="_images/exc7-efield-x.png" src="_images/exc7-efield-x.png" style="width: 384.0px; height: 288.0px;" /></a>
</div></blockquote>
</div>
</div>
</div>
<div class="section" id="geometry-optimization-and-ehrenfest-molecular-dynamics">
<h2>Geometry optimization and Ehrenfest molecular dynamics<a class="headerlink" href="#geometry-optimization-and-ehrenfest-molecular-dynamics" title="Permalink to this headline">¶</a></h2>
<div class="section" id="exercise-8-geometry-optimization-of-c2h2-molecule">
<span id="exercise-8"></span><h3>Exercise-8: Geometry optimization of C2H2 molecule<a class="headerlink" href="#exercise-8-geometry-optimization-of-c2h2-molecule" title="Permalink to this headline">¶</a></h3>
<p>In this exercise, we learn the calculation of geometry optimization of acetylene (C2H2) molecule,
solving the static Kohn-Sham equation.
This exercise will be useful to learn how to set up calculations in
SALMON for any isolated systems such as molecules and nanoparticles.</p>
<div class="section" id="id20">
<h4>Input files<a class="headerlink" href="#id20" title="Permalink to this headline">¶</a></h4>
<p>To run the code, following files in samples are used:</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>file name</td>
<td>description</td>
</tr>
<tr class="row-even"><td><em>C2H2_opt.inp</em></td>
<td>input file that contains input
keywords and their values</td>
</tr>
<tr class="row-odd"><td><em>C_rps.dat</em></td>
<td>pseodupotential file for carbon
atom</td>
</tr>
<tr class="row-even"><td><em>H_rps.dat</em></td>
<td>pseudopotential file for hydrogen
atom</td>
</tr>
</tbody>
</table>
<p>In the input file <code class="docutils literal notranslate"><span class="pre">C2H2_opt.inp</span></code>, input keywords are specified.
Most of them are mandatory to execute the geometry optimization.
This will help you to prepare an input file for other systems that you
want to calculate. A complete list of the input keywords that can be
used in the input file can be found in
<a class="reference internal" href="input_keyword_list.html#list-of-input-keywords"><span class="std std-ref">List of input keywords</span></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>!########################################################################################!
! Excercise 08: Geometry optimization of C2H2 molecule                                   !
!----------------------------------------------------------------------------------------!
! * The detail of this excercise is expained in our manual(see chapter: &#39;Exercises&#39;).    !
!   The manual can be obtained from: https://salmon-tddft.jp/documents.html              !
! * Input format consists of group of keywords like:                                     !
!     &amp;group                                                                             !
!       input keyword = xxx                                                              !
!     /                                                                                  !
!   (see chapter: &#39;List of input keywords&#39; in the manual)                                !
!----------------------------------------------------------------------------------------!
! * Conversion from unit_system = &#39;a.u.&#39; to &#39;A_eV_fs&#39;:                                   !
!   Length: 1 [a.u.] = 0.52917721067    [Angstrom]                                       !
!   Energy: 1 [a.u.] = 27.21138505      [eV]                                             !
!   Time  : 1 [a.u.] = 0.02418884326505 [fs]                                             !
!########################################################################################!

&amp;calculation
  !type of theory
  theory = &#39;dft&#39;

  !geometry optimization option
  yn_opt = &#39;y&#39;
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#theory"><span class="std std-ref">theory</span></a> specifies which theoretical method is used in the calculation.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#yn-opt"><span class="std std-ref">yn_opt</span></a> is a switch to carry out the structure optimization.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;control
  !common name of output files
  sysname = &#39;C2H2&#39;
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#sysname"><span class="std std-ref">sysname</span></a> is a prefix for filenames of output files.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;units
  !units used in input and output files
  unit_system = &#39;A_eV_fs&#39;
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#unit-system"><span class="std std-ref">unit_system</span></a> specifies which unit system is used in the input and output files.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;system
  !periodic boundary condition
  yn_periodic = &#39;n&#39;

  !grid box size(x,y,z)
  al(1:3) = 12.0d0, 12.0d0, 16.0d0

  !number of elements, atoms, electrons and states(orbitals)
  nelem  = 2
  natom  = 4
  nelec  = 10
  nstate = 6
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#yn-periodic"><span class="std std-ref">yn_periodic</span></a> specifies whether or not periodic boundary condition is applied.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#al-3"><span class="std std-ref">al(i)</span></a> specifies the spatial box size of the cubiod cell.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#nelem"><span class="std std-ref">nelem</span></a> is the number of elements in the system.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#natom"><span class="std std-ref">natom</span></a> is the number of atoms in the system.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#nelec"><span class="std std-ref">nelec</span></a> is the number of electrons in the system.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#nstate"><span class="std std-ref">nstate</span></a> is the number of orbitals that are used in the calculation.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;pseudo
  !name of input pseudo potential file
  file_pseudo(1) = &#39;./C_rps.dat&#39;
  file_pseudo(2) = &#39;./H_rps.dat&#39;

  !atomic number of element
  izatom(1) = 6
  izatom(2) = 1

  !angular momentum of pseudopotential that will be treated as local
  lloc_ps(1) = 1
  lloc_ps(2) = 0
  !--- Caution ---------------------------------------!
  ! Indices must correspond to those in &amp;atomic_coor. !
  !---------------------------------------------------!
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#file-pseudo"><span class="std std-ref">file_pseudo(n)</span></a> specifies the filename of the pseudopotential file of the n-th element.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#izatom"><span class="std std-ref">izatom(n)</span></a> is the atomic number of the n-th element.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#lloc-ps"><span class="std std-ref">lloc_ps(n)</span></a> specifies which angular momentum component is chosen as the local potential for the n-th element.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;functional
  !functional(&#39;PZ&#39; is Perdew-Zunger LDA: Phys. Rev. B 23, 5048 (1981).)
  xc = &#39;PZ&#39;
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#xc"><span class="std std-ref">xc</span></a> specifies the exchange-correlation potential to be used in the calculation.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;rgrid
  !spatial grid spacing(x,y,z)
  dl(1:3) = 0.20d0, 0.20d, 0.20d0
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#dl-3"><span class="std std-ref">dl(i)</span></a> specifies the spatial grid spacing in i-th direction.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;scf
  !maximum number of scf iteration and threshold of convergence for ground state calculation
  nscf      = 300
  threshold = 1.0d-9
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#nscf"><span class="std std-ref">nscf</span></a> specifies the maximum number of SCF iterations.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#threshold"><span class="std std-ref">threshold</span></a> specifies the threshold to judge the convergence.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;opt
  !threshold(maximum force on atom) of convergence for geometry optimization
  convrg_opt_fmax = 1.0d-3
/

&amp;atomic_coor
  !cartesian atomic coodinates
  &#39;C&#39;    0.0    0.0    0.6  1  y
  &#39;H&#39;    0.0    0.0    1.7  2  y
  &#39;C&#39;    0.0    0.0   -0.6  1  y
  &#39;H&#39;    0.0    0.0   -1.7  2  y
  !--- Format -------------------------------------------------------!
  ! &#39;symbol&#39; x y z index(correspond to that of pseudo potential) y/n !
  !--- Caution ------------------------------------------------------!
  ! final index(y/n) determines free/fix for the atom coordinate.    !
  !------------------------------------------------------------------!
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#atomic-coor"><span class="std std-ref">&amp;atomic_coor</span></a> specifies spatial coordinates of atoms.</div>
</div>
</div>
<div class="section" id="output-files-8">
<span id="id21"></span><h4>Output files<a class="headerlink" href="#output-files-8" title="Permalink to this headline">¶</a></h4>
<p>After the calculation, following output files and a directory are created in the
directory that you run the code,</p>
<table border="1" class="docutils">
<colgroup>
<col width="51%" />
<col width="49%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>name</td>
<td>description</td>
</tr>
<tr class="row-even"><td><em>C2H2_info.data</em></td>
<td>information on ground state
solution</td>
</tr>
<tr class="row-odd"><td><em>C2H2_eigen.data</em></td>
<td>1 particle energies</td>
</tr>
<tr class="row-even"><td><em>C2H2_trj.xyz</em></td>
<td>atomic coordinates during the
geometry optimization</td>
</tr>
<tr class="row-odd"><td><em>C2H2_k.data</em></td>
<td>k-point distribution
(for isolated systems, only
gamma point is described)</td>
</tr>
<tr class="row-even"><td><em>data_for_restart</em></td>
<td>directory where files used in
the real-time calculation are
contained</td>
</tr>
<tr class="row-odd"><td><em>PS_C_KY_n.dat</em></td>
<td>information on pseodupotential
file for carbon atom</td>
</tr>
<tr class="row-even"><td><em>PS_H_KY_n.dat</em></td>
<td>information on pseodupotential
file for hydrogen atom</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line">You may download the above files (zipped file, except for the directory <code class="docutils literal notranslate"><span class="pre">data_for_restart</span></code>) from:</div>
<div class="line"><a class="reference external" href="https://salmon-tddft.jp/webmanual/v_2_0_1/exercise_zip_files/08_C2H2_opt.zip">https://salmon-tddft.jp/webmanual/v_2_0_1/exercise_zip_files/08_C2H2_opt.zip</a></div>
</div>
<p>Main results of the calculation such as orbital energies are included in <code class="docutils literal notranslate"><span class="pre">C2H2_info.data</span></code>.
Explanations of the <em>C2H2_info.data</em> and other output files are below:</p>
<p><strong>C2H2_info.data</strong></p>
<p>Calculated orbital and total energies as well as parameters specified in
the input file are shown in this file.</p>
<p><strong>C2H2_eigen.data</strong></p>
<p>1 particle energies.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#esp: single-particle energies (eigen energies)</span>
<span class="c1">#occ: occupation numbers, io: orbital index</span>
<span class="c1"># 1:io, 2:esp[eV], 3:occ</span>
</pre></div>
</div>
<p><strong>C2H2_trj.xyz</strong></p>
<p>The atomic coordinates during the geometry optimization in xyz format.</p>
<p><strong>C2H2_k.data</strong></p>
<p>k-point distribution(for isolated systems, only gamma point is described).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># ik: k-point index</span>
<span class="c1"># kx,ky,kz: Reduced coordinate of k-points</span>
<span class="c1"># wk: Weight of k-point</span>
<span class="c1"># 1:ik[none] 2:kx[none] 3:ky[none] 4:kz[none] 5:wk[none]</span>
<span class="c1"># coefficients (2*pi/a [a.u.]) in kx, ky, kz</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="exercise-9-ehrenfest-molecular-dynamics-of-c2h2-molecule">
<span id="exercise-9"></span><h3>Exercise-9: Ehrenfest molecular dynamics of C2H2 molecule<a class="headerlink" href="#exercise-9-ehrenfest-molecular-dynamics-of-c2h2-molecule" title="Permalink to this headline">¶</a></h3>
<p>In this exercise, we learn the calculation of the molecular dynamics in
the acetylene (C2H2) molecule under a pulsed electric field, solving the
time-dependent Kohn-Sham equation and the Newtonian equation.
As outputs of the calculation, time-evolution of the electron density as well as molecular structures
and associated quantities such as the electron and ion kinetic energies, the electric dipole moment of the
system and temperature as functions of time are calculated..
This tutorial should be carried out after finishing the geometry optimization that was
explained in <a class="reference internal" href="#exercise-8"><span class="std std-ref">Exercise-8</span></a>.
In the calculation, a pulsed electric field that has <span class="math">\(\cos^2\)</span> envelope shape is applied.
The parameters that characterize the pulsed field such as magnitude, frequency, polarization direction,
and carrier envelope phase are specified in the input file.</p>
<div class="section" id="id22">
<h4>Input files<a class="headerlink" href="#id22" title="Permalink to this headline">¶</a></h4>
<p>To run the code, following files in samples are used.
The directory <code class="docutils literal notranslate"><span class="pre">restart</span></code> is created in the ground state calculation as <code class="docutils literal notranslate"><span class="pre">data_for_restart</span></code>.
Pseudopotential files are already used in the geometry optimization.
Therefore, <code class="docutils literal notranslate"><span class="pre">C2H2_md.inp</span></code> that specifies input keywords and their values
for the pulsed electric field and molecular dynamics calculations
is the only file that the users need to prepare.</p>
<table border="1" class="docutils">
<colgroup>
<col width="49%" />
<col width="51%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>file name</td>
<td>description</td>
</tr>
<tr class="row-even"><td><em>C2H2_md.inp</em></td>
<td>input file that contain input
keywords and their values.</td>
</tr>
<tr class="row-odd"><td><em>C_rps.dat</em></td>
<td>pseodupotential file for carbon</td>
</tr>
<tr class="row-even"><td><em>H_rps.dat</em></td>
<td>pseudopotential file for hydrogen</td>
</tr>
<tr class="row-odd"><td><em>restart</em></td>
<td><div class="first last line-block">
<div class="line">directory created in the geometry
optimization</div>
<div class="line">(rename the directory from
<em>data_for_restart</em> to <em>restart</em>)</div>
</div>
</td>
</tr>
</tbody>
</table>
<p>In the input file <code class="docutils literal notranslate"><span class="pre">C2H2_md.inp</span></code>, input keywords are specified.
Most of them are mandatory to execute the calculation of
electron dynamics induced by a pulsed electric field.
This will help you to prepare the input file for other systems and other
pulsed electric fields with molecular dynamics calculation that you want to calculate.
A complete list of the input keywords that can be used in the input file can be found in
<a class="reference internal" href="input_keyword_list.html#list-of-input-keywords"><span class="std std-ref">List of input keywords</span></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>!########################################################################################!
! Excercise 09: Ehrenfest molecular dynamics of C2H2 molecule                            !
!----------------------------------------------------------------------------------------!
! * The detail of this excercise is expained in our manual(see chapter: &#39;Exercises&#39;).    !
!   The manual can be obtained from: https://salmon-tddft.jp/documents.html              !
! * Input format consists of group of keywords like:                                     !
!     &amp;group                                                                             !
!       input keyword = xxx                                                              !
!     /                                                                                  !
!   (see chapter: &#39;List of input keywords&#39; in the manual)                                !
!----------------------------------------------------------------------------------------!
! * Conversion from unit_system = &#39;a.u.&#39; to &#39;A_eV_fs&#39;:                                   !
!   Length: 1 [a.u.] = 0.52917721067    [Angstrom]                                       !
!   Energy: 1 [a.u.] = 27.21138505      [eV]                                             !
!   Time  : 1 [a.u.] = 0.02418884326505 [fs]                                             !
!----------------------------------------------------------------------------------------!
! * Ehrenfest-MD option is still trial.                                                  !
! * Copy the ground state data directory (&#39;data_for_restart&#39;) (or make symbolic link)    !
!   calculated in &#39;samples/exercise_08_C2H2_opt/&#39; and rename the directory to &#39;restart/&#39; !
!   in the current directory.                                                            !
!########################################################################################!

&amp;calculation
  !type of theory
  theory = &#39;tddft_pulse&#39;

  !molecular dynamics option
  yn_md  = &#39;y&#39;
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#theory"><span class="std std-ref">theory</span></a> specifies which theoretical method is used in the calculation.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#yn-md"><span class="std std-ref">yn_md</span></a> is a switch for Ehrenfest molecular dynamics.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;control
  !common name of output files
  sysname = &#39;C2H2&#39;
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#sysname"><span class="std std-ref">sysname</span></a> is a prefix for filenames of output files.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;units
  !units used in input and output files
  unit_system = &#39;A_eV_fs&#39;
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#unit-system"><span class="std std-ref">unit_system</span></a> specifies which unit system is used in the input and output files.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;system
  !periodic boundary condition
  yn_periodic = &#39;n&#39;

  !grid box size(x,y,z)
  al(1:3) = 12.0d0, 12.0d0, 16.0d0

  !number of elements, atoms, electrons and states(orbitals)
  nelem  = 2
  natom  = 4
  nelec  = 10
  nstate = 6
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#yn-periodic"><span class="std std-ref">yn_periodic</span></a> specifies whether or not periodic boundary condition is applied.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#al-3"><span class="std std-ref">al(i)</span></a> specifies the spatial box size of the cubiod cell.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#nelem"><span class="std std-ref">nelem</span></a> is the number of elements in the system.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#natom"><span class="std std-ref">natom</span></a> is the number of atoms in the system.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#nelec"><span class="std std-ref">nelec</span></a> is the number of electrons in the system.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#nstate"><span class="std std-ref">nstate</span></a> is the number of orbitals that are used in the calculation.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;pseudo
  !name of input pseudo potential file
  file_pseudo(1) = &#39;./C_rps.dat&#39;
  file_pseudo(2) = &#39;./H_rps.dat&#39;

  !atomic number of element
  izatom(1) = 6
  izatom(2) = 1

  !angular momentum of pseudopotential that will be treated as local
  lloc_ps(1) = 1
  lloc_ps(2) = 0
  !--- Caution ---------------------------------------!
  ! Indices must correspond to those in &amp;atomic_coor. !
  !---------------------------------------------------!
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#file-pseudo"><span class="std std-ref">file_pseudo(n)</span></a> specifies the filename of the pseudopotential file of the n-th element.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#izatom"><span class="std std-ref">izatom(n)</span></a> is the atomic number of the n-th element.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#lloc-ps"><span class="std std-ref">lloc_ps(n)</span></a> specifies which angular momentum component is chosen as the local potential for the n-th element.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;functional
  !functional(&#39;PZ&#39; is Perdew-Zunger LDA: Phys. Rev. B 23, 5048 (1981).)
  xc = &#39;PZ&#39;
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#xc"><span class="std std-ref">xc</span></a> specifies the exchange-correlation potential to be used in the calculation.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;rgrid
  !spatial grid spacing(x,y,z)
  dl(1:3) = 0.20d0, 0.20d0, 0.20d0
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#dl-3"><span class="std std-ref">dl(i)</span></a> specifies the spatial grid spacing in i-th direction.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;tgrid
  !time step size and number of time grids(steps)
  dt = 1.00d-3
  nt = 5000
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#dt"><span class="std std-ref">dt</span></a> specifies the time step.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#nt"><span class="std std-ref">nt</span></a> is the number of time steps for the time propagation.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;emfield
  !envelope shape of the incident pulse(&#39;Ecos2&#39;: cos^2 type envelope for scalar potential)
  ae_shape1 = &#39;Ecos2&#39;

  !peak intensity(W/cm^2) of the incident pulse
  I_wcm2_1 = 1.00d8

  !duration of the incident pulse
  tw1 = 6.00d0

  !mean photon energy(average frequency multiplied by the Planck constant) of the incident pulse
  omega1 = 9.28d0

  !polarization unit vector(real part) for the incident pulse(x,y,z)
  epdir_re1(1:3) = 0.00d0, 0.00d0, 1.00d0

  !carrier emvelope phase of the incident pulse
  !(phi_cep1 must be 0.25 + 0.5 * n(integer) when ae_shape1 = &#39;Ecos2&#39;)
  phi_cep1 = 0.75d0
  !--- Caution ---------------------------------------------------------!
  ! Defenition of the incident pulse is wrriten in:                     !
  ! https://www.sciencedirect.com/science/article/pii/S0010465518303412 !
  !---------------------------------------------------------------------!
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#ae-shape1"><span class="std std-ref">ae_shape1</span></a> specifies the envelope of the field.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#i-wcm2-1"><span class="std std-ref">I_wcm2_1</span></a> specify the intensity of the pulse in unit of W/cm<sup>2</sup>.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#tw1"><span class="std std-ref">tw1</span></a> specifies the duration of the pulse.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#omega1"><span class="std std-ref">omega1</span></a> specifies the mean photon energy of the pulse.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#epdir-re1-3"><span class="std std-ref">epdir_re1(i)</span></a> specifies the i-th component of the real part of the polarization unit vector.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#phi-cep1"><span class="std std-ref">phi_cep1</span></a> specifies the carrier-envelope phase of the pulse.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;md
  !ensemble
  ensemble = &#39;NVE&#39;

  !set of initial velocities
  yn_set_ini_velocity = &#39;y&#39;

  !setting temperature [K] for NVT ensemble, velocity scaling,
  !and generating initial velocities
  temperature0_ion_k = 300.0d0

  !time step interval for updating pseudopotential
  step_update_ps = 20
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#ensemble"><span class="std std-ref">ensemble</span></a> specifies the choice of the ensemble.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#yn-set-ini-velocity"><span class="std std-ref">yn_set_ini_velocity</span></a> is a switch to prepare initial velocity for atoms.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#temperature0-ion-k"><span class="std std-ref">temperature0_ion_k</span></a> specifies the temperature that is used to generate initial velocity of ions.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#step-update-ps"><span class="std std-ref">step_update_ps</span></a> specifies the time step interval to update projector for the nonlocal pseudopotential.</div>
</div>
</div>
<div class="section" id="output-files-9">
<span id="id23"></span><h4>Output files<a class="headerlink" href="#output-files-9" title="Permalink to this headline">¶</a></h4>
<p>After the calculation, following output files are created in the
directory that you run the code,</p>
<table border="1" class="docutils">
<colgroup>
<col width="51%" />
<col width="49%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>file name</td>
<td>description</td>
</tr>
<tr class="row-even"><td><em>C2H2_pulse.data</em></td>
<td>dipole moment as
functions of energy</td>
</tr>
<tr class="row-odd"><td><em>C2H2_rt.data</em></td>
<td><div class="first last line-block">
<div class="line">components of
change of dipole moment
(electrons/plus definition)</div>
<div class="line">and total dipole moment
(electrons/minus + ions/plus)
as functions of time</div>
</div>
</td>
</tr>
<tr class="row-even"><td><em>C2H2_rt_energy.data</em></td>
<td>components of
total energy
and difference of total energy
as functions of time</td>
</tr>
<tr class="row-odd"><td><em>C2H2_trj.xyz</em></td>
<td>Trajectory of atoms(ions):
Atomic coordinates, velocities,
and forces are printed</td>
</tr>
<tr class="row-even"><td><em>PS_C_KY_n.dat</em></td>
<td>information on pseodupotential
file for carbon atom</td>
</tr>
<tr class="row-odd"><td><em>PS_H_KY_n.dat</em></td>
<td>information on pseodupotential
file for hydrogen atom</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line">You may download the above files (zipped file) from:</div>
<div class="line"><a class="reference external" href="https://salmon-tddft.jp/webmanual/v_2_0_1/exercise_zip_files/09_C2H2_md.zip">https://salmon-tddft.jp/webmanual/v_2_0_1/exercise_zip_files/09_C2H2_md.zip</a></div>
</div>
<p>Explanations of the files are described below:</p>
<p><strong>C2H2_pulse.data</strong></p>
<p>Time-frequency Fourier transformation of the dipole moment.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fourier-transform spectra:</span>
<span class="c1"># energy: Frequency</span>
<span class="c1"># dm: Dopile moment</span>
<span class="c1"># 1:energy[eV] 2:Re(dm_x)[fs*Angstrom] 3:Re(dm_y)[fs*Angstrom] 4:Re(dm_z)[fs*Angstrom] 5:Im(dm_x)[fs*Angstrom] 6:Im(dm_y)[fs*Angstrom] 7:Im(dm_z)[fs*Angstrom] 8:|dm_x|^2[fs^2*Angstrom^2] 9:|dm_y|^2[fs^2*Angstrom^2] 10:|dm_z|^2[fs^2*Angstrom^2]</span>
</pre></div>
</div>
<p><strong>C2H2_rt.data</strong></p>
<p>Results of time evolution calculation for vector potential, electric field, and dipole moment.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Real time calculation:</span>
<span class="c1"># Ac_ext: External vector potential field</span>
<span class="c1"># E_ext: External electric field</span>
<span class="c1"># Ac_tot: Total vector potential field</span>
<span class="c1"># E_tot: Total electric field</span>
<span class="c1"># ddm_e: Change of dipole moment (electrons/plus definition)</span>
<span class="c1"># dm: Total dipole moment (electrons/minus + ions/plus)</span>
<span class="c1"># 1:Time[fs] 2:Ac_ext_x[fs*V/Angstrom] 3:Ac_ext_y[fs*V/Angstrom] 4:Ac_ext_z[fs*V/Angstrom] 5:E_ext_x[V/Angstrom] 6:E_ext_y[V/Angstrom] 7:E_ext_z[V/Angstrom] 8:Ac_tot_x[fs*V/Angstrom] 9:Ac_tot_y[fs*V/Angstrom] 10:Ac_tot_z[fs*V/Angstrom] 11:E_tot_x[V/Angstrom] 12:E_tot_y[V/Angstrom] 13:E_tot_z[V/Angstrom] 14:ddm_e_x[Angstrom] 15:ddm_e_y[Angstrom] 16:ddm_e_z[Angstrom] 17:dm_x[Angstrom] 18:dm_y[Angstrom] 19:dm_z[Angstrom]</span>
</pre></div>
</div>
<p><strong>C2H2_rt_energy.data</strong></p>
<p><em>Eall</em> and <em>Eall-Eall0</em> are total energy and electronic excitation energy, respectively.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Real time calculation:</span>
<span class="c1"># Eall: Total energy</span>
<span class="c1"># Eall0: Initial energy</span>
<span class="c1"># Tion: Kinetic energy of ions</span>
<span class="c1"># Temperature_ion: Temperature of ions</span>
<span class="c1"># E_work: Work energy of ions(sum f*dr)</span>
<span class="c1"># 1:Time[fs] 2:Eall[eV] 3:Eall-Eall0[eV] # 4:Tion[eV] 5:Temperature_ion[K] 6:E_work[eV]</span>
</pre></div>
</div>
<p><strong>C2H2_trj.xyz</strong></p>
<p>Atomic coordinates [Angstrom], velocities [a.u.] and forces [a.u.] are printed along the time evolution in xyz format.</p>
</div>
</div>
</div>
<div class="section" id="fdtd-simulation-electromagnetic-analysis">
<h2>FDTD simulation(electromagnetic analysis)<a class="headerlink" href="#fdtd-simulation-electromagnetic-analysis" title="Permalink to this headline">¶</a></h2>
<div class="section" id="exercise-10-absorption-scattering-and-extinction-cross-sections-of-an-au-nanoparticle-in-fdtd-simulation">
<span id="exercise-10"></span><h3>Exercise-10: Absorption-, Scattering-, and Extinction-cross-sections of an Au nanoparticle in FDTD simulation<a class="headerlink" href="#exercise-10-absorption-scattering-and-extinction-cross-sections-of-an-au-nanoparticle-in-fdtd-simulation" title="Permalink to this headline">¶</a></h3>
<p>In this exercise, we learn the calculation of the absorption-, scattering-, and extinction-cross-sections of an Au nanoparticle,
by applying the incident pulse in the time-dependent Maxwell equations.
As outputs of the calculation, those cross-sections and the time response of the electromagnetic field are calculated.
A pulsed electric field that has <span class="math">\(\cos^2\)</span> envelope shape is applied.
The parameters that characterize the pulsed field such as magnitude, frequency, polarization direction, and carrier envelope phase are specified in the input file.</p>
<div class="section" id="id24">
<h4>Input files<a class="headerlink" href="#id24" title="Permalink to this headline">¶</a></h4>
<p>To run the code, the input file <code class="docutils literal notranslate"><span class="pre">AuNP_fdtd.inp</span></code> is used:</p>
<table border="1" class="docutils">
<colgroup>
<col width="49%" />
<col width="51%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>file name</td>
<td>description</td>
</tr>
<tr class="row-even"><td><em>AuNP_fdtd.inp</em></td>
<td>input file that contains input
keywords and their values.</td>
</tr>
</tbody>
</table>
<p>In the input file <code class="docutils literal notranslate"><span class="pre">AuNP_fdtd.inp</span></code>, input keywords are specified.
Most of them are mandatory to execute this exercise.
This will help you to prepare the input file for other systems that you want to calculate.
A complete list of the input keywords that can be used in the input file
can be found in <a class="reference internal" href="input_keyword_list.html#list-of-input-keywords"><span class="std std-ref">List of input keywords</span></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>!########################################################################################!
! Excercise 10: Absorption-, Scattering-, and Extinction-cross-sections                  !
!               of an Au nanoparticle in FDTD simulation                                 !
!----------------------------------------------------------------------------------------!
! * The detail of this excercise is explained in our manual(see chapter: &#39;Exercises&#39;).   !
!   The manual can be obtained from: https://salmon-tddft.jp/documents.html              !
! * Input format consists of group of keywords like:                                     !
!     &amp;group                                                                             !
!       input keyword = xxx                                                              !
!     /                                                                                  !
!   (see chapter: &#39;List of input keywords&#39; in the manual)                                !
!----------------------------------------------------------------------------------------!
! * Conversion from unit_system = &#39;a.u.&#39; to &#39;A_eV_fs&#39;:                                   !
!   Length: 1 [a.u.] = 0.52917721067    [Angstrom]                                       !
!   Energy: 1 [a.u.] = 27.21138505      [eV]                                             !
!   Time  : 1 [a.u.] = 0.02418884326505 [fs]                                             !
!########################################################################################!

&amp;calculation
  !type of theory
  theory = &#39;maxwell&#39;
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#theory"><span class="std std-ref">theory</span></a> specifies which theoretical method is used in the calculation.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;control
  !common name of output files
  sysname = &#39;AuNP&#39;

  !name of directory where output files are contained
  base_directory = &#39;result&#39;
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#sysname"><span class="std std-ref">sysname</span></a> is a prefix for filenames of output files.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#base-directory"><span class="std std-ref">base_directory</span></a> specifies the directory name where output files are generated.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;units
  !units used in input and output files
  unit_system = &#39;A_eV_fs&#39;
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#unit-system"><span class="std std-ref">unit_system</span></a> specifies which unit system is used in the input and output files.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;system
  !periodic boundary condition
  yn_periodic = &#39;n&#39;
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#yn-periodic"><span class="std std-ref">yn_periodic</span></a> specifies whether or not periodic boundary condition is applied.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;emfield
  !envelope shape of the incident pulse(&#39;Ecos2&#39;: cos^2 type envelope for scalar potential)
  ae_shape1 = &#39;Ecos2&#39;

  !peak intensity(W/cm^2) of the incident pulse
  I_wcm2_1 = 1.00d6

  !duration of the incident pulse
  tw1 = 7.50d0

  !mean photon energy(average frequency multiplied by the Planck constant) of the incident pulse
  omega1 = 2.30d0

  !polarization unit vector(real part) for the incident pulse(x,y,z)
  epdir_re1(1:3) = 1.00d0, 0.00d0, 0.00d0

  !carrier emvelope phase of the incident pulse
  !(phi_cep1 must be 0.25 + 0.5 * n(integer) when ae_shape1 = &#39;Ecos2&#39;)
  phi_cep1 = 0.75d0
  !--- Caution ---------------------------------------------------------!
  ! Definition of the incident pulse is written in:                     !
  ! https://www.sciencedirect.com/science/article/pii/S0010465518303412 !
  !---------------------------------------------------------------------!
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#ae-shape1"><span class="std std-ref">ae_shape1</span></a> specifies the envelope of the field.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#i-wcm2-1"><span class="std std-ref">I_wcm2_1</span></a> specify the intensity of the pulse in unit of W/cm<sup>2</sup>.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#tw1"><span class="std std-ref">tw1</span></a> specifies the duration of the pulse.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#omega1"><span class="std std-ref">omega1</span></a> specifies the mean photon energy of the pulse.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#epdir-re1-3"><span class="std std-ref">epdir_re1(i)</span></a> specifies the i-th component of the real part of the polarization unit vector.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#phi-cep1"><span class="std std-ref">phi_cep1</span></a> specifies the carrier-envelope phase of the pulse.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;maxwell
  !grid box size(x,y,z) and number of spatial grids(x,y,z)
  al_em(1:3)        = 600.0d1, 600.0d1, 600.0d1
  num_rgrid_em(1:3) = 100, 100, 100
  !--- Caution ---------------------------------------------------------!
  ! Copumutational domain is set as:                                    !
  !         -al_em/2 ~ al_em/2 for yn_periodic=&#39;n&#39;                      !
  ! whereas        0 ~ al_em   for yn_periodic=&#39;y&#39;.                     !
  !---------------------------------------------------------------------!

  !total time
  at_em = 50.0d0
  !--- TIPS ------------------------------------------------------------!
  ! Two of at_em, dt_em, and nt_em must be set.                         !
  ! Otherwise, both at_em and nt_em or either of those must be set.     !
  ! The latter automatically determines dt_em from CFL condition.       !
  !---------------------------------------------------------------------!

  !*** SHAPE INFORMATION(START) ****************************************!
  !make and output shape file
  yn_make_shape   = &#39;y&#39;
  yn_output_shape = &#39;y&#39;

  !number of shape-template
  n_s = 1

  !media ID and type of shape-template(shape ID)
  id_s(1)  = 1
  typ_s(1) = &#39;ellipsoid&#39;

  !information and origin of shape-template:
  !inf_s(shape ID,x-diameter,y-diameter,z-diameter)
  !ori_s(shape ID,x,y,z)
  inf_s(1,1:3) = 200.0d1, 200.0d1, 200.0d1
  ori_s(1,1:3) = 0.000d1, 0.000d1, 0.000d1
  !--- TIPS ------------------------------------------------------------!
  ! * shape file can be generated by also an external program           !
  !   &#39;FDTD_make_shape&#39; in SALMON utilities                             !
  !   (https://salmon-tddft.jp/utilities.html).                         !
  !   The generated shape file can be read by an input keyword          !
  !   &#39;shape_file&#39; in &amp;maxwell.                                         !
  ! * More complex shapes can be generated by other input keywords      !
  !   which are in common with those used in &#39;FDTD_make_shape&#39;.         !
  !---------------------------------------------------------------------!
  !*** SHAPE INFORMATION(END) ******************************************!

  !*** MEDIA INFORMATION(START) ****************************************!
  !number and type of media(media ID)
  media_num     = 1
  media_type(1) = &#39;lorentz-drude&#39;
  !--- Au described by Lorentz-Drude model -----------------------------!
  ! The parameters are determined from:                                 !
  ! (https://doi.org/10.1364/AO.37.005271)                              !
  !---------------------------------------------------------------------!

  !number of poles and plasma frequency of LD media(media ID)
  pole_num_ld(1) = 6
  omega_p_ld(1)  = 9.030d0

  !oscillator strength, collision frequency,
  !and oscillator frequency of LD media(media ID,pole ID)
  f_ld(1,1:6)     = 0.760d0, 0.024d0, 0.010d0, 0.071d0, 0.601d0, 4.384d0
  gamma_ld(1,1:6) = 0.053d0, 0.241d0, 0.345d0, 0.870d0, 2.494d0, 2.214d0
  omega_ld(1,1:6) = 0.000d0, 0.415d0, 0.830d0, 2.969d0, 4.304d0, 13.32d0
  !--- TIPS ------------------------------------------------------------!
  ! If you calclate a metallic nanoparticle surrounded by something     !
  ! other than vacuum/air, such as Au nanoparticle in water solution,   !
  ! you should change &#39;epsilon_em(0)&#39; in &amp;maxwell,                      !
  ! which specifies the permittivity of surrounding medium.             !
  !---------------------------------------------------------------------!
  !*** MEDIA INFORMATION(END) ******************************************!

  !*** SOURCE INFORMATION(START) ***************************************!
  !type of method to generate the incident pulse
  !(&#39;source&#39;: incident current source)
  wave_input = &#39;source&#39;

  !location of source(x,y,z)
  source_loc1(1:3) = 0.000d1, 0.000d1, -200.0d1

  !propagation direction of the incident pulse(x,y,z)
  ek_dir1(1:3) = 0.000d0, 0.000d0, 1.000d0
  !*** SOURCE INFORMATION(END) *****************************************!

  !*** ASE INFORMATION(START) ******************************************!
  !number of wavelength grid points
  !for Absorption-, Scattering-, and Extinction-cross-sections(ASE)
  !normalized by the spectral distribution of the incident pulse
  ase_num_em = 100

  !minimum and maximum values of wavelength for ASE
  ase_wav_min_em = 400.0d1
  ase_wav_max_em = 800.0d1
  !--- TIPS ------------------------------------------------------------!
  ! ase_ene_min_em and ase_wav_max_em can also be available.            !
  ! If those are used, ASE are outputed for energy axis.                !
  !---------------------------------------------------------------------!

  !size of a closed surface (box shape) to calculate ASE(x-size,y-size,z-size)
  ase_box_size_em(1:3) = 300.0d1, 300.0d1, 300.0d1
  !*** ASE INFORMATION(END) *********************************************!

  !*** OBSERVATION INFORMATION(START) ***********************************!
  !number of observation points
  obs_num_em = 1

  !location of observation point(observation ID,x,y,z)
  obs_loc_em(1,1:3) = 0.0d0, 0.0d0, 0.0d0
  !--- TIPS ------------------------------------------------------------!
  ! * If you specify yn_obs_plane_em(1) = &#39;y&#39;,                          !
  !   animation files can be made by an external program                !
  !   &#39;FDTD_make_figani&#39; in SALMON utilities.                           !
  !   (https://salmon-tddft.jp/utilities.html).                         !
  !   The animation file visualizes electromagnetic field distributions !
  !   on the cross-section including the observation point              !
  !   whose location is determined by obs_loc_em.                       !
  ! * If you specify obs_plane_ene_em(1,1:n) by certain values          !
  !   space-energy distribution of electromagnetic field is outputed    !
  !---------------------------------------------------------------------!
  !*** OBSERVATION INFORMATION(END) ************************************!
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#al-em-3"><span class="std std-ref">al_em(i)</span></a> specifies the lengths of three sides of the cuboid where the grid points are prepared.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#num-rgrid-em-3"><span class="std std-ref">num_rgrid_em(i)</span></a> specifies the number of grid points in i-th direction.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#at-em"><span class="std std-ref">at_em</span></a> specifies total time for electromagnetic analysis.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#yn-make-shape"><span class="std std-ref">yn_make_shape</span></a> is a switch for making shape. This is same functionality for <code class="docutils literal notranslate"><span class="pre">FDTD_make_shape</span></code> in SALMON utilities (<a class="reference external" href="https://salmon-tddft.jp/utilities.html">https://salmon-tddft.jp/utilities.html</a>).</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#yn-output-shape"><span class="std std-ref">yn_output_shape</span></a> is a switch for outputing shape in cube file format.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#n-s"><span class="std std-ref">n_s</span></a> specifies number of shape-template.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#id-s"><span class="std std-ref">id_s(n)</span></a> specifies media ID for n-th shape-template.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#typ-s"><span class="std std-ref">typ_s(n)</span></a> specifies type for n-th shape-template.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#inf-s-10"><span class="std std-ref">inf_s(n,i)</span></a> specifies i-th information for n-th shape-template.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#ori-s-3"><span class="std std-ref">ori_s(n,i)</span></a> specifies origin for n-th shape-template.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#media-num"><span class="std std-ref">media_num</span></a> specifies the number of the types of media that is provided in the shape file.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#media-type"><span class="std std-ref">media_type(n)</span></a> specifies the type of the n-th media.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#pole-num-ld"><span class="std std-ref">pole_num_ld(n)</span></a> and <a class="reference internal" href="input_keyword_list.html#omega-p-ld"><span class="std std-ref">omega_p_ld(n)</span></a> specify the number of poles and the plasmal frequency of the n-th media, respectively.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#f-ld"><span class="std std-ref">f_ld(n,m)</span></a>, <a class="reference internal" href="input_keyword_list.html#omega-ld"><span class="std std-ref">omega_ld(n,m)</span></a>, <a class="reference internal" href="input_keyword_list.html#gamma-ld"><span class="std std-ref">gamma_ld(n,m)</span></a> specify the oscillator strength, oscillator frequency, and collision frequency of the m-th pole of the n-th media, respectively.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#wave-input"><span class="std std-ref">wave_input</span></a> specifies an electric current source that is used for the generation of the pulse.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#source-loc1-3"><span class="std std-ref">source_loc1(i)</span></a> specifies the coordinate of the current source.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#ek-dir1-3"><span class="std std-ref">ek_dir1(i)</span></a> specifies the propagation direction of the pulse.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#ase-num-em"><span class="std std-ref">ase_num_em</span></a> specifies number of wavelength grid points for Absorption-, Scattering-, and Extinction-cross-sections(ASE).</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#ase-wav-min-em"><span class="std std-ref">ase_wav_min_em</span></a> specifies minimum value of wavelength for ASE.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#ase-wav-max-em"><span class="std std-ref">ase_wav_max_em</span></a> specifies maximum value of wavelength for ASE.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#ase-box-size-em-3"><span class="std std-ref">ase_box_size_em</span></a> specifies size of a closed surface (box shape) to calculate ASE.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#obs-num-em"><span class="std std-ref">obs_num_em</span></a> specifies the number of the observing point.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#obs-loc-em-3"><span class="std std-ref">obs_loc_em(n,i)</span></a> specifies the coordinate of n-th observing point.</div>
</div>
</div>
<div class="section" id="output-files-10">
<span id="id25"></span><h4>Output files<a class="headerlink" href="#output-files-10" title="Permalink to this headline">¶</a></h4>
<p>After the calculation, following output files are created in the directory <code class="docutils literal notranslate"><span class="pre">result</span></code>,</p>
<table border="1" class="docutils">
<colgroup>
<col width="51%" />
<col width="49%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>file name</td>
<td>description</td>
</tr>
<tr class="row-even"><td><em>AuNP_ase_with_wf.data</em></td>
<td>A-, S-, and E-corss-sections
as functions of wavelength,
where window function is applied
in Fourier transformation</td>
</tr>
<tr class="row-odd"><td><em>AuNP_ase_without_wf.data</em></td>
<td>A-, S-, and E-corss-sections
as functions of wavelength,
where window function is not
applied in Fourier transformation</td>
</tr>
<tr class="row-even"><td><em>obs1_at_point_rt.data</em></td>
<td>components of
electric and magnetic fields
as functions of time</td>
</tr>
<tr class="row-odd"><td><em>shape.cube</em></td>
<td>shape file for fdtd</td>
</tr>
</tbody>
</table>
<p>Explanations of the files are described below:</p>
<p><strong>AuNP_ase_with_wf.data</strong></p>
<p>Results of A-, S-, and E-cross-sections normalized by the spectral distribution of the incident pulse.
Also the spectral distribution for pointing vector of incident pulse is included.
Window function is applied in Fourier transformation.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Absorption-, Scattering-, and Extinction-cross-sections normalized by the spectral distribution of the incident pulse (with window function):</span>
<span class="c1"># sigma_a: Absorption cross-section</span>
<span class="c1"># sigma_s: Scattering cross-section</span>
<span class="c1"># sigma_e: Extinction cross-section</span>
<span class="c1"># S: Pointing vector of incident pulse along propagation direction</span>
<span class="c1"># 1:Wavelength[Angstrom] 2:sigma_a[Angstrom^2] 3:sigma_s[Angstrom^2] 4:sigma_e[Angstrom^2] 5:S[VA/Angstrom^2*fs^2]</span>
</pre></div>
</div>
<p><strong>AuNP_ase_without_wf.data</strong></p>
<p>Results of A-, S-, and E-cross-sections normalized by the spectral distribution of the incident pulse.
Also the spectral distribution for pointing vector of incident pulse is included.
Window function is not applied in Fourier transformation.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Absorption-, Scattering-, and Extinction-cross-sections normalized by the spectral distribution of the incident pulse (without window function):</span>
<span class="c1"># sigma_a: Absorption cross-section</span>
<span class="c1"># sigma_s: Scattering cross-section</span>
<span class="c1"># sigma_e: Extinction cross-section</span>
<span class="c1"># S: Pointing vector of incident pulse along propagation direction</span>
<span class="c1"># 1:Wavelength[Angstrom] 2:sigma_a[Angstrom^2] 3:sigma_s[Angstrom^2] 4:sigma_e[Angstrom^2] 5:S[VA/Angstrom^2*fs^2]</span>
</pre></div>
</div>
<p><strong>obs0_info.data</strong></p>
<p>This file is used to generate animation files by using SALMON utilities with <a class="reference internal" href="input_keyword_list.html#yn-obs-plane-em"><span class="std std-ref">yn_obs_plane_em</span></a>: <a class="reference external" href="https://salmon-tddft.jp/utilities.html">https://salmon-tddft.jp/utilities.html</a></p>
<p><strong>obs1_at_point_rt.data</strong></p>
<p>Results of time evolution calculation for electric and magnetic fields at observation point 1.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Real time calculation:</span>
<span class="c1"># E: Electric field</span>
<span class="c1"># H: Magnetic field</span>
<span class="c1"># 1:Time[fs] 2:E_x[V/Angstrom] 3:E_y[V/Angstrom] 4:E_z[V/Angstrom] 5:H_x[A/Angstrom] 6:H_y[A/Angstrom] 7:H_z[A/Angstrom]</span>
</pre></div>
</div>
<p><strong>shape.cube</strong></p>
<p>Shape file generated by <a class="reference internal" href="input_keyword_list.html#yn-make-shape"><span class="std std-ref">yn_make_shape</span></a>.</p>
</div>
</div>
<div class="section" id="exercise-11-absorption-reflection-and-transmission-rates-of-an-au-nanoparticles-metasurface-in-fdtd-simulation">
<span id="exercise-11"></span><h3>Exercise-11: Absorption-, Reflection-, and Transmission-rates of an Au nanoparticles metasurface in FDTD simulation<a class="headerlink" href="#exercise-11-absorption-reflection-and-transmission-rates-of-an-au-nanoparticles-metasurface-in-fdtd-simulation" title="Permalink to this headline">¶</a></h3>
<p>In this exercise, we learn  the calculation ofthe absorption-, reflection-, and transmission-rates of a metasurface,
in which Au nanoparticles are periodically arrayed in two-dimension,
by applying the incident pulse in the time-dependent Maxwell equations.
As outputs of the calculation, those rates and the time response of the electromagnetic field are calculated.
A pulsed electric field that has <span class="math">\(\cos^2\)</span> envelope shape is applied.
The parameters that characterize the pulsed field such as magnitude, frequency, polarization direction, and carrier envelope phase are specified in the input file.</p>
<div class="section" id="id26">
<h4>Input files<a class="headerlink" href="#id26" title="Permalink to this headline">¶</a></h4>
<p>To run the code, the input file <code class="docutils literal notranslate"><span class="pre">AuNP_fdtd.inp</span></code> is used:</p>
<table border="1" class="docutils">
<colgroup>
<col width="49%" />
<col width="51%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>file name</td>
<td>description</td>
</tr>
<tr class="row-even"><td><em>AuNPs_fdtd.inp</em></td>
<td>input file that contains input
keywords and their values.</td>
</tr>
</tbody>
</table>
<p>In the input file <code class="docutils literal notranslate"><span class="pre">AuNPs_fdtd.inp</span></code>, input keywords are specified.
Most of them are mandatory to execute this exercise.
This will help you to prepare the input file for other systems that you want to calculate.
A complete list of the input keywords that can be used in the input file
can be found in <a class="reference internal" href="input_keyword_list.html#list-of-input-keywords"><span class="std std-ref">List of input keywords</span></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>!########################################################################################!
! Excercise 11: Absorption-, Reflection-, and Transmission-rates                         !
!               of an Au nanoparticles metasurface in FDTD simulation                    !
!----------------------------------------------------------------------------------------!
! * The detail of this excercise is explained in our manual(see chapter: &#39;Exercises&#39;).   !
!   The manual can be obtained from: https://salmon-tddft.jp/documents.html              !
! * Input format consists of group of keywords like:                                     !
!     &amp;group                                                                             !
!       input keyword = xxx                                                              !
!     /                                                                                  !
!   (see chapter: &#39;List of input keywords&#39; in the manual)                                !
!----------------------------------------------------------------------------------------!
! * Conversion from unit_system = &#39;a.u.&#39; to &#39;A_eV_fs&#39;:                                   !
!   Length: 1 [a.u.] = 0.52917721067    [Angstrom]                                       !
!   Energy: 1 [a.u.] = 27.21138505      [eV]                                             !
!   Time  : 1 [a.u.] = 0.02418884326505 [fs]                                             !
!########################################################################################!

&amp;calculation
  !type of theory
  theory = &#39;maxwell&#39;
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#theory"><span class="std std-ref">theory</span></a> specifies which theoretical method is used in the calculation.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;control
  !common name of output files
  sysname = &#39;AuNPs&#39;

  !name of directory where output files are contained
  base_directory = &#39;result&#39;
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#sysname"><span class="std std-ref">sysname</span></a> is a prefix for filenames of output files.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#base-directory"><span class="std std-ref">base_directory</span></a> specifies the directory name where output files are generated.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;units
  !units used in input and output files
  unit_system = &#39;A_eV_fs&#39;
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#unit-system"><span class="std std-ref">unit_system</span></a> specifies which unit system is used in the input and output files.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;system
  !periodic boundary condition
  yn_periodic = &#39;y&#39;
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#yn-periodic"><span class="std std-ref">yn_periodic</span></a> specifies whether or not periodic boundary condition is applied.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;emfield
  !envelope shape of the incident pulse(&#39;Ecos2&#39;: cos^2 type envelope for scalar potential)
  ae_shape1 = &#39;Ecos2&#39;

  !peak intensity(W/cm^2) of the incident pulse
  I_wcm2_1 = 1.00d6

  !duration of the incident pulse
  tw1 = 7.50d0

  !mean photon energy(average frequency multiplied by the Planck constant) of the incident pulse
  omega1 = 2.30d0

  !polarization unit vector(real part) for the incident pulse(x,y,z)
  epdir_re1(1:3) = 1.00d0, 0.00d0, 0.00d0

  !carrier emvelope phase of the incident pulse
  !(phi_cep1 must be 0.25 + 0.5 * n(integer) when ae_shape1 = &#39;Ecos2&#39;)
  phi_cep1 = 0.75d0
  !--- Caution ---------------------------------------------------------!
  ! Definition of the incident pulse is written in:                     !
  ! https://www.sciencedirect.com/science/article/pii/S0010465518303412 !
  !---------------------------------------------------------------------!
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#ae-shape1"><span class="std std-ref">ae_shape1</span></a> specifies the envelope of the field.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#i-wcm2-1"><span class="std std-ref">I_wcm2_1</span></a> specify the intensity of the pulse in unit of W/cm<sup>2</sup>.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#tw1"><span class="std std-ref">tw1</span></a> specifies the duration of the pulse.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#omega1"><span class="std std-ref">omega1</span></a> specifies the mean photon energy of the pulse.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#epdir-re1-3"><span class="std std-ref">epdir_re1(i)</span></a> specifies the i-th component of the real part of the polarization unit vector.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#phi-cep1"><span class="std std-ref">phi_cep1</span></a> specifies the carrier-envelope phase of the pulse.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;maxwell
  !grid box size(x,y,z) and number of spatial grids(x,y,z)
  al_em(1:3)        = 300.0d1, 300.0d1, 600.0d1
  num_rgrid_em(1:3) = 50, 50, 100
  !--- Caution ---------------------------------------------------------!
  ! Copumutational domain is set as:                                    !
  !         -al_em/2 ~ al_em/2 for yn_periodic=&#39;n&#39;                      !
  ! whereas        0 ~ al_em   for yn_periodic=&#39;y&#39;.                     !
  !---------------------------------------------------------------------!

  !total time
  at_em = 50.0d0
  !--- TIPS ------------------------------------------------------------!
  ! Two of at_em, dt_em, and nt_em must be set.                         !
  ! Otherwise, both at_em and nt_em or either of those must be set.     !
  ! The latter automatically determines dt_em from CFL condition.       !
  !---------------------------------------------------------------------!

  !absorbing boudnary conditions at bottom and top on z axis
  boundary_em(3,1) = &#39;abc&#39;
  boundary_em(3,2) = &#39;abc&#39;

  !*** SHAPE INFORMATION(START) ****************************************!
  !make and output shape file
  yn_make_shape   = &#39;y&#39;
  yn_output_shape = &#39;y&#39;

  !number of shape-template
  n_s = 1

  !media ID and type of shape-template(shape ID)
  id_s(1)  = 1
  typ_s(1) = &#39;ellipsoid&#39;

  !information and origin of shape-template:
  !inf_s(shape ID,x-diameter,y-diameter,z-diameter)
  !ori_s(shape ID,x,y,z)
  inf_s(1,1:3) = 200.0d1, 200.0d1, 200.0d1
  ori_s(1,1:3) = 150.0d1, 150.0d1, 300.0d1
  !--- TIPS ------------------------------------------------------------!
  ! * shape file can be generated by also an external program           !
  !   &#39;FDTD_make_shape&#39; in SALMON utilities                             !
  !   (https://salmon-tddft.jp/utilities.html).                         !
  !   The generated shape file can be read by an input keyword          !
  !   &#39;shape_file&#39; in &amp;maxwell.                                         !
  ! * More complex shapes can be generated by other input keywords      !
  !   which are in common with those used in &#39;FDTD_make_shape&#39;.         !
  !---------------------------------------------------------------------!
  !*** SHAPE INFORMATION(END) ******************************************!

  !*** MEDIA INFORMATION(START) ****************************************!
  !number and type of media(media ID)
  media_num     = 1
  media_type(1) = &#39;lorentz-drude&#39;
  !--- Au described by Lorentz-Drude model -----------------------------!
  ! The parameters are determined from:                                 !
  ! (https://doi.org/10.1364/AO.37.005271)                              !
  !---------------------------------------------------------------------!

  !number of poles and plasma frequency of LD media(media ID)
  pole_num_ld(1) = 6
  omega_p_ld(1)  = 9.030d0

  !oscillator strength, collision frequency,
  !and oscillator frequency of LD media(media ID,pole ID)
  f_ld(1,1:6)     = 0.760d0, 0.024d0, 0.010d0, 0.071d0, 0.601d0, 4.384d0
  gamma_ld(1,1:6) = 0.053d0, 0.241d0, 0.345d0, 0.870d0, 2.494d0, 2.214d0
  omega_ld(1,1:6) = 0.000d0, 0.415d0, 0.830d0, 2.969d0, 4.304d0, 13.32d0
  !--- TIPS ------------------------------------------------------------!
  ! If you calclate a metallic nanoparticles surrounded by something    !
  ! other than vacuum/air, such as Au nanoparticles in water solution,  !
  ! you should change &#39;epsilon_em(0)&#39; in &amp;maxwell,                      !
  ! which specifies the permittivity of surrounding medium.             !
  !---------------------------------------------------------------------!
  !*** MEDIA INFORMATION(END) ******************************************!

  !*** SOURCE INFORMATION(START) ***************************************!
  !type of method to generate the incident pulse
  !(&#39;source&#39;: incident current source)
  wave_input = &#39;source&#39;

  !location of source(x,y,z)
  source_loc1(1:3) = 0.000d1, 0.000d1, 100.0d1

  !propagation direction of the incident pulse(x,y,z)
  ek_dir1(1:3) = 0.000d0, 0.000d0, 1.000d0
  !*** SOURCE INFORMATION(END) *****************************************!

  !*** ART INFORMATION(START) ******************************************!
  !number of wavelength grid points
  !for Absorption-, Reflection-, and Transmission-rates(ART)
  !normalized by the spectral distribution of the incident pulse
  art_num_em = 100

  !minimum and maximum values of wavelength for ART
  art_wav_min_em = 400.0d1
  art_wav_max_em = 800.0d1
  !--- TIPS ------------------------------------------------------------!
  ! art_ene_min_em and art_wav_max_em also can be available.            !
  ! If those are used, ART are outputed for energy axis.                !
  !---------------------------------------------------------------------!

  !location of bottom and top planes on the propagation axis to calculate ART(x,y,z)
  art_plane_bot_em(1:3) = 150.0d1, 150.0d1, 150.0d1
  art_plane_top_em(1:3) = 150.0d1, 150.0d1, 450.0d1
  !*** ART INFORMATION(END) *********************************************!

  !*** OBSERVATION INFORMATION(START) ***********************************!
  !number of observation points
  obs_num_em = 1

  !location of observation point(observation ID,x,y,z)
  obs_loc_em(1,1:3) = 150.0d1, 150.0d1, 300.0d1
  !--- TIPS ------------------------------------------------------------!
  ! * If you specify yn_obs_plane_em(1) = &#39;y&#39;,                          !
  !   animation files can be made by an external program                !
  !   &#39;FDTD_make_figani&#39; in SALMON utilities.                           !
  !   (https://salmon-tddft.jp/utilities.html).                         !
  !   The animation file visualizes electromagnetic field distributions !
  !   on the cross-section including the observation point              !
  !   whose location is determined by obs_loc_em.                       !
  ! * If you specify obs_plane_ene_em(1,1:n) by certain values          !
  !   space-energy distribution of electromagnetic field is outputed    !
  !---------------------------------------------------------------------!
  !*** OBSERVATION INFORMATION(END) ************************************!
/
</pre></div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#al-em-3"><span class="std std-ref">al_em(i)</span></a> specifies the lengths of three sides of the cuboid where the grid points are prepared.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#num-rgrid-em-3"><span class="std std-ref">num_rgrid_em(i)</span></a> specifies the number of grid points in i-th direction.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#at-em"><span class="std std-ref">at_em</span></a> specifies total time for electromagnetic analysis.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#boundary-em-3-2"><span class="std std-ref">boundary_em(i,n)</span></a> specifies the boundary condition for the electromagnetic analysis. The first index i corresponds to the x,y, and z direction. The second index n specifies bottom or top of the material.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#yn-make-shape"><span class="std std-ref">yn_make_shape</span></a> is a switch for making shape. This is same functionality for <code class="docutils literal notranslate"><span class="pre">FDTD_make_shape</span></code> in SALMON utilities (<a class="reference external" href="https://salmon-tddft.jp/utilities.html">https://salmon-tddft.jp/utilities.html</a>).</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#yn-output-shape"><span class="std std-ref">yn_output_shape</span></a> is a switch for outputing shape in cube file format.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#n-s"><span class="std std-ref">n_s</span></a> specifies number of shape-template.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#id-s"><span class="std std-ref">id_s(n)</span></a> specifies media ID for n-th shape-template.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#typ-s"><span class="std std-ref">typ_s(n)</span></a> specifies type for n-th shape-template.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#inf-s-10"><span class="std std-ref">inf_s(n,i)</span></a> specifies i-th information for n-th shape-template.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#ori-s-3"><span class="std std-ref">ori_s(n,i)</span></a> specifies origin for n-th shape-template.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#media-num"><span class="std std-ref">media_num</span></a> specifies the number of the types of media that is provided in the shape file.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#media-type"><span class="std std-ref">media_type(n)</span></a> specifies the type of the n-th media.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#pole-num-ld"><span class="std std-ref">pole_num_ld(n)</span></a> and <a class="reference internal" href="input_keyword_list.html#omega-p-ld"><span class="std std-ref">omega_p_ld(n)</span></a> specify the number of poles and the plasmal frequency of the n-th media, respectively.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#f-ld"><span class="std std-ref">f_ld(n,m)</span></a>, <a class="reference internal" href="input_keyword_list.html#omega-ld"><span class="std std-ref">omega_ld(n,m)</span></a>, <a class="reference internal" href="input_keyword_list.html#gamma-ld"><span class="std std-ref">gamma_ld(n,m)</span></a> specify the oscillator strength, oscillator frequency, and collision frequency of the m-th pole of the n-th media, respectively.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#wave-input"><span class="std std-ref">wave_input</span></a> specifies an electric current source that is used for the generation of the pulse.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#source-loc1-3"><span class="std std-ref">source_loc1(i)</span></a> specifies the coordinate of the current source.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#ek-dir1-3"><span class="std std-ref">ek_dir1(i)</span></a> specifies the propagation direction of the pulse.</div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="input_keyword_list.html#art-num-em"><span class="std std-ref">art_num_em</span></a> specifies number of wavelength grid points for Absorption-, Reflection-, and Transmission-rates(ART).</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#art-wav-min-em"><span class="std std-ref">art_wav_min_em</span></a> specifies minimum value of wavelength for ART.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#art-wav-max-em"><span class="std std-ref">art_wav_max_em</span></a> specifies maximum value of wavelength for ART.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#art-plane-bot-em-3"><span class="std std-ref">art_plane_bot_em</span></a> specifies location of bottom plane on the propagation axis to calculate ART</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#art-plane-bot-em-3"><span class="std std-ref">art_plane_top_em</span></a> specifies location of top plane on the propagation axis to calculate ART</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#obs-num-em"><span class="std std-ref">obs_num_em</span></a> specifies the number of the observing point.</div>
<div class="line"><a class="reference internal" href="input_keyword_list.html#obs-loc-em-3"><span class="std std-ref">obs_loc_em(n,i)</span></a> specifies the coordinate of n-th observing point.</div>
</div>
</div>
<div class="section" id="id27">
<span id="id28"></span><h4>Output files<a class="headerlink" href="#id27" title="Permalink to this headline">¶</a></h4>
<p>After the calculation, following output files are created in the directory <code class="docutils literal notranslate"><span class="pre">result</span></code>,</p>
<table border="1" class="docutils">
<colgroup>
<col width="51%" />
<col width="49%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>file name</td>
<td>description</td>
</tr>
<tr class="row-even"><td><em>AuNPs_art_with_wf.data</em></td>
<td>A-, R-, and T-rates
as functions of wavelength,
where window function is applied
in Fourier transformation</td>
</tr>
<tr class="row-odd"><td><em>AuNPs_art_without_wf.data</em></td>
<td>A-, R-, and T-rates
as functions of wavelength,
where window function is not
applied in Fourier transformation</td>
</tr>
<tr class="row-even"><td><em>obs1_at_point_rt.data</em></td>
<td>components of
electric and magnetic fields
as functions of time</td>
</tr>
<tr class="row-odd"><td><em>shape.cube</em></td>
<td>shape file for fdtd</td>
</tr>
</tbody>
</table>
<p>Explanations of the files are described below:</p>
<p><strong>AuNPs_art_with_wf.data</strong></p>
<p>Results of A-, R-, and T-rates normalized by the spectral distribution of the incident pulse.
Also the spectral distribution for pointing vector of incident pulse is included.
Window function is applied in Fourier transformation.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Absorption-, Reflection-, and Transmission-rates normalized by the spectral distribution of the incident pulse (with window function):</span>
<span class="c1"># A: Absorption rate</span>
<span class="c1"># R: Reflection rate</span>
<span class="c1"># T: Transmission rate</span>
<span class="c1"># S: Pointing vector of incident pulse along propagation direction</span>
<span class="c1"># 1:Wavelength[Angstrom] 2:A % 3:R % 4:T % 5:S[VA/Angstrom^2*fs^2]</span>
</pre></div>
</div>
<p><strong>AuNPs_art_without_wf.data</strong></p>
<p>Results of A-, R-, and T-rates normalized by the spectral distribution of the incident pulse.
Also the spectral distribution for pointing vector of incident pulse is included.
Window function is not applied in Fourier transformation.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Absorption-, Reflection-, and Transmission-rates normalized by the spectral distribution of the incident pulse (without window function):</span>
<span class="c1"># A: Absorption rate</span>
<span class="c1"># R: Reflection rate</span>
<span class="c1"># T: Transmission rate</span>
<span class="c1"># S: Pointing vector of incident pulse along propagation direction</span>
<span class="c1"># 1:Wavelength[Angstrom] 2:A % 3:R % 4:T % 5:S[VA/Angstrom^2*fs^2]</span>
</pre></div>
</div>
<p><strong>obs0_info.data</strong></p>
<p>This file is used to generate animation files by using SALMON utilities with <a class="reference internal" href="input_keyword_list.html#yn-obs-plane-em"><span class="std std-ref">yn_obs_plane_em</span></a>: <a class="reference external" href="https://salmon-tddft.jp/utilities.html">https://salmon-tddft.jp/utilities.html</a></p>
<p><strong>obs1_at_point_rt.data</strong></p>
<p>Results of time evolution calculation for electric and magnetic fields at observation point 1.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Real time calculation:</span>
<span class="c1"># E: Electric field</span>
<span class="c1"># H: Magnetic field</span>
<span class="c1"># 1:Time[fs] 2:E_x[V/Angstrom] 3:E_y[V/Angstrom] 4:E_z[V/Angstrom] 5:H_x[A/Angstrom] 6:H_y[A/Angstrom] 7:H_z[A/Angstrom]</span>
</pre></div>
</div>
<p><strong>shape.cube</strong></p>
<p>Shape file generated by <a class="reference internal" href="input_keyword_list.html#yn-make-shape"><span class="std std-ref">yn_make_shape</span></a>.</p>
</div>
</div>
</div>
<div class="section" id="trial-semiconductor-bloch-equation">
<h2>[Trial] Semiconductor Bloch equation<a class="headerlink" href="#trial-semiconductor-bloch-equation" title="Permalink to this headline">¶</a></h2>
<p>The SALMON program includes a time evolution calculation feature based on the Semiconductor Bloch Equation (SBE), which was added starting from version 2.2.0.
The SBE calculation feature is currently an experimental implementation, and  the developers cannot guarantee its behavior.
To activate the SBE calculation feature, specify the value <code class="docutils literal notranslate"><span class="pre">sbe</span></code> or <code class="docutils literal notranslate"><span class="pre">sbe_maxwell</span></code> for the <a class="reference internal" href="input_keyword_list.html#theory"><span class="std std-ref">theory</span></a> option in the input file; these feature includes both a real-time calculation feature equivalent to &quot;tddft_pulse&quot; and a multiscale calculation feature equivalent to &quot;multi_scale_maxwell_tddft&quot; that are already available in the program.</p>
<div class="section" id="trial-exercise-x1-semiconductor-bloch-equation-sbe-calculation">
<span id="exercise-x1"></span><h3>[Trial] Exercise-x1: Semiconductor Bloch equation (SBE) calculation<a class="headerlink" href="#trial-exercise-x1-semiconductor-bloch-equation-sbe-calculation" title="Permalink to this headline">¶</a></h3>
<p>To run the code, following files in the directory <code class="docutils literal notranslate"><span class="pre">SALMON/samples/exercise_x1_bulkSi_sbe_gs_rt/</span></code> are used:</p>
<table border="1" class="docutils">
<colgroup>
<col width="46%" />
<col width="54%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>file name</td>
<td>description</td>
</tr>
<tr class="row-even"><td><em>Si_gs.inp</em></td>
<td>input file for ground state calculation
keywords and their values</td>
</tr>
<tr class="row-odd"><td><em>Si_rps.dat</em></td>
<td>pseodupotential file for silicon atom</td>
</tr>
<tr class="row-even"><td><em>Si_sbe_rt.inp</em></td>
<td>input file for real time calculation
keywords and their values</td>
</tr>
</tbody>
</table>
<div class="section" id="ground-state-calculation">
<h4>Ground state calculation<a class="headerlink" href="#ground-state-calculation" title="Permalink to this headline">¶</a></h4>
<p>Before performing SBE calculations, various information of ground state such as the eigenenergy and transition dipole moment imust be prepared.
The conditions for the ground state calculation are specified in <code class="docutils literal notranslate"><span class="pre">Si_gs.inp</span></code>;
please refer to
<a class="reference internal" href="#exercise-4"><span class="std std-ref">Exercise-4: Ground state of crystalline silicon</span></a>
for more details.
Note that it is necessary to set <code class="docutils literal notranslate"><span class="pre">yn_out_tm</span></code> parameter to output the transition dipole moment.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&amp;</span><span class="n">analysis</span>
   <span class="n">yn_out_tm</span> <span class="o">=</span> <span class="s2">&quot;y&quot;</span>
<span class="o">/</span>
</pre></div>
</div>
</div>
<div class="section" id="output-files-of-ground-state-calculation">
<h4>Output files of ground state calculation<a class="headerlink" href="#output-files-of-ground-state-calculation" title="Permalink to this headline">¶</a></h4>
<p>After the calculation, a few output files are created; on particular, the following three files are important for SBE calculations.</p>
<table border="1" class="docutils">
<colgroup>
<col width="45%" />
<col width="55%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>file name</td>
<td>description</td>
</tr>
<tr class="row-even"><td><em>Si_k.data</em></td>
<td>sampled k-point coordinates in BZ</td>
</tr>
<tr class="row-odd"><td><em>Si_eigen.data</em></td>
<td>Eigenenergies</td>
</tr>
<tr class="row-even"><td><em>Si_tm.data</em></td>
<td>Transition dipole moment matrix</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="real-time-sbe-calculation">
<h4>Real-time SBE calculation<a class="headerlink" href="#real-time-sbe-calculation" title="Permalink to this headline">¶</a></h4>
<p>To perform real-time calculations, it is necessary to place the three data files from the ground-state calculation, <code class="docutils literal notranslate"><span class="pre">SYSNAME_k.data</span></code>, <code class="docutils literal notranslate"><span class="pre">SYSNAME_eigen.data</span></code>, and <code class="docutils literal notranslate"><span class="pre">SYSNAME_tm.data</span></code>, in the same directory. If the real-time calculation is performed in a different directory from the ground-state calculation, it is necessary to manually copy (or link) the above files.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&amp;</span><span class="n">calculation</span>
   <span class="n">theory</span> <span class="o">=</span> <span class="s1">&#39;sbe&#39;</span>
<span class="o">/</span>
</pre></div>
</div>
<p>The parameter <code class="docutils literal notranslate"><span class="pre">theory='sbe'</span></code> must be specified.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&amp;</span><span class="n">control</span>
   <span class="n">sysname</span> <span class="o">=</span> <span class="s1">&#39;Si&#39;</span>
<span class="o">/</span>

<span class="o">&amp;</span><span class="n">units</span>
   <span class="n">unit_system</span> <span class="o">=</span> <span class="s1">&#39;au&#39;</span>
<span class="o">/</span>

<span class="o">&amp;</span><span class="n">system</span>
   <span class="n">yn_periodic</span> <span class="o">=</span> <span class="s1">&#39;y&#39;</span>
   <span class="n">al</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mf">10.26</span><span class="n">d0</span><span class="p">,</span> <span class="mf">10.26</span><span class="n">d0</span><span class="p">,</span> <span class="mf">10.26</span><span class="n">d0</span>
   <span class="n">nelem</span> <span class="o">=</span> <span class="mi">1</span>
   <span class="n">natom</span> <span class="o">=</span> <span class="mi">8</span>
   <span class="n">nelec</span> <span class="o">=</span> <span class="mi">32</span>
   <span class="n">nstate</span> <span class="o">=</span> <span class="mi">32</span>
<span class="o">/</span>

<span class="o">&amp;</span><span class="n">kgrid</span>
   <span class="n">num_kgrid</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span>
<span class="o">/</span>

<span class="o">&amp;</span><span class="n">tgrid</span>
   <span class="n">dt</span> <span class="o">=</span> <span class="mf">0.05</span><span class="n">d0</span>
   <span class="n">nt</span> <span class="o">=</span> <span class="mi">20000</span>
<span class="o">/</span>

<span class="o">&amp;</span><span class="n">emfield</span>
   <span class="n">ae_shape1</span> <span class="o">=</span> <span class="s2">&quot;Acos2&quot;</span>
   <span class="n">epdir_re1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0</span><span class="n">d0</span><span class="p">,</span> <span class="mf">0.0</span><span class="n">d0</span><span class="p">,</span> <span class="mf">1.0</span><span class="n">d0</span>
   <span class="n">I_wcm2_1</span> <span class="o">=</span> <span class="mf">1.0</span><span class="n">d</span><span class="o">+</span><span class="mi">12</span>
   <span class="n">tw1</span> <span class="o">=</span> <span class="mf">1000.0</span><span class="n">d0</span>
   <span class="n">omega1</span> <span class="o">=</span> <span class="mf">0.056</span><span class="n">d0</span>
<span class="o">/</span>
</pre></div>
</div>
<p>The above section shares the same parameters as the time-evolution calculations for bulk crystals.
please refer to
<a class="reference internal" href="#exercise-6"><span class="std std-ref">Exercise-6: Electron dynamics in crystalline silicon under a pulsed electric field</span></a>
for more details.</p>
</div>
</div>
<div class="section" id="trial-exercise-x2-multiscale-maxwell-semiconductor-bloch-equation-maxwell-sbe-calculation">
<span id="exercise-x2"></span><h3>[Trial] Exercise-x2: Multiscale Maxwell semiconductor Bloch equation (Maxwell+SBE) calculation<a class="headerlink" href="#trial-exercise-x2-multiscale-maxwell-semiconductor-bloch-equation-maxwell-sbe-calculation" title="Permalink to this headline">¶</a></h3>
<p>To run the code, following files in the directory SALMON/samples/exercise_x2_bulkSi_bloch_gs_ms/ are used:</p>
<table border="1" class="docutils">
<colgroup>
<col width="45%" />
<col width="55%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>file name</td>
<td>description</td>
</tr>
<tr class="row-even"><td><em>Si_gs.inp</em></td>
<td>Inputfile for ground state calculation</td>
</tr>
<tr class="row-odd"><td><em>Si_sbe_ms_1d_film.inp</em></td>
<td>Inputfile for 1D multiscale calculation</td>
</tr>
<tr class="row-even"><td><em>Si_sbe_ms_2d_cylinder.inp</em></td>
<td>Inputfile for 2D multiscale calculation</td>
</tr>
</tbody>
</table>
<p>To perform Maxwell+SBE multiscale calculations, various data of the ground state, such as eigenenergy and transition dipole moment, are required. It is necessary to perform the ground-state calculation: <code class="docutils literal notranslate"><span class="pre">Si_gs.inp</span></code> before executing multiscale calculations.
See
<a class="reference internal" href="#exercise-x1"><span class="std std-ref">Exercise-x1</span></a>
.</p>
<div class="section" id="multiscale-calculation-for-laser-pulse-propagation-in-silicon-nano-film-1d-calculation">
<h4>Multiscale calculation for laser pulse propagation in silicon nano-film  (1D calculation)<a class="headerlink" href="#multiscale-calculation-for-laser-pulse-propagation-in-silicon-nano-film-1d-calculation" title="Permalink to this headline">¶</a></h4>
<p><strong>*Si_sbe_ms_1d_film.inp</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&amp;</span><span class="n">calculation</span>
   <span class="n">theory</span> <span class="o">=</span> <span class="s1">&#39;maxwell_sbe&#39;</span>
<span class="o">/</span>
</pre></div>
</div>
<p>The parameter <code class="docutils literal notranslate"><span class="pre">theory='maxwell_sbe'</span></code> must be specified.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;system
   yn_periodic = &#39;y&#39;
   al(1:3) = 10.26d0, 10.26d0, 10.26d0
   nelem = 1
   natom = 8
   nelec = 32
   nstate = 32
/

&amp;emfield
   ae_shape1 = &quot;Acos2&quot;
   epdir_re1(1:3) = 0.0d0, 0.0d0, 1.0d0
   I_wcm2_1 = 1.0d+12
   tw1 = 1000.0d0
   omega1 = 0.056d0
/

&amp;multiscale
   nx_m = 20
   ny_m = 1
   nz_m = 1
   hx_m = 94.52 ! 5nm
   hy_m = 94.52 ! 5nm
   hz_m = 94.52 ! 5nm
   nxvac_m(1) = 2000
   nxvac_m(2) = 2000
/
</pre></div>
</div>
<p>The above section shares the same parameters as the time-evolution calculations for bulk crystals.
Please refer to
<a class="reference internal" href="#exercise-7"><span class="std std-ref">Exercise-7: Pulsed-light propagation through a silicon thin film</span></a>
for more details.</p>
</div>
<div class="section" id="multiscale-calculation-for-laser-pulse-incident-on-arbitrary-shaped-nanostructures-2d-calculation">
<h4>Multiscale calculation for laser pulse incident on arbitrary-shaped nanostructures (2D calculation)<a class="headerlink" href="#multiscale-calculation-for-laser-pulse-incident-on-arbitrary-shaped-nanostructures-2d-calculation" title="Permalink to this headline">¶</a></h4>
<p>The multidimensional multiscale method (2D or 3D) can handle the light-matter interaction with arbitrarily shaped nanostructures.
As a example, the periodically arranged silicon nanocylinder array is considered</p>
<p><strong>*Si_sbe_ms_2d_cylinder.inp</strong></p>
<p>Most parts of the input file are common with the previous 1D calculatio.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;multiscale
   fdtddim = &quot;3d&quot;
   hx_m = 189.0 ! 5nm
   hy_m = 189.0 ! 5nm
   hz_m = 189.0 ! 5nm
   nx_m = 80
   ny_m = 80
   nz_m = 1
   nxvac_m(1) = 2000
   nxvac_m(2) = 2000
/
</pre></div>
</div>
<p>This section defines a 2D computational domain of 80 cells x 80 cells (400 nm x 400 nm).
Furthermore, a vacuum region of 2000 cells (10 um) is added along the x-axis to surround the computational domain.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;maxwell
   ! Media 1
   media_type(1) = &quot;multiscale&quot;
   ! Shaper
   n_s = 1
   ! Object 1
   id_s(1) = 1
   typ_s(1) = &quot;ellipsoid&quot;
   ori_s(1,1:3) = 7561.43, 7561.43, 94.52
   inf_s(1,1:3) =  7561.43,  7561.43, 10000.0
   ! Detectors
   obs_num_em=3
   obs_loc_em(1, 1:3) = 7561.43, 7561.43, 94.52
   obs_loc_em(2, 1:3) = 11342.145, 7561.43, 94.52
   obs_loc_em(3, 1:3) = 15122.86, 7561.43, 94.52
/
</pre></div>
</div>
<p>This section defines the shape, coordinates and arrangement of the macroscopic objects.
The most of parameters are common with <code class="docutils literal notranslate"><span class="pre">theory='maxwell'</span></code>.
Please refer to
<a class="reference internal" href="#exercise-10"><span class="std std-ref">Exercise-10</span></a>
for more details.</p>
<p>Note that if you want to treat the medium with electron dynamics calculations (TDDFT or SBE), specify``media_type`` as <code class="docutils literal notranslate"><span class="pre">'multiscale'</span></code>.</p>
</div>
</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="install_and_run.html" class="btn btn-neutral float-left" title="Install and Run" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="input_keyword_list.html" class="btn btn-neutral float-right" title="List of input keywords" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2017-2025, SALMON developers.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>